<!DOCTYPE html>
<html lang="en-US">
  <head>
    <title>undefined</title>
<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
    <style type="text/css">
/*

Original highlight.js style (c) Ivan Sagalaev <maniac@softwaremaniacs.org>

*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  background: #F0F0F0;
}


/* Base color: saturation 0; */

.hljs,
.hljs-subst {
  color: #444;
}

.hljs-comment {
  color: #888888;
}

.hljs-keyword,
.hljs-attribute,
.hljs-selector-tag,
.hljs-meta-keyword,
.hljs-doctag,
.hljs-name {
  font-weight: bold;
}


/* User color: hue: 0 */

.hljs-type,
.hljs-string,
.hljs-number,
.hljs-selector-id,
.hljs-selector-class,
.hljs-quote,
.hljs-template-tag,
.hljs-deletion {
  color: #880000;
}

.hljs-title,
.hljs-section {
  color: #880000;
  font-weight: bold;
}

.hljs-regexp,
.hljs-symbol,
.hljs-variable,
.hljs-template-variable,
.hljs-link,
.hljs-selector-attr,
.hljs-selector-pseudo {
  color: #BC6060;
}


/* Language color: hue: 90; */

.hljs-literal {
  color: #78A960;
}

.hljs-built_in,
.hljs-bullet,
.hljs-code,
.hljs-addition {
  color: #397300;
}


/* Meta color: hue: 200 */

.hljs-meta {
  color: #1f7199;
}

.hljs-meta-string {
  color: #4d99bf;
}


/* Misc effects */

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}

pre, code {
  font-family: 'Roboto Mono', monospace;
  background-color: #eee;
}
pre {
  border-top: 1px solid #999;
  border-bottom: 1px solid #999;
  display: block;
  padding: 10px 0px 10px 0px;
}
body {
  font-size: 16px;
  /* font-family: 'Open Sans', sans-serif; */
  font-family: 'IBM Plex Sans', sans-serif;
  hyphens: auto;
}
.note {
  font-size: 0.8em;
  padding: 2px;
}
.icon .title {
  display: none;
}
.icon {
  width: 8px;
  border-right: 3px solid #999;
  margin: 3px;
}
.note .content {
  padding-left: 16px;
}

#toctitle {
  display: block;
  font-size: 1.5em;
  font-weight: bold;
  color: #003262;
}

.toc ul { list-style-type: none; }

.toc li { padding-top: 0.2em; }

.sectlevel1 li { font-size: 1.5rem; }

.sectlevel2 li { font-size: 1.2rem; }

.ftitle {
  margin: 4em;
}
.ftitle1 {
  margin: 2em;
  font-size: 2em;
}
.ftitle2 {
  margin: 2em;
  font-size: 1.5em;
}

table {
  width: 100%;
  max-width: 100%;
  border-collapse: collapse;
  padding-bottom: 4px;
}

.tableblock {
  padding: 1px 4px 1px 4px;
  margin: 0px;
}

.frame-all {
  margin: 8px 0px 8px 0px;
}

.tableblock td, .tableblock th {
  border: 1px solid #999;
}

.halign-left {
  text-align: left;
}

.title {
  padding-top: 8px;
}

h2 {
  color: #003262;
}

.note, p {
  text-align: justify;
}

.hljs {
  overflow-x: hidden;
}

@media screen {
  .container {
    max-width: 968px;
    margin: 0 auto;
  }

  a {
    color: #003262;
  }

}

@media print {
  a {
    text-decoration-line: none;
    color: #000;
  }
  body {
    font-size: 20px;
  }

  h1 {
    string-set: header content();
  }

  @page {
    @top-center { content: "top-center"; border: solid green; }
    @bottom-center { content: "bottom-center"; border: solid green; }
  }
  @page {
    margin-top: 15mm;
    margin-bottom: 15mm;
    border: solid green;
  }
  @page :left {
    margin-left: 25mm;
    margin-right: 15mm;
  }
  @page :right {
    margin-left: 15mm;
    margin-right: 25mm;
  }
  @page :first {
    margin-left: 20mm;
    margin-right: 20mm;
  }

  h2 {
    break-before: page;
    page-break-before: page;
  }
  h2, h3, h4, h5 {
    break-after: avoid-page;
    page-break-after: avoid-page;
  }
  pre {
    font-size: 18px;
    break-inside: avoid;
    page-break-inside: avoid;
  }
  .listingblock {
    break-inside: avoid;
    page-break-inside: avoid;
  }
  .ftitle {
    text-align: center;
    margin-top: 50%;
    break-after: always;
    page-break-after: always;
  }
  .note {
    break-inside: avoid;
    page-break-inside: avoid;
  }
  table {
    page-break-inside: avoid;
  }
}

    </style>
  </head>
  <body>
    <div class="container">

<div class="ftitle">
<div class="ftitle1">RISC-V "V" Vector Extension</div>
<div class="ftitle2">Version 0.8-draft-20190906</div>
</div>

      <div id="content">
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a></li>
<li><a href="#_implementation_defined_constant_parameters">2. Implementation-defined Constant Parameters</a></li>
<li><a href="#_vector_extension_programmers_model">3. Vector Extension Programmer&#8217;s Model</a>
<ul class="sectlevel2">
<li><a href="#_vector_registers">3.1. Vector Registers</a></li>
<li><a href="#_vector_type_register_vtype">3.2. Vector type register, <code>vtype</code></a></li>
<li><a href="#_vector_length_register_vl">3.3. Vector Length Register <code>vl</code></a></li>
<li><a href="#_vector_start_index_csr_vstart">3.4. Vector Start Index CSR <code>vstart</code></a></li>
<li><a href="#_vector_fixed_point_rounding_mode_register_vxrm">3.5. Vector Fixed-Point Rounding Mode Register <code>vxrm</code></a></li>
<li><a href="#_vector_fixed_point_saturation_flag_vxsat">3.6. Vector Fixed-Point Saturation Flag <code>vxsat</code></a></li>
<li><a href="#_vector_fixed_point_fields_in_fcsr">3.7. Vector Fixed-Point Fields in <code>fcsr</code></a></li>
<li><a href="#_state_of_vector_extension_at_reset">3.8. State of Vector Extension at Reset</a></li>
</ul>
</li>
<li><a href="#_mapping_of_vector_elements_to_vector_register_state">4. Mapping of Vector Elements to Vector Register State</a>
<ul class="sectlevel2">
<li><a href="#_mapping_with_lmul1">4.1. Mapping with LMUL=1</a></li>
<li><a href="#_mapping_with_lmul_1">4.2. Mapping with LMUL &gt; 1</a></li>
<li><a href="#_mapping_across_mixed_width_operations">4.3. Mapping across Mixed-Width Operations</a></li>
<li><a href="#sec-mask-register-layout">4.4. Mask Register Layout</a></li>
</ul>
</li>
<li><a href="#_vector_instruction_formats">5. Vector Instruction Formats</a>
<ul class="sectlevel2">
<li><a href="#_scalar_operands">5.1. Scalar operands</a></li>
<li><a href="#_vector_operands">5.2. Vector Operands</a></li>
<li><a href="#_vector_masking">5.3. Vector Masking</a></li>
<li><a href="#_prestart_active_inactive_body_and_tail_element_definitions">5.4. Prestart, Active, Inactive, Body, and Tail Element Definitions</a></li>
</ul>
</li>
<li><a href="#_configuration_setting_instructions">6. Configuration-Setting Instructions</a>
<ul class="sectlevel2">
<li><a href="#_vsetvlivsetvl_instructions">6.1. <code>vsetvli</code>/<code>vsetvl</code> instructions</a></li>
<li><a href="#_constraints_on_setting_vl">6.2. Constraints on Setting <code>vl</code></a></li>
<li><a href="#_vsetvl_instruction">6.3. <code>vsetvl</code> Instruction</a></li>
<li><a href="#_examples">6.4. Examples</a></li>
</ul>
</li>
<li><a href="#_vector_loads_and_stores">7. Vector Loads and Stores</a>
<ul class="sectlevel2">
<li><a href="#_vector_loadstore_instruction_encoding">7.1. Vector Load/Store Instruction Encoding</a></li>
<li><a href="#_vector_loadstore_addressing_modes">7.2. Vector Load/Store Addressing Modes</a></li>
<li><a href="#_vector_loadstore_width_encoding">7.3. Vector Load/Store Width Encoding</a></li>
<li><a href="#_vector_unit_stride_instructions">7.4. Vector Unit-Stride Instructions</a></li>
<li><a href="#_vector_strided_instructions">7.5. Vector Strided Instructions</a></li>
<li><a href="#_vector_indexed_instructions">7.6. Vector Indexed Instructions</a></li>
<li><a href="#_unit_stride_fault_only_first_loads">7.7. Unit-stride Fault-Only-First Loads</a></li>
<li><a href="#sec-aos">7.8. Vector Load/Store Segment Instructions (<code>Zvlsseg</code>)</a></li>
</ul>
</li>
<li><a href="#_vector_amo_operations_zvamo">8. Vector AMO Operations (<code>Zvamo</code>)</a></li>
<li><a href="#_vector_memory_alignment_constraints">9. Vector Memory Alignment Constraints</a></li>
<li><a href="#_vector_memory_consistency_model">10. Vector Memory Consistency Model</a></li>
<li><a href="#_vector_arithmetic_instruction_formats">11. Vector Arithmetic Instruction Formats</a>
<ul class="sectlevel2">
<li><a href="#_vector_arithmetic_instruction_encoding">11.1. Vector Arithmetic Instruction encoding</a></li>
<li><a href="#sec-widening">11.2. Widening Vector Arithmetic Instructions</a></li>
<li><a href="#sec-narrowing">11.3. Narrowing Vector Arithmetic Instructions</a></li>
</ul>
</li>
<li><a href="#_vector_integer_arithmetic_instructions">12. Vector Integer Arithmetic Instructions</a>
<ul class="sectlevel2">
<li><a href="#_vector_single_width_integer_add_and_subtract">12.1. Vector Single-Width Integer Add and Subtract</a></li>
<li><a href="#_vector_widening_integer_addsubtract">12.2. Vector Widening Integer Add/Subtract</a></li>
<li><a href="#_vector_integer_add_with_carry_subtract_with_borrow_instructions">12.3. Vector Integer Add-with-Carry / Subtract-with-Borrow Instructions</a></li>
<li><a href="#_vector_bitwise_logical_instructions">12.4. Vector Bitwise Logical Instructions</a></li>
<li><a href="#_vector_single_width_bit_shift_instructions">12.5. Vector Single-Width Bit Shift Instructions</a></li>
<li><a href="#_vector_narrowing_integer_right_shift_instructions">12.6. Vector Narrowing Integer Right Shift Instructions</a></li>
<li><a href="#_vector_integer_comparison_instructions">12.7. Vector Integer Comparison Instructions</a></li>
<li><a href="#_vector_integer_minmax_instructions">12.8. Vector Integer Min/Max Instructions</a></li>
<li><a href="#_vector_single_width_integer_multiply_instructions">12.9. Vector Single-Width Integer Multiply Instructions</a></li>
<li><a href="#_vector_integer_divide_instructions">12.10. Vector Integer Divide Instructions</a></li>
<li><a href="#_vector_widening_integer_multiply_instructions">12.11. Vector Widening Integer Multiply Instructions</a></li>
<li><a href="#_vector_single_width_integer_multiply_add_instructions">12.12. Vector Single-Width Integer Multiply-Add Instructions</a></li>
<li><a href="#_vector_widening_integer_multiply_add_instructions">12.13. Vector Widening Integer Multiply-Add Instructions</a></li>
<li><a href="#_vector_integer_merge_instructions">12.14. Vector Integer Merge Instructions</a></li>
<li><a href="#_vector_integer_move_instructions">12.15. Vector Integer Move Instructions</a></li>
</ul>
</li>
<li><a href="#_vector_fixed_point_arithmetic_instructions">13. Vector Fixed-Point Arithmetic Instructions</a>
<ul class="sectlevel2">
<li><a href="#_vector_single_width_saturating_add_and_subtract">13.1. Vector Single-Width Saturating Add and Subtract</a></li>
<li><a href="#_vector_single_width_averaging_add_and_subtract">13.2. Vector Single-Width Averaging Add and Subtract</a></li>
<li><a href="#_vector_single_width_fractional_multiply_with_rounding_and_saturation">13.3. Vector Single-Width Fractional Multiply with Rounding and Saturation</a></li>
<li><a href="#_vector_widening_saturating_scaled_multiply_add">13.4. Vector Widening Saturating Scaled Multiply-Add</a></li>
<li><a href="#_vector_single_width_scaling_shift_instructions">13.5. Vector Single-Width Scaling Shift Instructions</a></li>
<li><a href="#_vector_narrowing_fixed_point_clip_instructions">13.6. Vector Narrowing Fixed-Point Clip Instructions</a></li>
</ul>
</li>
<li><a href="#_vector_floating_point_instructions">14. Vector Floating-Point Instructions</a>
<ul class="sectlevel2">
<li><a href="#_vector_floating_point_exception_flags">14.1. Vector Floating-Point Exception Flags</a></li>
<li><a href="#_vector_single_width_floating_point_addsubtract_instructions">14.2. Vector Single-Width Floating-Point Add/Subtract Instructions</a></li>
<li><a href="#_vector_widening_floating_point_addsubtract_instructions">14.3. Vector Widening Floating-Point Add/Subtract Instructions</a></li>
<li><a href="#_vector_single_width_floating_point_multiplydivide_instructions">14.4. Vector Single-Width Floating-Point Multiply/Divide Instructions</a></li>
<li><a href="#_vector_widening_floating_point_multiply">14.5. Vector Widening Floating-Point Multiply</a></li>
<li><a href="#_vector_single_width_floating_point_fused_multiply_add_instructions">14.6. Vector Single-Width Floating-Point Fused Multiply-Add Instructions</a></li>
<li><a href="#_vector_widening_floating_point_fused_multiply_add_instructions">14.7. Vector Widening Floating-Point Fused Multiply-Add Instructions</a></li>
<li><a href="#_vector_floating_point_square_root_instruction">14.8. Vector Floating-Point Square-Root Instruction</a></li>
<li><a href="#_vector_floating_point_minmax_instructions">14.9. Vector Floating-Point MIN/MAX Instructions</a></li>
<li><a href="#_vector_floating_point_sign_injection_instructions">14.10. Vector Floating-Point Sign-Injection Instructions</a></li>
<li><a href="#_vector_floating_point_compare_instructions">14.11. Vector Floating-Point Compare Instructions</a></li>
<li><a href="#_vector_floating_point_classify_instruction">14.12. Vector Floating-Point Classify Instruction</a></li>
<li><a href="#_vector_floating_point_merge_instruction">14.13. Vector Floating-Point Merge Instruction</a></li>
<li><a href="#_vector_floating_point_move_instruction">14.14. Vector Floating-Point Move Instruction</a></li>
<li><a href="#_single_width_floating_pointinteger_type_convert_instructions">14.15. Single-Width Floating-Point/Integer Type-Convert Instructions</a></li>
<li><a href="#_widening_floating_pointinteger_type_convert_instructions">14.16. Widening Floating-Point/Integer Type-Convert Instructions</a></li>
<li><a href="#_narrowing_floating_pointinteger_type_convert_instructions">14.17. Narrowing Floating-Point/Integer Type-Convert Instructions</a></li>
</ul>
</li>
<li><a href="#_vector_reduction_operations">15. Vector Reduction Operations</a>
<ul class="sectlevel2">
<li><a href="#_vector_single_width_integer_reduction_instructions">15.1. Vector Single-Width Integer Reduction Instructions</a></li>
<li><a href="#_vector_widening_integer_reduction_instructions">15.2. Vector Widening Integer Reduction Instructions</a></li>
<li><a href="#_vector_single_width_floating_point_reduction_instructions">15.3. Vector Single-Width Floating-Point Reduction Instructions</a></li>
<li><a href="#_vector_widening_floating_point_reduction_instructions">15.4. Vector Widening Floating-Point Reduction Instructions</a></li>
</ul>
</li>
<li><a href="#_vector_mask_instructions">16. Vector Mask Instructions</a>
<ul class="sectlevel2">
<li><a href="#sec-mask-register-logical">16.1. Vector Mask-Register Logical Instructions</a></li>
<li><a href="#_vector_mask_population_count_vpopc">16.2. Vector mask population count <code>vpopc</code></a></li>
<li><a href="#_vfirst_find_first_set_mask_bit">16.3. <code>vfirst</code> find-first-set mask bit</a></li>
<li><a href="#_vmsbf_m_set_before_first_mask_bit">16.4. <code>vmsbf.m</code> set-before-first mask bit</a></li>
<li><a href="#_vmsif_m_set_including_first_mask_bit">16.5. <code>vmsif.m</code> set-including-first mask bit</a></li>
<li><a href="#_vmsof_m_set_only_first_mask_bit">16.6. <code>vmsof.m</code> set-only-first mask bit</a></li>
<li><a href="#_example_using_vector_mask_instructions">16.7. Example using vector mask instructions</a></li>
<li><a href="#_vector_iota_instruction">16.8. Vector Iota Instruction</a></li>
<li><a href="#_vector_element_index_instruction">16.9. Vector Element Index Instruction</a></li>
</ul>
</li>
<li><a href="#_vector_permutation_instructions">17. Vector Permutation Instructions</a>
<ul class="sectlevel2">
<li><a href="#_integer_scalar_move_instructions">17.1. Integer Scalar Move Instructions</a></li>
<li><a href="#_floating_point_scalar_move_instructions">17.2. Floating-Point Scalar Move Instructions</a></li>
<li><a href="#_vector_slide_instructions">17.3. Vector Slide Instructions</a></li>
<li><a href="#_vector_register_gather_instruction">17.4. Vector Register Gather Instruction</a></li>
<li><a href="#_vector_compress_instruction">17.5. Vector Compress Instruction</a></li>
</ul>
</li>
<li><a href="#_exception_handling">18. Exception Handling</a>
<ul class="sectlevel2">
<li><a href="#_precise_vector_traps">18.1. Precise vector traps</a></li>
<li><a href="#_imprecise_vector_traps">18.2. Imprecise vector traps</a></li>
<li><a href="#_selectable_preciseimprecise_traps">18.3. Selectable precise/imprecise traps</a></li>
<li><a href="#_swappable_traps">18.4. Swappable traps</a></li>
</ul>
</li>
<li><a href="#_divided_element_extension_zvediv">19. Divided Element Extension ('Zvediv')</a>
<ul class="sectlevel2">
<li><a href="#_instructions_not_affected_by_ediv">19.1. Instructions not affected by EDIV</a></li>
<li><a href="#_instructions_affected_by_ediv">19.2. Instructions Affected by EDIV</a></li>
<li><a href="#_vector_integer_dot_product_instruction">19.3. Vector Integer Dot-Product Instruction</a></li>
<li><a href="#_vector_floating_point_dot_product_instruction">19.4. Vector Floating-Point Dot Product Instruction</a></li>
</ul>
</li>
<li><a href="#_vector_instruction_listing">20. Vector Instruction Listing</a></li>
<li><a href="#_vector_assembly_code_examples">Appendix A: Vector Assembly Code Examples</a>
<ul class="sectlevel2">
<li><a href="#_vector_vector_add_example">A.1. Vector-vector add example</a></li>
<li><a href="#_example_with_mixed_width_mask_and_compute">A.2. Example with mixed-width mask and compute.</a></li>
<li><a href="#_memcpy_example">A.3. Memcpy example</a></li>
<li><a href="#_conditional_example">A.4. Conditional example</a></li>
<li><a href="#_saxpy_example">A.5. SAXPY example</a></li>
<li><a href="#_sgemm_example">A.6. SGEMM example</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Contributors include: Alon Amid, Krste Asanovic, Allen Baum, Alex
Bradbury, Tony Brewer, Chris Celio, Aliaksei Chapyzhenka, Silviu
Chiricescu, Ken Dockser, Bob Dreyer, Roger Espasa, Sean Halle, John
Hauser, David Horner, Bruce Hoult, Bill Huffman, Constantine Korikov,
Ben Korpan, Robin Kruppe, Yunsup Lee, Guy Lemieux, Filip Moc, Rich
Newell, Albert Ou, David Patterson, Colin Schmidt, Alex Solomatnikov,
Steve Wallach, Andrew Waterman, Jim Wilson.</p>
</div>
<div class="paragraph">
<p>Known issues with current version:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>encoding needs better formatting</p>
</li>
<li>
<p>vector memory consistency model needs to be clarified</p>
</li>
<li>
<p>interaction with privileged architectures</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document describes the draft of the RISC-V base vector extension.
The document describes all the individual features of the base vector
extension.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This is a draft of a stable proposal for the vector
specification to be used for implementation and evaluation.  Once the
draft label is removed, version 0.7 is intended to be stable enough to
begin developing toolchains, functional simulators, and initial
implementations, though will continue to evolve with minor changes and
updates.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The term <em>base</em> <em>vector</em> <em>extension</em> is used informally to describe
the standard set of vector ISA components.  This draft spec is
intended to capture how a certain vector function will be implemented
as vector instructions, but to not yet determine what set of vector
instructions are mandatory for a given platform.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Each actual platform profile will formally specify the mandatory
components of any vector extension adopted by that platform.  The base
vector extension can expected to be close to that which will
eventually be used in the standard Unix platform profile that supports
vectors.  Other platforms, including embedded platforms, may choose to
implement subsets of these extensions.  The exact set of mandatory
supported instructions for an implementation to be compliant with a
given profile is subject to change until each profile spec is
ratified.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The base vector extension is designed to act as a base for additional
vector extensions in various domains, including cryptography and
machine learning.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_defined_constant_parameters">2. Implementation-defined Constant Parameters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Each hart supporting the vector extension defines three parameters:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The maximum size of a single vector element in bits, <em>ELEN</em>, which
must be a power of 2.</p>
</li>
<li>
<p>The number of bits in a vector register, <em>VLEN</em> &#8805; <em>ELEN</em>, which must
be a power of 2.</p>
</li>
<li>
<p>The striping distance in bits, <em>SLEN</em>, which must be VLEN &#8805; SLEN &#8805;
32, and which must be a power of 2.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Platform profiles may set further constraints on these
parameters, for example, requiring that ELEN &#8805; max(XLEN,FLEN), or
requiring a minimum VLEN value, or setting an SLEN value.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The ISA supports writing binary code that under certain constraints
will execute portably on harts with different values for these
parameters.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Code can be written that will expose differences in
implementation parameters.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Thread contexts with active vector state cannot be migrated
during execution between harts that have any difference in VLEN, ELEN,
or SLEN parameters.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vector_extension_programmers_model">3. Vector Extension Programmer&#8217;s Model</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The vector extension adds 32 vector registers, and five unprivileged
CSRs (<code>vstart</code>, <code>vxsat</code>, <code>vxrm</code>, <code>vtype</code>, <code>vl</code>) to a base scalar
RISC-V ISA.  If the base scalar ISA does not include floating-point,
then a <code>fcsr</code> register is also added to hold mirrors of the <code>vxsat</code>
and <code>vxrm</code> CSRs as explained below.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 1. New vector CSRs</caption>
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Address</th>
<th class="tableblock halign-left valign-top">Privilege</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x008</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vstart</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vector start position</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x009</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vxsat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fixed-Point Saturate Flag</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x00A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vxrm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fixed-Point Rounding Mode</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xC20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vector length</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xC21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vtype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vector data type register</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_vector_registers">3.1. Vector Registers</h3>
<div class="paragraph">
<p>The vector extension adds 32 architectural vector registers,
<code>v0</code>-<code>v31</code> to the base scalar RISC-V ISA.</p>
</div>
<div class="paragraph">
<p>Each vector register has a fixed VLEN bits of state.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Zfinx ("F in X") is a new ISA option under consideration where
floating-point instructions take their arguments from the integer
register file.  The 0.7 vector extension is also compatible with this
option.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_type_register_vtype">3.2. Vector type register, <code>vtype</code></h3>
<div class="paragraph">
<p>The read-only XLEN-wide <em>vector</em> <em>type</em> CSR, <code>vtype</code> provides the
default type used to interpret the contents of the vector register
file, and can only be updated by <code>vsetvl{i}</code> instructions. The vector
type also determines the organization of elements in each vector
register, and how multiple vector registers are grouped.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Earlier drafts allowed the <code>vtype</code> register to be written using
regular CSR writes.  Allowing updates only via the <code>vsetvl{i}</code>
instructions simplifies maintenance of the <code>vtype</code> register state.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the base vector extension, the <code>vtype</code> register has three fields,
<code>vill</code>, <code>vsew[2:0]</code>, and <code>vlmul[1:0]</code>.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 2. <code>vtype</code> register layout</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-right valign-top">Bits</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">XLEN-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vill</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Illegal value if set</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">XLEN-2:7</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved (write 0)</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">6:5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vediv[1:0]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used by EDIV extension</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">4:2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsew[2:0]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard element width (SEW) setting</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">1:0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlmul[1:0]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vector register group multiplier (LMUL) setting</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The smallest base implementation requires storage for only four
bits of storage in <code>vtype</code>, two bits for <code>vsew[1:0]</code> and two bits for
<code>vlmul[1:0]</code>.  The illegal value represented by <code>vill</code> can be encoded
using the illegal 64-bit combination in <code>vsew[1:0]</code> without requiring
an additional storage bit.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The vediv[1:0] field is used by the EDIV extension described below.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Further standard and custom extensions to the vector base will
extend these fields to support a greater variety of data types.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It is anticipated that an extended 64-bit instruction encoding
would allow these fields to be specified statically in the instruction
encoding.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_vector_standard_element_width_vsew">3.2.1. Vector standard element width <code>vsew</code></h4>
<div class="paragraph">
<p>The value in <code>vsew</code> sets the dynamic <em>standard</em> <em>element</em> <em>width</em>
(SEW).  By default, a vector register is viewed as being divided into
VLEN / SEW standard-width elements.  In the base vector extension,
only SEW up to max(XLEN,FLEN) are required to be supported.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 3. vsew[2:0] (standard element width) encoding</caption>
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3">vsew[2:0]</th>
<th class="tableblock halign-left valign-top">SEW</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">16</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">32</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">64</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">128</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">256</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">512</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">1024</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 4. Example VLEN = 128 bits</caption>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-right valign-top">SEW</th>
<th class="tableblock halign-right valign-top">Elements per vector register</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">64</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">8</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">16</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_vector_register_grouping_vlmul">3.2.2. Vector Register Grouping (<code>vlmul</code>)</h4>
<div class="paragraph">
<p>Multiple vector registers can be grouped together to form a <em>vector</em>
<em>register</em> <em>group</em>, so that a single vector instruction can operate on
multiple vector registers.  Vector register groups allow double-width
or larger elements to be operated on with the same vector length as
standard-width elements.  Vector register groups also provide greater
execution efficiency for longer application vectors.</p>
</div>
<div class="paragraph">
<p>The number of vector registers in a group, <em>LMUL</em>, is an integer power
of two set by the <code>vlmul</code> field in <code>vtype</code> (LMUL = 2<sup><code>vlmul[1:0]</code></sup>).</p>
</div>
<div class="paragraph">
<p>The derived value VLMAX = LMUL*VLEN/SEW represents the maximum number
of elements that can be operated on with a single vector instruction
given the current SEW and LMUL settings.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">vlmul</th>
<th class="tableblock halign-left valign-top">LMUL</th>
<th class="tableblock halign-left valign-top">#groups</th>
<th class="tableblock halign-left valign-top">VLMAX</th>
<th class="tableblock halign-left valign-top">Grouped registers</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VLEN/SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vn (no group)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2*VLEN/SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vn, vn+1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4*VLEN/SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vn, &#8230;&#8203;, vn+3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8*VLEN/SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vn, &#8230;&#8203;, vn+7</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When <code>vlmul=01</code>, then vector operations on register <code>v</code> <em>n</em> also
operate on vector register <code>v</code> <em>n</em>+1, giving twice the vector length
in bits.  Instructions specifying a vector operand with an
odd-numbered vector register will raise an illegal instruction
exception.</p>
</div>
<div class="paragraph">
<p>Similarly, when <code>vlmul=10</code>, vector instructions operate on four
vector registers at a time, and instructions specifying vector
operands using vector register numbers that are not multiples of four
will raise an illegal instruction exception.  When <code>vlmul=11</code>,
operations operate on eight vector registers at a time, and
instructions specifying vector operands using register numbers that
are not multiples of eight will raise an illegal instruction
exception.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This grouping pattern (LMUL=8 has groups <code>v0</code>,<code>v8</code>,<code>v16</code>,<code>v24</code>)
was adopted in 0.6 initially to avoid issues with the floating-point
calling convention when floating-point values were overlaid on the
vector registers, whereas earlier versions kept the vector register
group names contiguous (LMUL=8 has groups <code>v0</code>, <code>v1</code>, <code>v2</code>, <code>v3</code>).  In
versions v0.7 onwards, the floating-point registers are separate again.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Mask register instructions always operate on a single vector register,
regardless of LMUL setting.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vector_type_illegal_vill">3.2.3. Vector Type Illegal <code>vill</code></h4>
<div class="paragraph">
<p>The <code>vill</code> bit is used to encode that a previous <code>vsetvl{i}</code>
instruction attempted to write an unsupported value to <code>vtype</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>vill</code> bit is held in bit XLEN-1 of the CSR to support
checking for illegal values with a branch on the sign bit.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the <code>vill</code> bit is set, then any attempt to execute a vector
instruction (other than a vector configuration instruction) will raise
an illegal instruction exception.</p>
</div>
<div class="paragraph">
<p>When the <code>vill</code> bit is set, the other XLEN-1 bits in <code>vtype</code> shall be
zero.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_length_register_vl">3.3. Vector Length Register <code>vl</code></h3>
<div class="paragraph">
<p>The <em>XLEN</em>-bit-wide read-only <code>vl</code> CSR can only be updated by the
<code>vsetvli</code> and <code>vsetvl</code> instructions, and the <em>fault-only-first</em> vector load
instruction variants.</p>
</div>
<div class="paragraph">
<p>The <code>vl</code> register holds an unsigned integer specifying the number of
elements to be updated by a vector instruction.  Elements in any
destination vector register group with indices &#8805; <code>vl</code> are unmodified during
execution of a vector instruction.  When <code>vstart</code> &#8805; <code>vl</code>,
no elements are updated in any destination vector register group.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As a consequence, when <code>vl</code>=0, no elements are updated in the
destination vector register group, regardless of <code>vstart</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Instructions that write a scalar integer or floating-point register
do so even when <code>vstart</code> &#8805; <code>vl</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The number of bits implemented in <code>vl</code> depends on the
implementation&#8217;s maximum vector length of the smallest supported
type. The smallest vector implementation, RV32IV, would need at least
six bits in <code>vl</code> to hold the values 0-32 (with VLEN=32, LMUL=8 and
SEW=8 results in VLMAX of 32).
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_start_index_csr_vstart">3.4. Vector Start Index CSR <code>vstart</code></h3>
<div class="paragraph">
<p>The <code>vstart</code> read-write CSR specifies the index of the first element
to be executed by a vector instruction.</p>
</div>
<div class="paragraph">
<p>Normally, <code>vstart</code> is only written by hardware on a trap on a vector
instruction, with the <code>vstart</code> value representing the element on which
the trap was taken (either a synchronous exception or an asynchronous
interrupt), and at which execution should resume after a resumable
trap is handled.</p>
</div>
<div class="paragraph">
<p>All vector instructions are defined to begin execution with the
element number given in the <code>vstart</code> CSR, leaving earlier elements in
the destination vector undisturbed, and to reset the <code>vstart</code> CSR to
zero at the end of execution.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
All vector instructions, including <code>vsetvl{i}</code>, reset the <code>vstart</code>
CSR to zero.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the value in the <code>vstart</code> register is greater than or equal to the
vector length <code>vl</code> then no element operations are performed.  The
<code>vstart</code> register is then reset to zero.</p>
</div>
<div class="paragraph">
<p>The <code>vstart</code> CSR is defined to have only enough writable bits to hold
the largest element index (one less than the maximum VLMAX) or
lg2(VLEN) bits.  The upper bits of the <code>vstart</code> CSR are hardwired to
zero (reads zero, writes ignored).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The maximum vector length is obtained with the largest LMUL
setting (8) and the smallest SEW setting (8), so VLMAX_max = 8*VLEN/8
= VLEN.  For example, for VLEN=256, <code>vstart</code> would have 8 bits to
represent indices from 0 through 255.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>vstart</code> CSR is writable by unprivileged code, but non-zero
<code>vstart</code> values may cause vector instructions to run substantially
slower on some implementations, so <code>vstart</code> should not be used by
application programmers.  A few vector instructions can not be
executed with a non-zero <code>vstart</code> value and will raise an illegal
instruction exception as defined below.</p>
</div>
<div class="paragraph">
<p>Implementations are permitted to raise illegal instruction exceptions when
attempting to execute a vector instruction with a value of <code>vstart</code> that the
implementation can never produce when executing that same instruction with
the same <code>vtype</code> setting.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For example, some implementations will never take interrupts during
execution of a vector arithmetic instruction, instead waiting until the
instruction completes to take the interrupt.  Such implementations are
permitted to raise an illegal instruction exception when attempting to execute
a vector arithmetic instruction when <code>vstart</code> is nonzero.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_fixed_point_rounding_mode_register_vxrm">3.5. Vector Fixed-Point Rounding Mode Register <code>vxrm</code></h3>
<div class="paragraph">
<p>The vector fixed-point rounding-mode register holds a two-bit
read-write rounding-mode field.  The vector fixed-point rounding-mode
is given a separate CSR address to allow independent access, but is
also reflected as a field in the upper bits of <code>fcsr</code>.  Systems
without floating-point must add <code>fcsr</code> when adding the vector
extension.</p>
</div>
<div class="paragraph">
<p>The fixed-point rounding algorithm is specified as follows.
Suppose the pre-rounding result is <code>v</code>, and <code>d</code> bits of that result are to be
rounded off.
Then the rounded result is <code>(v &gt;&gt; d) + r</code>, where <code>r</code> depends on the rounding
mode as specified in the following table.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 5. vxrm encoding</caption>
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">Bits [1:0]</th>
<th class="tableblock halign-left valign-top">Abbreviation</th>
<th class="tableblock halign-left valign-top">Rounding Mode</th>
<th class="tableblock halign-left valign-top">Rounding increment, <code>r</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rnu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">round-to-nearest-up (add +0.5 LSB)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>v[d-1]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rne</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">round-to-nearest-even</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>v[d-1] &amp; (v[d-2:0]&#8800;0 | v[d])</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rdn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">round-down (truncate)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rod</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">round-to-odd (OR bits into LSB, aka "jam")</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>!v[d] &amp; v[d-1:0]&#8800;0</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Bits[XLEN-1:2] should be written as zeros.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The rounding mode can be set with a single <code>csrwi</code> instruction.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_fixed_point_saturation_flag_vxsat">3.6. Vector Fixed-Point Saturation Flag <code>vxsat</code></h3>
<div class="paragraph">
<p>The <code>vxsat</code> CSR holds a single read-write bit that indicates if a
fixed-point instruction has had to saturate an output value to fit
into a destination format.</p>
</div>
<div class="paragraph">
<p>The <code>vxsat</code> bit is mirrored in the upper bits of <code>fcsr</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_vector_fixed_point_fields_in_fcsr">3.7. Vector Fixed-Point Fields in <code>fcsr</code></h3>
<div class="paragraph">
<p>The <code>vxrm</code> and <code>vxsat</code> separate CSRs can also be accessed via fields
in the floating-point CSR, <code>fcsr</code>.  The <code>fcsr</code> register must be added
to systems without floating-point that add a vector extension.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 6. fcsr layout</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-right valign-top">Bits</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">10:9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vxrm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fixed-point rounding mode</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vxsat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fixed-point accrued saturation flag</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">7:5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">frm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Floating-point rounding mode</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">4:0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fflags</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Floating-point accrued exception flags</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The fields are packed into <code>fcsr</code> to make context-save/restore
faster.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_state_of_vector_extension_at_reset">3.8. State of Vector Extension at Reset</h3>
<div class="paragraph">
<p>The vector extension must have a consistent state at reset.  In
particular, <code>vtype</code> and <code>vl</code> must have values that can be read and
then restored with a single <code>vsetvl</code> instruction.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It is recommended that at reset, <code>vtype.vill</code> is set, the
remaining bits in <code>vtype</code> are zero, and <code>vl</code> is set to zero.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>vstart</code>, <code>vxrm</code>, <code>vxsat</code> CSRs can have arbitrary values at reset.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Any use of the vector unit will require an initial <code>vsetvl{i}</code>,
which will reset <code>vstart</code>.  The <code>vxrm</code> and <code>vxsat</code> fields should be
reset explicitly in software before use.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The vector registers can have arbitrary values at reset.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mapping_of_vector_elements_to_vector_register_state">4. Mapping of Vector Elements to Vector Register State</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following diagrams illustrate how different width elements are
packed into the bytes of a vector register depending on the current
SEW and LMUL settings, as well as implementation ELEN and VLEN.
Elements are packed into each vector register with the
least-significant byte in the lowest-numbered bits.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Previous RISC-V vector proposals (&lt; 0.6) hid this mapping from
software, whereas this proposal has a specific mapping for all
configurations, which reduces implementation flexibility but removes
need for zeroing on config changes.  Making the mapping explicit also
has the advantage of simplifying oblivious context save-restore code,
as the code can save the configuration in <code>vl</code> and <code>vtype</code>,
then reset <code>vtype</code> to a convenient value (e.g., four vector groups of
LMUL=8, SEW=ELEN) before saving all vector register bits without
needing to parse the configuration.  The reverse process will restore
the state.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_mapping_with_lmul1">4.1. Mapping with LMUL=1</h3>
<div class="paragraph">
<p>When LMUL=1, elements are simply packed in order from the
least-significant to most-significant bits of the vector register.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
To increase readability, vector register layouts are drawn with
bytes ordered from right to left with increasing byte address.  Bits
within an element are numbered in a little-endian format with
increasing bit index from right to left corresponding to increasing
magnitude.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>  The element index is given in hexadecimal and is shown placed at the least-significant byte of the stored element. ELEN &lt;=128 and LMUL=1 throughout.


 VLEN=32b

 Byte         3 2 1 0

 SEW=8b       3 2 1 0
 SEW=16b        1   0
 SEW=32b            0

 VLEN=64b

 Byte        7 6 5 4 3 2 1 0

 SEW=8b      7 6 5 4 3 2 1 0
 SEW=16b       3   2   1   0
 SEW=32b           1       0
 SEW=64b                   0

 VLEN=128b

 Byte        F E D C B A 9 8 7 6 5 4 3 2 1 0

 SEW=8b      F E D C B A 9 8 7 6 5 4 3 2 1 0
 SEW=16b       7   6   5   4   3   2   1   0
 SEW=32b           3       2       1       0
 SEW=64b                   1               0
 SEW=128b                                  0

 VLEN=256b

 Byte     1F1E1D1C1B1A19181716151413121110 F E D C B A 9 8 7 6 5 4 3 2 1 0

 SEW=8b   1F1E1D1C1B1A19181716151413121110 F E D C B A 9 8 7 6 5 4 3 2 1 0
 SEW=16b     F   E   D   C   B   A   9   8   7   6   5   4   3   2   1   0
 SEW=32b         7       6       5       4       3       2       1       0
 SEW=64b                 3               2               1               0
 SEW=128b                                1                               0</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mapping_with_lmul_1">4.2. Mapping with LMUL &gt; 1</h3>
<div class="paragraph">
<p>When vector registers are grouped, the elements of the vector register
group are striped across the constituent vector registers.  The
striping distance in bits, SLEN, sets how many bits are packed
contiguously into one vector register before moving to the next in the
group.</p>
</div>
<div class="paragraph">
<p>For example, when SLEN = 128, the striping pattern is repeated in
multiples of 128 bits.  The first 128/SEW elements are packed
contiguously at the start of the first vector register in the group.
The next 128/SEW elements are packed contiguously at the start of the
next vector register in the group.  After packing the first
LMUL*128/SEW elements at the start of each of the LMUL vector
registers in the group, the second LMUL*128/SEW group of elements are
packed into the second 128b segment of each of the vector registers in
the group, and so on.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> Example 1: VLEN=32b, SEW=16b, LMUL=2

 Byte         3 2 1 0
 v2*n           1   0
 v2*n+1         3   2

 Example 2: VLEN=64b, SEW=32b, LMUL=2

 Byte         7 6 5 4 3 2 1 0
 v2*n               1       0
 v2*n+1             3       2

 Example 3: VLEN=128b, SEW=32b, LMUL=2

 Byte        F E D C B A 9 8 7 6 5 4 3 2 1 0
 v2*n              3       2       1       0
 v2*n+1            7       6       5       4

 Example 4: VLEN=256b, SEW=32b, LMUL=2

 Byte     1F1E1D1C1B1A19181716151413121110 F E D C B A 9 8 7 6 5 4 3 2 1 0
 v2*n            B       A       9       8       3       2       1       0
 v2*n+1          F       E       D       C       7       6       5       4</pre>
</div>
</div>
<div class="paragraph">
<p>If SEW &gt; SLEN, the striping pattern places one element in each
vector register in the group before moving to the next vector register
in the group.  So, when LMUL=2, the even-numbered vector register
contains the even-numbered elements of the vector and the odd-numbered
vector register contains the odd-numbered elements of the vector.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In most implementations, the striping distance SLEN &#8805; ELEN.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre> Example: VLEN=256b, SEW=256b, LMUL=2

 Byte     1F1E1D1C1B1A19181716151413121110 F E D C B A 9 8 7 6 5 4 3 2 1 0
 v2*n                                                                    0
 v2*n+1                                                                  1</pre>
</div>
</div>
<div class="paragraph">
<p>When LMUL = 4, four vector registers hold elements as shown:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> Example 1: VLEN=32b, SLEN=32b, SEW=16b, LMUL=4,

 Byte         3 2 1 0
 v4*n           1   0
 v4*n+1         3   2
 v4*n+2         5   4
 v4*n+3         7   6

 Example 2: VLEN=64b, SLEN=64b, SEW=32b, LMUL=4

 Byte         7 6 5 4 3 2 1 0
 v4*n               1       0
 v4*n+1             3       2
 v4*n+2             5       4
 v4*n+3             7       6


 Example 3: VLEN=128b, SLEN=64b, SEW=32b, LMUL=4

 Byte          F E D C B A 9 8 7 6 5 4 3 2 1 0
 v4*n                9       8       1       0   32b elements
 v4*n+1              B       A       3       2
 v4*n+2              D       C       5       4
 v4*n+3              F       E       7       6

 Example 4: VLEN=128b, SLEN=128b, SEW=32b, LMUL=4

 Byte          F E D C B A 9 8 7 6 5 4 3 2 1 0
 v4*n                3       2       1       0   32b elements
 v4*n+1              7       6       5       4
 v4*n+2              B       A       9       8
 v4*n+3              F       E       D       C

 Example 5: VLEN=256b, SLEN=128b, SEW=32b, LMUL=4

 Byte     1F1E1D1C1B1A19181716151413121110 F E D C B A 9 8 7 6 5 4 3 2 1 0
 v4*n           13      12      11      10       3       2       1       0
 v4*n+1         17      16      15      14       7       6       5       4
 v4*n+2         1B      1A      19      18       B       A       9       8
 v4*n+3         1F      1E      1D      1C       F       E       D       C

 Example 6: VLEN=256b, SLEN=128b, SEW=256b, LMUL=4

 Byte     1F1E1D1C1B1A19181716151413121110 F E D C B A 9 8 7 6 5 4 3 2 1 0
 v4*n                                                                    0
 v4*n+1                                                                  1
 v4*n+2                                                                  2
 v4*n+3                                                                  3</pre>
</div>
</div>
<div class="paragraph">
<p>A similar pattern is followed for LMUL = 8.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> Example: VLEN=256b, SLEN=128b, SEW=32b, LMUL=8

 Byte   1F1E1D1C1B1A19181716151413121110 F E D C B A 9 8 7 6 5 4 3 2 1 0
 v8*n         23      22      21      20       3       2       1       0
 v8*n+1       27      26      25      24       7       6       5       4
 v8*n+2       2B      2A      29      28       B       A       9       8
 v8*n+3       2F      2E      2D      2C       F       E       D       C
 v8*n+4       33      32      31      30      13      12      11      10
 v8*n+5       37      36      35      34      17      16      15      14
 v8*n+6       3B      3A      39      38      1B      1A      19      18
 v8*n+7       3F      3E      3D      3C      1F      1E      1D      1C</pre>
</div>
</div>
<div class="paragraph">
<p>Different striping patterns are architecturally visible, but software
can be written that produces the same results regardless of striping
pattern. The primary constraint is to not change the LMUL used to
access values held in a vector register group (i.e., do not read
values with a different LMUL than used to write values to the group).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The striping length SLEN for an implementation is set to
optimize the tradeoff between datapath wiring for mixed-width
operations and buffering needed to corner-turn wide vector unit-stride
memory accesses into parallel accesses for the vector register file.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The previous explicit configuration design (version &lt; 0.6)
allowed these tradeoffs to be managed at the microarchitectural level
and optimized for each configuration.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_mapping_across_mixed_width_operations">4.3. Mapping across Mixed-Width Operations</h3>
<div class="paragraph">
<p>The pattern used to map elements within a vector register group is
designed to reduce datapath wiring when supporting operations across
multiple element widths.  The recommended software strategy in this
case is to modify <code>vtype</code> dynamically to keep SEW/LMUL constant (and
hence VLMAX constant).</p>
</div>
<div class="paragraph">
<p>The following example shows four different packed element widths (8b,
16b, 32b, 64b) in a VLEN=256b/SLEN=128b implementation.  The vector
register grouping factor (LMUL) is increased by the relative element
size such that each group can hold the same number of vector elements
(32 in this example) to simplify stripmining code.  Any operation
between elements with the same index only touches operand bits located
within the same 128b portion of the datapath.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> VLEN=256b, SLEN=128b
 Byte     1F1E1D1C1B1A19181716151413121110 F E D C B A 9 8 7 6 5 4 3 2 1 0

 SEW=8b, LMUL=1, VLMAX=32

 v1       1F1E1D1C1B1A19181716151413121110 F E D C B A 9 8 7 6 5 4 3 2 1 0

 SEW=16b, LMUL=2, VLMAX=32

 v2*n       17  16  15  14  13  12  11  10   7   6   5   4   3   2   1   0
 v2*n+1     1F  1E  1D  1C  1B  1A  19  18   F   E   D   C   B   A   9   8

 SEW=32b, LMUL=4, VLMAX=32

 v4*n           13      12      11      10       3       2       1       0
 v4*n+1         17      16      15      14       7       6       5       4
 v4*n+2         1B      1A      19      18       B       A       9       8
 v4*n+3         1F      1E      1D      1C       F       E       D       C

 SEW=64b, LMUL=8, VLMAX=32

 v8*n                   11              10               1               0
 v8*n+1                 13              12               3               2
 v8*n+2                 15              14               5               4
 v8*n+3                 17              16               7               6
 v8*n+4                 19              18               9               8
 v8*n+5                 1B              1A               B               A
 v8*n+6                 1D              1C               D               C
 v8*n+7                 1F              1E               F               E</pre>
</div>
</div>
<div class="paragraph">
<p>Larger LMUL settings can also used to simply increase vector length to
reduce instruction fetch and dispatch overheads, in cases where fewer
logical vector registers are required.</p>
</div>
<div class="paragraph">
<p>The following table shows each possible constant SEW/LMUL operating
point for loops with mixed-width operations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>       Numbers in columns are LMUL values, and each column
       represents constant SEW/LMUL operating point

 SEW/LMUL    1   2   4   8  16  32  64 128 256 512 1024

      SEW
        8    8   4   2   1
       16        8   4   2   1
       32            8   4   2   1
       64                8   4   2   1
      128                    8   4   2   1
      256                        8   4   2   1
      512                            8   4   2   1
     1024                                8   4   2   1</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Larger LMUL values can cause lower datapath utilization for
short vectors if SLEN is less than the spatial datapath width.  In the
example above with VLEN=256b, SLEN=128b, and LMUL=8, if the
implementation is purely spatial with a 256b-wide vector datapath,
then for an application vector length less than 17, only half of the
datapath will be active.  The <code>vsetvl</code> instructions below could have a
facility added to dynamically select an appropriate LMUL according to
the required application vector length (AVL) and range of element
widths.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Narrower machines will set SLEN to be at least as large as the
datapath spatial width, so there is no need to reduce LMUL. Wider
machines might set SLEN lower than the spatial datapath width to
reduce wiring for mixed-width operations (e.g., width=1024, ELEN=32,
SLEN=128), in which case optimizing LMUL will be important.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec-mask-register-layout">4.4. Mask Register Layout</h3>
<div class="paragraph">
<p>A vector mask occupies only one vector register regardless of SEW and
LMUL.  The mask bits that are used for each vector operation depends
on the current SEW and LMUL setting.</p>
</div>
<div class="paragraph">
<p>The maximum number of elements in a vector operand is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>               VLMAX = LMUL * VLEN/SEW</pre>
</div>
</div>
<div class="paragraph">
<p>A mask is allocated for each element by dividing the mask register
into VLEN/VLMAX fields.  The size of each mask element in bits, <em>MLEN</em>,
is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>                MLEN = VLEN/VLMAX
                     = VLEN/(LMUL * VLEN/SEW)
                     = SEW/LMUL</pre>
</div>
</div>
<div class="paragraph">
<p>The size of MLEN varies from ELEN (SEW=ELEN, LMUL=1) down to 1
(SEW=8b,LMUL=8), and hence a single vector register can always hold
the entire mask register.</p>
</div>
<div class="paragraph">
<p>The mask bits for element <em>i</em> are located in bits [MLEN*<em>i</em>+(MLEN-1) :
MLEN*<em>i</em>] of the mask register.  When a mask element is written by a
compare instruction, the low bit in the mask element is written with
the compare result and the upper bits of the mask element are zeroed.
Destination mask elements past the end of the current vector length
are unchanged.  When a value is read as a mask, only the
least-significant bit of the mask element is used to control masking
and the upper bits are ignored.</p>
</div>
<div class="paragraph">
<p>The pattern is such that for constant SEW/LMUL values, the effective
predicate bits are located in the same bit of the mask vector
register, which simplifies use of masking in loops with mixed-width
elements.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> VLEN=32b

          Byte    3   2   1   0
 LMUL=1,SEW=8b
                  3   2   1   0  Element
                [24][16][08][00] Mask bit position in decimal

 LMUL=2,SEW=16b
                      1       0
                    [08]    [00]
                      3       2
                    [24]    [16]

 LMUL=4,SEW=32b               0
                            [00]
                              1
                            [08]
                              2
                            [16]
                              3
                            [24]</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre> LMUL=2,SEW=8b
                  3   2   1   0
                [12][08][04][00]
                  7   6   5   4
                [28][24][20][16]

 LMUL=8,SEW=32b
                              0
                            [00]
                              1
                            [04]
                              2
                            [08]
                              3
                            [12]
                              4
                            [16]
                              5
                            [20]
                              6
                            [24]
                              7
                            [28]

 LMUL=8,SEW=8b
                  3   2   1   0
                [03][02][01][00]
                  7   6   5   4
                [07][06][05][04]
                  B   A   9   8
                [11][10][09][08]
                  F   E   D   C
                [15][14][13][12]
                 13  12  11  10
                [19][18][17][16]
                 17  16  15  14
                [23][22][21][20]
                 1B  1A  19  18
                [27][26][25][24]
                 1F  1E  1D  1C
                [31][30][29][28]</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre> VLEN=256b, SLEN=128b
 Byte     1F1E1D1C1B1A19181716151413121110 F E D C B A 9 8 7 6 5 4 3 2 1 0

 SEW=8b, LMUL=1, VLMAX=32

 v1       1F1E1D1C1B1A19181716151413121110 F E D C B A 9 8 7 6 5 4 3 2 1 0
        [248]          ...            [128] ...[96] ...[64] ...[32] ... [0] Mask bit positions in decimal

 SEW=16b, LMUL=2, VLMAX=32

 v2*n       17  16  15  14  13  12  11  10   7   6   5   4   3   2   1   0
          [184]          ...          [128]    ...     [32]    ...      [0]
 v2*n+1     1F  1E  1D  1C  1B  1A  19  18   F   E   D   C   B   A   9   8
          [248]          ...          [196]    ...     [96]    ...     [64]

 SEW=32b, LMUL=4, VLMAX=32

 v4*n           13      12      11      10       3       2       1       0
              [152]        ...        [128]    [24]        ...          [0]
 v4*n+1         17      16      15      14       7       6       5       4
              [184]        ...        [160]    [56]        ...         [32]
 v4*n+2         1B      1A      19      18       B       A       9       8
              [116]        ...        [192]    [88]        ...         [64]
 v4*n+3         1F      1E      1D      1C       F       E       D       C
              [248]        ...        [224]   [120]        ...         [96]

 SEW=64b, LMUL=8, VLMAX=32

 v8*n                   11              10               1               0
                      [136]           [128]             [8]             [0]
 v8*n+1                 13              12               3               2
                      [152]           [144]            [24]            [16]
 v8*n+2                 15              14               5               4
                      [168]           [160]            [40]            [32]
 v8*n+3                 17              16               7               6
                      [184]           [176]            [56]            [48]
 v8*n+4                 19              18               9               8
                      [200]           [192]            [72]            [64]
 v8*n+5                 1B              1A               B               A
                      [216]           [208]            [88]            [80]
 v8*n+6                 1D              1C               D               C
                      [232]           [224]           [104]            [96]
 v8*n+7                 1F              1E               F               E
                      [248]           [240]           [120]           [112]</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vector_instruction_formats">5. Vector Instruction Formats</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The instructions in the vector extension fit under four existing major
opcodes (LOAD-FP, STORE-FP, AMO) and one new major opcode (OP-V).</p>
</div>
<div class="paragraph">
<p>Vector loads and stores are encoding within the scalar floating-point
load and store major opcodes (LOAD-FP/STORE-FP).  The vector load and
store encodings repurpose a portion of the standard scalar
floating-point load/store 12-bit immediate field to provide further
vector instruction encoding, with bit 25 holding the standard vector
mask bit (see <a href="#sec-vector-mask-encoding">Mask Encoding</a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Format for Vector Load Instructions under LOAD-FP major opcode
31 29 28 26  25  24      20 19       15 14   12 11      7 6     0
 nf  | mop | vm |  lumop   |    rs1    | width |    vd   |0000111| VL*  unit-stride
 nf  | mop | vm |   rs2    |    rs1    | width |    vd   |0000111| VLS* strided
 nf  | mop | vm |   vs2    |    rs1    | width |    vd   |0000111| VLX* indexed
  3     3     1      5           5         3         5       7

Format for Vector Store Instructions under STORE-FP major opcode
31 29 28 26  25  24      20 19       15 14   12 11      7 6     0
 nf  | mop | vm |  sumop   |    rs1    | width |   vs3   |0100111| VS*  unit-stride
 nf  | mop | vm |   rs2    |    rs1    | width |   vs3   |0100111| VSS* strided
 nf  | mop | vm |   vs2    |    rs1    | width |   vs3   |0100111| VSX* indexed
  3     3     1      5           5         3         5        7</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>Format for Vector AMO Instructions under AMO major opcode
31    27 26  25  24      20 19       15 14   12 11      7 6     0
 amoop  |wd| vm |   vs2    |    rs1    | width | vs3/vd  |0101111| VAMO*
   5      1   1      5           5         3        5        7</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>Formats for Vector Arithmetic Instructions under OP-V major opcode

31       26  25   24      20 19      15 14   12 11      7 6     0
  funct6   | vm  |   vs2    |    vs1   | 0 0 0 |    vd   |1010111| OP-V (OPIVV)
  funct6   | vm  |   vs2    |    vs1   | 0 0 1 |  vd/rd  |1010111| OP-V (OPFVV)
  funct6   | vm  |   vs2    |    vs1   | 0 1 0 |  vd/rd  |1010111| OP-V (OPMVV)
  funct6   | vm  |   vs2    |   simm5  | 0 1 1 |    vd   |1010111| OP-V (OPIVI)
  funct6   | vm  |   vs2    |    rs1   | 1 0 0 |    vd   |1010111| OP-V (OPIVX)
  funct6   | vm  |   vs2    |    rs1   | 1 0 1 |    vd   |1010111| OP-V (OPFVF)
  funct6   | vm  |   vs2    |    rs1   | 1 1 0 |  vd/rd  |1010111| OP-V (OPMVX)
     6        1        5          5        3        5        7</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>Formats for Vector Configuration Instructions under OP-V major opcode

 31 30         25 24      20 19      15 14   12 11      7 6     0
 0 |        zimm[10:0]      |    rs1   | 1 1 1 |    rd   |1010111| vsetvli
 1 |   000000    |   rs2    |    rs1   | 1 1 1 |    rd   |1010111| vsetvl
 1        6            5          5        3        5        7</pre>
</div>
</div>
<div class="paragraph">
<p>Vector instructions can have scalar or vector source operands and
produce scalar or vector results, and most vector instructions can be
performed either unconditionally or conditionally under a mask.</p>
</div>
<div class="paragraph">
<p>Vector loads and stores move bit patterns between vector register
elements and memory.  Vector arithmetic instructions operate on values
held in vector register elements.</p>
</div>
<div class="sect2">
<h3 id="_scalar_operands">5.1. Scalar operands</h3>
<div class="paragraph">
<p>Scalar operands can be immediates, or taken from the <code>x</code> registers,
the <code>f</code> registers, or element 0 of a vector register.  Scalar results
are written to an <code>x</code> or <code>f</code> register or to element 0 of a vector
register.  Any vector register can be used to hold a scalar regardless
of the current LMUL setting.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In a change from v0.6, the floating-point registers no longer
overlay the vector registers and scalars can now come from the integer
or floating-point registers.  Not overlaying the <code>f</code> registers reduces
vector register pressure, avoids interactions with the standard
calling convention, simplifies high-performance scalar floating-point
design, and provides compatibility with the Zfinx ISA option.
Overlaying <code>f</code> with <code>v</code> would provide the advantage of lowering the
number of state bits in some implementations, but complicates
high-performance designs and would prevent compatibility with the
Zfinx ISA option.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_operands">5.2. Vector Operands</h3>
<div class="paragraph">
<p>Vector operands or results may occupy one or more vector registers
depending on LMUL, but are always specified using the lowest-numbered
vector register in the group.  Using other than the lowest-numbered
vector register to specify a vector register group will result in an
illegal instruction exception.</p>
</div>
<div class="paragraph">
<p>Some vector instructions consume and produce wider-width elements and
so operate on a larger vector register group than that specified in
<code>vlmul</code>.  The largest vector register group used by an instruction can
not be greater than 8 vector registers, and if an vector instruction
would require greater than 8 vector registers in a group, an illegal
instruction exception is raised.  For example, attempting a widening
operation with LMUL=8 will raise an illegal instruction exception.</p>
</div>
</div>
<div class="sect2">
<h3 id="_vector_masking">5.3. Vector Masking</h3>
<div class="paragraph">
<p>Masking is supported on many vector instructions.  Element operations
that are masked off do not modify the destination vector register
element and never generate exceptions.</p>
</div>
<div class="paragraph">
<p>In the base vector extension, the mask value used to control execution
of a masked vector instruction is always supplied by vector register
<code>v0</code>.  Only the least-significant bit of each element of the mask
vector is used to control execution.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Future vector extensions may provide longer instruction
encodings with space for a full mask register specifier.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The destination vector register group for a masked vector instruction
can only overlap the source mask register (<code>v0</code>) when
LMUL=1. Otherwise, an illegal instruction exception is raised.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This constraint supports restart with a non-zero <code>vstart</code> value.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Other vector registers can be used to hold working mask values, and
mask vector logical operations are provided to perform predicate
calculations. <a id="sec-mask-vector-logical"></a></p>
</div>
<div class="sect3">
<h4 id="sec-vector-mask-encoding">5.3.1. Mask Encoding</h4>
<div class="paragraph">
<p>Where available, masking is encoded in a single-bit <code>vm</code> field in the
 instruction (<code>inst[25]</code>).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 6.25%;">
<col style="width: 93.75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">vm</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vector result, only where v0[i].LSB = 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unmasked</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In earlier proposals, <code>vm</code> was a two-bit field <code>vm[1:0]</code> that
provided both true and complement masking using <code>v0</code> as well as
encoding scalar operations.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Vector masking is represented in assembler code as another vector
operand, with <code>.t</code> indicating if operation occurs when <code>v0[i].LSB</code> is
<code>1</code>.  If no masking operand is specified, unmasked vector execution
(<code>vm=1</code>) is assumed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    vop.v*    v1, v2, v3, v0.t  # enabled where v0[i].LSB=1, m=0
    vop.v*    v1, v2, v3        # unmasked vector operation, m=1</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Even though the base only supports one vector mask register <code>v0</code>
and only the true form of predication, the assembly syntax writes it
out in full to be compatible with future extensions that might add a
mask register specifier and supporting both true and complement
masking. The <code>.t</code> suffix on the masking operand also helps to visually
encode the use of a mask.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_prestart_active_inactive_body_and_tail_element_definitions">5.4. Prestart, Active, Inactive, Body, and Tail Element Definitions</h3>
<div class="paragraph">
<p>The elements operated on during a vector instruction&#8217;s execution can
be divided into four disjoint subsets.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <em>prestart</em> elements are those whose element index is less than the
initial value in the <code>vstart</code> register.  The prestart elements do not
raise exceptions and do not update the destination vector register.</p>
</li>
<li>
<p>The <em>active</em> elements during a vector instruction&#8217;s execution are the
elements within the current vector length setting and where the
current mask is enabled at that element position.  The active elements
can raise exceptions and update the destination vector register group.</p>
</li>
<li>
<p>The <em>inactive</em> elements are the elements within the current vector
length setting but where the current mask is disabled at that element
position.  The inactive elements do not raise exceptions and do not
update any destination vector register.</p>
</li>
<li>
<p>The <em>tail</em> elements during a vector instruction&#8217;s execution are the
elements past the current vector length setting.  The tail elements do
not raise exceptions, and do not update any destination vector register
group.</p>
</li>
<li>
<p>In addition, another term, <em>body</em>, is used for the set of elements
that are either active or inactive, i.e., after prestart but before
the tail.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>    for element index x
    prestart    = (0 &lt;= x &lt; vstart)
    mask(x)     = unmasked || v0[x].LSB == 1
    active(x)   = (vstart &lt;= x &lt; vl) &amp;&amp; mask(x)
    inactive(x) = (vstart &lt;= x &lt; vl) &amp;&amp; !mask(x)
    body(x)     = active(x) || inactive(x)
    tail(x)     = (vl &lt;= x &lt; VLMAX)</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The inactive and tail update rules leave unchanged destination
elements that are not participating in the vector operation.  Previous
versions (v0.7) of the specification zeros the tail elements to reduce
the complexity of implementations that implement register renaming. In
version 0.8, this was changed to leave the tail elements undisturbed,
which reduces complexity for simpler implementations without register
renaming and reduces software overhead for some common sequences.  A
rationale is provided in a separate document:
<a href="https://github.com/riscv/riscv-v-spec/blob/master/v-undisturbed-versus-zeroing.adoc" class="bare">https://github.com/riscv/riscv-v-spec/blob/master/v-undisturbed-versus-zeroing.adoc</a>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_setting_instructions">6. Configuration-Setting Instructions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A set of instructions are provided to allow rapid configuration of the
values in <code>vl</code> and <code>vtype</code> to match application needs.</p>
</div>
<div class="sect2">
<h3 id="_vsetvlivsetvl_instructions">6.1. <code>vsetvli</code>/<code>vsetvl</code> instructions</h3>
<div class="listingblock">
<div class="content">
<pre> vsetvli rd, rs1, vtypei # rd = new vl, rs1 = AVL, vtypei = new vtype setting
                         # if rs1 = x0, then use current vector length
 vsetvl  rd, rs1, rs2    # rd = new vl, rs1 = AVL, rs2 = new vtype value
                         # if rs1 = x0, then use current vector length</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>vsetvli</code> instruction sets the <code>vtype</code> and <code>vl</code> CSRs based on its
arguments, and writes the new value of <code>vl</code> into <code>rd</code>.</p>
</div>
<div class="paragraph">
<p>The new <code>vtype</code> setting is encoded in the immediate fields of
<code>vsetvli</code> and in the <code>rs2</code> register for <code>vsetvl</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Formats for Vector Configuration Instructions under OP-V major opcode

 31 30         25 24      20 19      15 14   12 11      7 6     0
 0 |        zimm[10:0]      |    rs1   | 1 1 1 |    rd   |1010111| vsetvli
 1 |   000000    |   rs2    |    rs1   | 1 1 1 |    rd   |1010111| vsetvl
 1        6            5          5        3        5        7</pre>
</div>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 7. <code>vtype</code> register layout</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-right valign-top">Bits</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">XLEN-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vill</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Illegal value if set</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">XLEN-2:7</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved (write 0)</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">6:5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vediv[1:0]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used by EDIV extension</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">4:2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsew[2:0]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard element width (SEW) setting</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">1:0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlmul[1:0]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vector register group multiplier (LMUL) setting</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre> Suggested assembler names used for vtypei setting

 e8    #   8b elements
 e16   #  16b elements
 e32   #  32b elements
 e64   #  64b elements
 e128  # 128b elements

 m1   # Vlmul x1, assumed if m setting absent
 m2   # Vlmul x2
 m4   # Vlmul x4
 m8   # Vlmul x8

 d1   # EDIV 1, assumed if d setting absent
 d2   # EDIV 2
 d4   # EDIV 4
 d8   # EDIV 8

Examples:
    vsetvli t0, a0, e8          # SEW= 8, LMUL=1, EDIV=1
    vsetvli t0, a0, e8,m2       # SEW= 8, LMUL=2, EDIV=1
    vsetvli t0, a0, e32,m2,d4   # SEW=32, LMUL=2, EDIV=4</pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>vtype</code> setting is not supported by the implementation, then
the <code>vill</code> bit is set in <code>vtype</code>, the remaining bits in <code>vtype</code> are
set to zero, and the <code>vl</code> register is also set to zero.</p>
</div>
<div class="paragraph">
<p>The requested application vector length (AVL) is passed in <code>rs1</code> as an
unsigned integer.  Using <code>x0</code> as the <code>rs1</code> register specifier requests
an AVL equal to the current <code>vl</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Executing <code>vsetvl{i}</code> with <code>rs1</code>=<code>x0</code> is guaranteed to keep the
current <code>vl</code> intact if VLMAX is not reduced.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The behavior of <code>vsetvl{i}</code> does not depend on whether <code>rd</code>=<code>x0</code>.
Setting <code>rd</code>=<code>x0</code> can be useful when the application already knows what value
<code>vl</code> will assume, e.g., when changing SEW and LMUL by the same factor
while keeping <code>vl</code> constant by setting <code>rs1</code>=<code>x0</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Software can set <code>vl</code> to VLMAX by requesting an AVL of -1.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Earlier drafts used <code>rs1</code>=<code>x0</code> to request an AVL of VLMAX.
The current design supports efficient manipulation of SEW without
knowing AVL or <code>vl</code>.  Requesting a <code>vl</code> of VLMAX requires just
one additional instruction.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Earlier drafts required a trap when setting <code>vtype</code> to an
illegal value.  However, this would have added the first
data-dependent trap on a CSR write to the ISA.  The current scheme
also supports light-weight runtime interrogation of the supported
vector unit configurations by checking if <code>vill</code> is clear for a given
setting.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_constraints_on_setting_vl">6.2. Constraints on Setting <code>vl</code></h3>
<div class="paragraph">
<p>The <code>vsetvl{i}</code> instructions first set VLMAX according to the <code>vtype</code>
argument, then set <code>vl</code> obeying the following constraints:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>vl = AVL</code> if <code>AVL &#8804; VLMAX</code></p>
</li>
<li>
<p><code>ceil(AVL / 2) &#8804; vl &#8804; VLMAX</code> if <code>AVL &lt; (2 * VLMAX)</code></p>
</li>
<li>
<p><code>vl = VLMAX</code> if <code>AVL &#8805; (2 * VLMAX)</code></p>
</li>
<li>
<p>Deterministic on any given implementation for same input AVL and VLMAX values</p>
</li>
<li>
<p>These specific properties follow from the prior rules:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>vl = 0</code> if  <code>AVL = 0</code></p>
</li>
<li>
<p><code>vl &gt; 0</code> if <code>AVL &gt; 0</code></p>
</li>
<li>
<p><code>vl &#8804; VLMAX</code></p>
</li>
<li>
<p><code>vl &#8804; AVL</code></p>
</li>
<li>
<p>a value read from <code>vl</code> when used as the AVL argument to <code>vsetvl{i}</code> results in the same
value in <code>vl</code>, provided the resultant VLMAX equals the value of VLMAX at the time that <code>vl</code> was read</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>vl</code> setting rules are designed to be sufficiently strict to
preserve <code>vl</code> behavior across register spills and context swaps for
<code>AVL &#8804; VLMAX</code>, yet flexible enough to enable implementations to improve
vector lane utilization for <code>AVL &gt; VLMAX</code>.</p>
</div>
<div class="paragraph">
<p>For example, this permits an implementation to set <code>vl = ceil(AVL / 2)</code>
for <code>VLMAX &lt; AVL &lt; 2*VLMAX</code> in order to evenly distribute work over the
last two iterations of a stripmine loop.
Requirement 2 ensures that the first stripmine iteration of reduction
loops uses the largest vector length of all iterations, even in the case
of <code>AVL &lt; 2*VLMAX</code>.
This allows software to avoid needing to explicitly calculate a running
maximum of vector lengths observed during a stripmined loop.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vsetvl_instruction">6.3. <code>vsetvl</code> Instruction</h3>
<div class="paragraph">
<p>The <code>vsetvl</code> variant operates similarly to <code>vsetvli</code> except that it
takes a <code>vtype</code> value from <code>rs2</code> and can be used for context restore,
and when the <code>vtypei</code> field is too small to hold the desired setting.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Several active complex types can be held in different <code>x</code>
registers and swapped in as needed using <code>vsetvl</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_examples">6.4. Examples</h3>
<div class="paragraph">
<p>The SEW and LMUL settings can be changed dynamically to provide high
throughput on mixed-width operations in a single loop.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Example: Load 16-bit values, widen multiply to 32b, shift 32b result
# right by 3, store 32b values.

# Loop using only widest elements:

loop:
    vsetvli a3, a0, e32,m8  # Use only 32-bit elements
    vlh.v v8, (a1)          # Sign-extend 16b load values to 32b elements
      sll t1, a3, 1         # Multiply length by two bytes/element
      add a1, a1, t1        # Bump pointer
    vmul.vx  v8, v8, x10    # 32b multiply result
    vsrl.vi  v8, v8, 3      # Shift elements
    vsw.v v8, (a2)          # Store vector of 32b results
      sll t1, a3, 2         # Multiply length by four bytes/element
      add a2, a2, t1        # Bump pointer
      sub a0, a0, a3        # Decrement count
      bnez a0, loop         # Any more?

# Alternative loop that switches element widths.

loop:
    vsetvli a3, a0, e16,m4  # vtype = 16-bit integer vectors
    vlh.v v4, (a1)          # Get 16b vector
      slli t1, a3, 1        # Multiply length by two bytes/element
      add a1, a1, t1        # Bump pointer
    vwmul.vx v8, v4, x10    # 32b in &lt;v8--v15&gt;

    vsetvli x0, a0, e32,m8  # Operate on 32b values
    vsrl.vi v8, v8, 3
    vsw.v v8, (a2)          # Store vector of 32b
      slli t1, a3, 2        # Multiply length by four bytes/element
      add a2, a2, t1        # Bump pointer
      sub a0, a0, a3        # Decrement count
      bnez a0, loop         # Any more?</pre>
</div>
</div>
<div class="paragraph">
<p>The second loop is more complex but will have greater performance on
machines where 16b widening multiplies are faster than 32b integer
multiplies, and where 16b vector load can run faster due to the
narrower writes to the vector regfile.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vector_loads_and_stores">7. Vector Loads and Stores</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vector loads and stores move values between vector registers and
memory.  Vector loads and stores are masked and do not raise
exceptions on inactive elements.  Masked vector loads do not update
inactive elements in the destination vector register group.  Masked
vector stores only update active memory elements.</p>
</div>
<div class="sect2">
<h3 id="_vector_loadstore_instruction_encoding">7.1. Vector Load/Store Instruction Encoding</h3>
<div class="paragraph">
<p>Vector loads and stores are encoded within the scalar floating-point
load and store major opcodes (LOAD-FP/STORE-FP).  The vector load and
store encodings repurpose a portion of the standard scalar
floating-point load/store 12-bit immediate field to provide further
vector instruction encoding, with bit 25 holding the standard vector
mask bit (see <a href="#sec-vector-mask-encoding">Mask Encoding</a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Format for Vector Load Instructions under LOAD-FP major opcode
31 29 28 26  25  24      20 19       15 14   12 11      7 6     0
 nf  | mop | vm |  lumop   |    rs1    | width |    vd   |0000111| VL*  unit-stride
 nf  | mop | vm |   rs2    |    rs1    | width |    vd   |0000111| VLS* strided
 nf  | mop | vm |   vs2    |    rs1    | width |    vd   |0000111| VLX* indexed
  3     3     1      5           5         3         5       7

Format for Vector Store Instructions under STORE-FP major opcode
31 29 28 26  25  24      20 19       15 14   12 11      7 6     0
 nf  | mop | vm |  sumop   |    rs1    | width |   vs3   |0100111| VS*  unit-stride
 nf  | mop | vm |   rs2    |    rs1    | width |   vs3   |0100111| VSS* strided
 nf  | mop | vm |   vs2    |    rs1    | width |   vs3   |0100111| VSX* indexed
  3     3     1      5           5         3         5        7</pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs1[4:0]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">specifies x register holding base address</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rs2[4:0]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">specifies x register holding stride</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vs2[4:0]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">specifies v register holding address offsets</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vs3[4:0]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">specifies v register holding store data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vd[4:0]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">specifies v register destination of load</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">specifies vector mask</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">width[2:0]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">specifies size of memory elements, and distinguishes from FP scalar</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mop[2:0]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">specifies memory addressing mode</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nf[2:0]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">specifies the number of fields in each segment, for segment load/stores</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lumop[4:0]/sumop[4:0]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">are additional fields encoding variants of unit-stride instructions</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_vector_loadstore_addressing_modes">7.2. Vector Load/Store Addressing Modes</h3>
<div class="paragraph">
<p>The base vector extension supports unit-stride, strided, and
indexed (scatter/gather) addressing modes.  Vector load/store base
registers and strides are taken from the GPR <code>x</code> registers.</p>
</div>
<div class="paragraph">
<p>The base effective address for all vector accesses is given by the
contents of the <code>x</code> register named in <code>rs1</code>.</p>
</div>
<div class="paragraph">
<p>Vector unit-stride operations access elements stored contiguously in
memory starting from the base effective address.</p>
</div>
<div class="paragraph">
<p>Vector strided operations access the first memory element at the base
effective address, and then access subsequent elements at address
increments given by the byte offset contained in the <code>x</code> register
specified by <code>rs2</code>.</p>
</div>
<div class="paragraph">
<p>Vector indexed operations add the contents of each element of the
vector offset operand specified by <code>vs2</code> to the base effective address
to give the effective address of each element.  The vector offset
operand is treated as a vector of byte offsets.  If the vector offset
elements are narrower than XLEN, they are sign-extended to XLEN before
adding to the base effective address.  If the vector offset elements
are wider than XLEN, the least-significant XLEN bits are used in the
address calculation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Current PoR for vector indexed instructions requires that vector
byte offset (vs2) and vector read/write data (vs3/vd) are of same
width.  One question is whether and how to allow for two sizes of
vector operand in a vector indexed instruction?  For example, for
scatter/gather of byte values in a 64-bit address space without
requiring bytes use 64b of space in a vector register.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The vector addressing modes are encoded using the 3-bit <code>mop[2:0]</code>
field.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. encoding for loads</caption>
<colgroup>
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 43.75%;">
<col style="width: 37.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3">mop [2:0]</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Opcodes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">zero-extended unit-stride</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VLxU,VLE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reserved</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">zero-extended strided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VLSxU, VLSE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">zero-extended indexed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VLXxU, VLXE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sign-extended unit-stride</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VLx  (x!=E)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reserved</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sign-extended strided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VLSx (x!=E)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sign-extended indexed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VLXx (x!=E)</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. encoding for stores</caption>
<colgroup>
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 43.75%;">
<col style="width: 37.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3">mop [2:0]</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Opcodes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unit-stride</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VSx</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reserved</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">strided</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VSSx</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">indexed-ordered</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VSXx</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reserved</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reserved</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reserved</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">indexed-unordered</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VSUXx</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The vector indexed memory operations have two forms, ordered and
unordered.  The indexed-unordered stores do not preserve element
ordering on stores.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The indexed-unordered variant is provided as a potential
implementation optimization.  Implementations are free to ignore the
optimization and implement indexed-unordered identically to
indexed-ordered.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Additional unit-stride vector addressing modes are encoded using the
5-bit <code>lumop</code> and <code>sumop</code> fields in the unit-stride load and store
instruction encodings respectively.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. lumop</caption>
<colgroup>
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 68.75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="5">lumop[4:0]</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unit-stride</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reserved, x!=0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unit-stride fault-only-first</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reserved, x!=0</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. sumop</caption>
<colgroup>
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 68.75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="5">sumop[4:0]</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unit-stride</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reserved, x!=0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reserved</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>nf[2:0]</code> field encodes the number of fields in each segment.  For
regular vector loads and stores, <code>nf</code>=0, indicating that a single
value is moved between a vector register group and memory at each
element position.  Larger values in the <code>nf</code> field are used to access
multiple contiguous fields within a segment as described below in
Section <a href="#sec-aos">Vector Load/Store Segment Instructions (<code>Zvlsseg</code>)</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>nf</code> field for segment load/stores has replaced the use of
the same bits for an address offset field.  The offset can be replaced
with a single scalar integer calculation, while segment load/stores
add more powerful primitives to move items to and from memory.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_loadstore_width_encoding">7.3. Vector Load/Store Width Encoding</h3>
<div class="paragraph">
<p>The vector loads and stores are encoded using the width values that
are not claimed by the standard scalar floating-point loads and
stores.  Three of the width types encode vector loads and stores that
move fixed-size memory elements of 8 bits, 16 bits, or 32 bits, while
the fourth encoding moves SEW-bit memory elements.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 18.75%;">
<col style="width: 18.75%;">
<col style="width: 18.75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top" colspan="3">Width [2:0]</th>
<th class="tableblock halign-left valign-top">Mem bits</th>
<th class="tableblock halign-left valign-top">Reg bits</th>
<th class="tableblock halign-left valign-top">Opcode</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard scalar FP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FLH/FSH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard scalar FP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FLW/FSW</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard scalar FP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FLD/FSD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard scalar FP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FLQ/FSQ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vector byte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vl*8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vl*SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VxB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vector halfword</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vl*16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vl*SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VxH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vector word</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vl*32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vl*SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VxW</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vector element</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vl*SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vl*SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VxE</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Mem bits is the size of element accessed in memory</p>
</div>
<div class="paragraph">
<p>Reg bits is the size of element accessed in register</p>
</div>
<div class="paragraph">
<p>Fixed-sized vector loads can optionally sign or zero-extend their
memory element into the destination register element if the register
element is wider than the memory element.  A fixed-size vector load
raises an illegal instruction exception if the destination register
element is narrower than the memory element.  The variable-sized load
is encoded as if a zero-extended load, with what would be the
sign-extended encoding of a variable-sized load currently reserved.</p>
</div>
<div class="paragraph">
<p>Fixed-size vector stores take their operand from the least-significant
bits of the register element if the register element if wider than the
memory element.  Fixed-sized vector stores raise an illegal
instruction exception if the memory element is wider than the register
element.</p>
</div>
</div>
<div class="sect2">
<h3 id="_vector_unit_stride_instructions">7.4. Vector Unit-Stride Instructions</h3>
<div class="listingblock">
<div class="content">
<pre>    # Vector unit-stride loads and stores

    # vd destination, rs1 base address, vm is mask encoding (v0.t or &lt;missing&gt;)
    vlb.v  vd, (rs1), vm # 8b signed
    vlh.v  vd, (rs1), vm # 16b signed
    vlw.v  vd, (rs1), vm # 32b signed

    vlbu.v vd, (rs1), vm # 8b unsigned
    vlhu.v vd, (rs1), vm # 16b unsigned
    vlwu.v vd, (rs1), vm # 32b unsigned

    vle.v  vd, (rs1), vm # SEW

    # vs3 store data, rs1 base address, vm is mask encoding (v0.t or &lt;missing&gt;)
    vsb.v  vs3, (rs1), vm  # 8b store
    vsh.v  vs3, (rs1), vm  # 16b store
    vsw.v  vs3, (rs1), vm  # 32b store
    vse.v  vs3, (rs1), vm  # SEW store</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_strided_instructions">7.5. Vector Strided Instructions</h3>
<div class="listingblock">
<div class="content">
<pre>    # Vector strided loads and stores

    # vd destination, rs1 base address, rs2 byte stride
    vlsb.v  vd, (rs1), rs2, vm # 8b
    vlsh.v  vd, (rs1), rs2, vm # 16b
    vlsw.v  vd, (rs1), rs2, vm # 32b

    vlsbu.v vd, (rs1), rs2, vm # unsigned 8b
    vlshu.v vd, (rs1), rs2, vm # unsigned 16b
    vlswu.v vd, (rs1), rs2, vm # unsigned 32b

    vlse.v  vd, (rs1), rs2, vm  # SEW

    # vs3 store data, rs1 base address, rs2 byte stride
    vssb.v vs3, (rs1), rs2, vm  # 8b
    vssh.v vs3, (rs1), rs2, vm  # 16b
    vssw.v vs3, (rs1), rs2, vm  # 32b
    vsse.v vs3, (rs1), rs2, vm  # SEW</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Negative and zero strides are supported.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_indexed_instructions">7.6. Vector Indexed Instructions</h3>
<div class="listingblock">
<div class="content">
<pre>    # Vector indexed loads and stores

    # vd destination, rs1 base address, vs2 indices
    vlxb.v  vd, (rs1), vs2, vm  # 8b
    vlxh.v  vd, (rs1), vs2, vm  # 16b
    vlxw.v  vd, (rs1), vs2, vm  # 32b

    vlxbu.v vd, (rs1), vs2, vm  # 8b unsigned
    vlxhu.v vd, (rs1), vs2, vm  # 16b unsigned
    vlxwu.v vd, (rs1), vs2, vm  # 32b unsigned

    vlxe.v  vd, (rs1), vs2, vm  # SEW

    # Vector ordered-indexed store instructions
    # vs3 store data, rs1 base address, vs2 indices
    vsxb.v vs3, (rs1), vs2, vm  # 8b
    vsxh.v vs3, (rs1), vs2, vm  # 16b
    vsxw.v vs3, (rs1), vs2, vm  # 32b
    vsxe.v vs3, (rs1), vs2, vm  # SEW

    # Vector unordered-indexed store instructions
    vsuxb.v vs3, (rs1), vs2, vm  # 8b
    vsuxh.v vs3, (rs1), vs2, vm  # 16b
    vsuxw.v vs3, (rs1), vs2, vm  # 32b
    vsuxe.v vs3, (rs1), vs2, vm  # SEW</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_unit_stride_fault_only_first_loads">7.7. Unit-stride Fault-Only-First Loads</h3>
<div class="paragraph">
<p>The unit-stride fault-only-first load instructions are used to vectorize
loops with data-dependent exit conditions (while loops).  These
instructions execute as a regular load except that they will only take
a trap on element 0.  If an element &gt; 0 raises an exception, that
element and all following elements in the destination vector
register are not modified, and the vector length <code>vl</code> is reduced to the
number of elements processed without a trap.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    vlbff.v  vd, (rs1), vm # 8b
    vlhff.v  vd, (rs1), vm # 16b
    vlwff.v  vd, (rs1), vm # 32b

    vlbuff.v vd, (rs1), vm # unsigned 8b
    vlhuff.v vd, (rs1), vm # unsigned 16b
    vlwuff.v vd, (rs1), vm # unsigned 32b

    vleff.v  vd, (rs1), vm # SEW</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>strlen example using unit-stride fault-only-first instruction

# size_t strlen(const char *str)
# a0 holds *str

strlen:
    mv a3, a0             # Save start
    li t0, -1             # Infinite AVL
loop:
    vsetvli a1, t0, e8  # Vector of bytes of maximum length
    vlbff.v v1, (a3)      # Load bytes
    csrr a1, vl           # Get bytes read
    vmseq.vi v0, v1, 0    # Set v0[i] where v1[i] = 0
    vfirst.m a2, v0       # Find first set bit
    add a3, a3, a1        # Bump pointer
    bltz a2, loop         # Not found?

    add a0, a0, a1        # Sum start + bump
    add a3, a3, a2        # Add index
    sub a0, a3, a0        # Subtract start address+bump

    ret</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Strided and scatter/gather fault-only-first instructions are not
provided as they represent a large security hole, allowing software to
check multiple random pages for accessibility without experiencing a
trap. The unit-stride versions only allow probing a region immediately
contiguous to a known region, and so do not appreciably impact
security.  It is possible that security mitigations can be
implemented to allow fault-only-first variants of non-contiguous accesses
in future vector extensions.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec-aos">7.8. Vector Load/Store Segment Instructions (<code>Zvlsseg</code>)</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This is being written as an extension but will likely be
mandated in most profiles, as the operation is too generally useful to
omit.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The vector load/store segment instructions move multiple contiguous
fields in memory to and from consecutively numbered vector registers.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
These operations support operations on "array-of-structures"
datatypes by unpacking each field in a structure into separate vector
registers.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As for regular vector loads and stores, the width encoding gives the
size of the memory elements, which are homogeneous in size, while SEW
encodes the size of the register elements.</p>
</div>
<div class="paragraph">
<p>The three-bit <code>nf</code> field in the vector instruction encoding is an
unsigned integer that contains one less than the number of fields per
segment, <em>NFIELDS</em>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 81.25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3">nf[2:0]</th>
<th class="tableblock halign-left valign-top">NFIELDS</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The LMUL setting must be such that LMUL * NFIELDS &#8656; 8, otherwise an
illegal instruction exception is raised.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The product LMUL * NFIELDS represents the number of underlying
vector registers that will be touched by a segmented load or store
instruction.  This constraint makes this total no larger than 1/4 of
the architectural register file, and the same as for regular
operations with LMUL=8. This constraint could be weakened in a future
draft.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each field will be held in successively numbered vector register
groups.  When LMUL&gt;1, each field will occupy a vector register group
held in multiple successively numbered vector registers, and the
vector register group for each field must follow the usual vector
register alignment constraints (e.g., when LMUL=2 and NFIELDS=4, each
field&#8217;s vector register group must start at an even vector register,
but does not have to start at a multiple of 8 vector register number).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
An earlier version imposed a vector register number constraint,
but this decreased ability to make use of all registers when NFIELDS
was not a power of 2.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the vector register numbers accessed by the segment load or store
would increment past 31, then an illegal instruction exception is
raised.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This constraint is to help provide forward-compatibility with a
future longer instruction encoding that has more addressable vector
registers.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>vl</code> register gives the number of structures to move, which is
equal to the number of elements transferred to each vector register
group.  Masking is also applied at the level of whole structures.</p>
</div>
<div class="paragraph">
<p>If a trap is taken, <code>vstart</code> is in units of structures.</p>
</div>
<div class="sect3">
<h4 id="_vector_unit_stride_segment_loads_and_stores">7.8.1. Vector Unit-Stride Segment Loads and Stores</h4>
<div class="paragraph">
<p>The vector unit-stride load and store segment instructions move packed
contiguous segments ("array-of-structures") into multiple destination
vector register groups.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For segments with heterogeneous-sized fields, software can later
unpack fields using additional instructions after the segment load
brings the values into the separate vector registers.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The assembler prefixes <code>vlseg</code>/<code>vsseg</code> are used for unit-stride
segment loads and stores respectively.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    # Format
    vlseg&lt;nf&gt;{b,h,w}.v vd, (rs1),  vm    # Unit-stride signed segment load template
    vlseg&lt;nf&gt;e.v vd, (rs1), vm           # Unit-stride segment load template
    vlseg&lt;nf&gt;{b,h,w}u.v vd, (rs1), vm    # Unit-stride unsigned segment load template
    vsseg&lt;nf&gt;{b,h,w,e}.v vs3, (rs1), vm  # Unit-stride segment store template

    # Examples
    vlseg2b.v vd, (rs1), vm   # Load vector of signed 2*1-byte segments into vd, vd+1
    vlseg3bu.v vd, (rs1), vm  # Load vector of unsigned 3*1-byte segments into vd, vd+1, vd+2
    vlseg7w.v vd, (rs1), vm   # Load vector of 7*4-byte segments into vd, vd+1, ... vd+6
    vlseg8e.v vd, (rs1), vm   # Load vector of 8*SEW-byte segments into vd, vd+1, .. vd+7

    vsseg3b.v vs3, (rs1), vm  # Store packed vector of 3*1-byte segments from vs3,vs3+1,vs3+2 to memory</pre>
</div>
</div>
<div class="paragraph">
<p>For loads, the <code>vd</code> register will hold the first field loaded from the
segment.  For stores, the <code>vs3</code> register is read to provide the first
field to be stored in each segment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    # Example 1
    # Memory structure holds packed RGB pixels (24-bit data structure, 8bpp)
    vlseg3bu.v v8, (a0), vm
    # v8 holds the red pixels
    # v9 holds the green pixels
    # v10 holds the blue pixels

    # Example 2
    # Memory structure holds complex values, 32b for real and 32b for imaginary
    vlseg2w.v v8, (a0), vm
    # v8 holds real
    # v9 holds imaginary</pre>
</div>
</div>
<div class="paragraph">
<p>There are also fault-only-first versions of the unit-stride instructions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    # Template for vector fault-only-first unit-stride segment loads and stores.
    vlseg&lt;nf&gt;{b,h,w}ff.v vd, (rs1),  vm    # Unit-stride signed fault-only-first segment loads
    vlseg&lt;nf&gt;eff.v vd, (rs1),  vm          # Unit-stride fault-only-first segment loads
    vlseg&lt;nf&gt;{b,h,w}uff.v vd, (rs1),   vm  # Unit-stride unsigned fault-only-first segment loads</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vector_strided_segment_loads_and_stores">7.8.2. Vector Strided Segment Loads and Stores</h4>
<div class="paragraph">
<p>Vector strided segment loads and stores move contiguous segments where
each segment is separated by the byte stride offset given in the <code>rs2</code>
GPR argument.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Negative and zero strides are supported.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>    # Format
    vlsseg&lt;nf&gt;{b,h,w}.v vd, (rs1), rs2, vm    # Strided signed segment loads
    vlsseg&lt;nf&gt;e.v vd, (rs1), rs2, vm          # Strided segment loads
    vlsseg&lt;nf&gt;{b,h,w}u.v vd, (rs1), rs2, vm   # Strided unsigned segment loads
    vssseg&lt;nf&gt;{b,h,w,e}.v vs3, (rs1), rs2, vm # Strided segment stores

    # Examples
    vlsseg3b.v v4, (x5), x6   # Load bytes at addresses x5+i*x6   into v4[i],
                              #  and bytes at addresses x5+i*x6+1 into v5[i],
                              #  and bytes at addresses x5+i*x6+2 into v6[i].

    # Examples
    vssseg2w.v v2, (x5), x6   # Store words from v2[i] to address x5+i*x6
                              #   and words from v3[i] to address x5+i*x6+4</pre>
</div>
</div>
<div class="paragraph">
<p>For strided segment stores where the byte stride is such that segments
could overlap in memory, the segments must appear to be written in
element order.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vector_indexed_segment_loads_and_stores">7.8.3. Vector Indexed Segment Loads and Stores</h4>
<div class="paragraph">
<p>Vector indexed segment loads and stores move contiguous segments where
each segment is located at an address given by adding the scalar base
address in the <code>rs1</code> field to byte offsets in vector register <code>vs2</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    # Format
    vlxseg&lt;nf&gt;{b,h,w}.v vd, (rs1), vs2, vm    # Indexed signed segment loads
    vlxseg&lt;nf&gt;e.v vd, (rs1), vs2, vm          # Indexed segment loads
    vlxseg&lt;nf&gt;{b,h,w}u.v vd, (rs1), vs2, vm   # Indexed unsigned segment loads
    vsxseg&lt;nf&gt;{b,h,w,e}.v vs3, (rs1), vs2, vm # Indexed segment stores

    # Examples
    vlxseg3bu.v v4, (x5), v3   # Load bytes at addresses x5+v3[i]   into v4[i],
                              #  and bytes at addresses x5+v3[i]+1 into v5[i],
                              #  and bytes at addresses x5+v3[i]+2 into v6[i].

    # Examples
    vsxseg2w.v v2, (x5), v5   # Store words from v2[i] to address x5+v5[i]
                              #   and words from v3[i] to address x5+v5[i]+4</pre>
</div>
</div>
<div class="paragraph">
<p>For vector indexed segment loads, the destination vector register groups
cannot overlap the source vector register group (specified by <code>vs2</code>), nor can
they overlap the mask register if masked, else an illegal instruction
exception is raised.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This constraint supports restart of indexed segment loads
that raise exceptions partway through loading a structure.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Only ordered indexed segment stores are provided. The segments must
appear to be written in element order.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vector_amo_operations_zvamo">8. Vector AMO Operations (<code>Zvamo</code>)</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Profiles will dictate whether vector AMO operations are
supported.  The expectation is that the Unix profile will require
vector AMO operations.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If vector AMO instructions are supported, then the scalar Zaamo
instructions (atomic operations from the standard A extension) must be
present.</p>
</div>
<div class="paragraph">
<p>Vector AMO operations are encoded using the unused width encodings
under the standard AMO major opcode.  Each active element performs an
atomic read-modify-write of a single memory location.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Format for Vector AMO Instructions under AMO major opcode
31    27 26  25  24      20 19       15 14   12 11      7 6     0
 amoop  |wd| vm |   vs2    |    rs1    | width | vs3/vd  |0101111| VAMO*
   5      1   1      5           5         3        5        7</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>vs2[4:0] specifies v register holding address
vs3/vd[4:0] specifies v register holding source operand and destination

vm specifies vector mask
width[2:0] specifies size of memory elements, and distinguishes from scalar AMO
amoop[4:0] specifies the AMO operation
wd specifies whether the original memory value is written to vd (1=yes, 0=no)</pre>
</div>
</div>
<div class="paragraph">
<p>AMOs have the same addressing mode as indexed operations except with
no immediate offset.  A vector of byte offsets in register <code>vs2</code> are
added to the scalar base register in <code>rs1</code> to give the addresses of
the AMO operations.</p>
</div>
<div class="paragraph">
<p>The <code>vs2</code> vector register supplies the byte offset of each element,
while the <code>vs3</code> vector register supplies the source data for the
atomic memory operation.</p>
</div>
<div class="paragraph">
<p>If the <code>wd</code> bit is set, the <code>vd</code> register is written with the initial
value of the memory element.  If the <code>wd</code> bit is clear, the <code>vd</code>
register is not written.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When <code>wd</code> is clear, the memory system does not need to return
the original memory value, and the original values in <code>vd</code> will be
preserved.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The AMOs were defined to overwrite source data partly to reduce
total memory pipeline read port count for implementations with
register renaming.  Also, to support the same addressing mode as vector
indexed operations, and because vector AMOs are less likely to need
results given that the primary use is parallel in-memory reductions.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Vector AMOs operate as if <code>aq</code> and <code>rl</code> bits were zero on each element
with regard to ordering relative to other instructions in the same
hart.</p>
</div>
<div class="paragraph">
<p>Vector AMOs provide no ordering guarantee between element operations
in the same vector AMO instruction.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. Vector AMO width encoding</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 18.75%;">
<col style="width: 18.75%;">
<col style="width: 18.75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top" colspan="3">Width [2:0]</th>
<th class="tableblock halign-left valign-top">Mem bits</th>
<th class="tableblock halign-left valign-top">Reg bits</th>
<th class="tableblock halign-left valign-top">Opcode</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard scalar AMO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AMO*.W</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard scalar AMO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AMO*.D</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard scalar AMO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AMO*.Q</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vector AMO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vl*SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VAMO*W.V</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vector AMO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vl*SEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VAMO*E.V</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Mem bits is the size of element accessed in memory</p>
</div>
<div class="paragraph">
<p>Reg bits is the size of element accessed in register</p>
</div>
<div class="paragraph">
<p>There are two widths of vector AMO, one for 32-bit words and one for
SEW-bit words.  For the 32-bit vector AMO operations, SEW must be at
least 32 bits, otherwise an illegal instruction exception is raised.
If SEW &gt; 32 bits, the value returned from memory is sign-extended
to fill SEW.</p>
</div>
<div class="paragraph">
<p>If SEW is less than XLEN, then addresses in the vector <code>vs2</code> are
sign-extended to XLEN.  If SEW is greater than XLEN, an illegal
instruction exception is raised.</p>
</div>
<div class="paragraph">
<p>Vector AMO instructions are only supported for the memory element
widths supported by AMOs in the implementation&#8217;s scalar architecture.
Other widths raise an illegal instruction exception.</p>
</div>
<div class="paragraph">
<p>The vector <code>amoop[4:0]</code> field uses the same encoding as the scalar
5-bit AMO instruction field, except that LR and SC are not supported.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. amoop</caption>
<colgroup>
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 68.75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="5">amoop</th>
<th class="tableblock halign-left valign-top">opcode</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vamoswap</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vamoadd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vamoxor</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vamoand</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vamoor</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vamomin</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vamomax</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vamominu</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vamomaxu</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The assembly syntax uses <code>x0</code> in the destination register position to
indicate the return value is not required (<code>wd=0</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre># 32-bit vector AMOs
vamoswapw.v vd, (rs1), v2, vd,  v0.t # Write original value to register, wd=1
vamoswapw.v x0, (rs1), v2, vs3, v0.t # Do not write original value to register, wd=0

vamoaddw.v vd, (rs1), v2, vd,  v0.t # Write original value to register, wd=1
vamoaddw.v x0, (rs1), v2, vs3, v0.t # Do not write original value to register, wd=0

vamoxorw.v vd, (rs1), v2, vd,  v0.t # Write original value to register, wd=1
vamoxorw.v x0, (rs1), v2, vs3, v0.t # Do not write original value to register, wd=0

vamoandw.v vd, (rs1), v2, vd,  v0.t # Write original value to register, wd=1
vamoandw.v x0, (rs1), v2, vs3, v0.t # Do not write original value to register, wd=0

vamoorw.v vd, (rs1), v2, vd,  v0.t # Write original value to register, wd=1
vamoorw.v x0, (rs1), v2, vs3, v0.t # Do not write original value to register, wd=0

vamominw.v vd, (rs1), v2, vd,  v0.t # Write original value to register, wd=1
vamominw.v x0, (rs1), v2, vs3, v0.t # Do not write original value to register, wd=0

vamomaxw.v vd, (rs1), v2, vd,  v0.t # Write original value to register, wd=1
vamomaxw.v x0, (rs1), v2, vs3, v0.t # Do not write original value to register, wd=0

vamominuw.v vd, (rs1), v2, vd,  v0.t # Write original value to register, wd=1
vamominuw.v x0, (rs1), v2, vs3, v0.t # Do not write original value to register, wd=0

vamomaxuw.v vd, (rs1), v2, vd,  v0.t # Write original value to register, wd=1
vamomaxuw.v x0, (rs1), v2, vs3, v0.t # Do not write original value to register, wd=0

# SEW-bit vector AMOs
vamoswape.v vd, (rs1), v2, vd,  v0.t # Write original value to register, wd=1
vamoswape.v x0, (rs1), v2, vs3, v0.t # Do not write original value to register, wd=0

vamoadde.v vd, (rs1), v2, vd,  v0.t # Write original value to register, wd=1
vamoadde.v x0, (rs1), v2, vs3, v0.t # Do not write original value to register, wd=0

vamoxore.v vd, (rs1), v2, vd,  v0.t # Write original value to register, wd=1
vamoxore.v x0, (rs1), v2, vs3, v0.t # Do not write original value to register, wd=0

vamoande.v vd, (rs1), v2, vd,  v0.t # Write original value to register, wd=1
vamoande.v x0, (rs1), v2, vs3, v0.t # Do not write original value to register, wd=0

vamoore.v vd, (rs1), v2, vd,  v0.t # Write original value to register, wd=1
vamoore.v x0, (rs1), v2, vs3, v0.t # Do not write original value to register, wd=0

vamomine.v vd, (rs1), v2, vd,  v0.t # Write original value to register, wd=1
vamomine.v x0, (rs1), v2, vs3, v0.t # Do not write original value to register, wd=0

vamomaxe.v vd, (rs1), v2, vd,  v0.t # Write original value to register, wd=1
vamomaxe.v x0, (rs1), v2, vs3, v0.t # Do not write original value to register, wd=0

vamominue.v vd, (rs1), v2, vd,  v0.t # Write original value to register, wd=1
vamominue.v x0, (rs1), v2, vs3, v0.t # Do not write original value to register, wd=0

vamomaxue.v vd, (rs1), v2, vd,  v0.t # Write original value to register, wd=1
vamomaxue.v x0, (rs1), v2, vs3, v0.t # Do not write original value to register, wd=0</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vector_memory_alignment_constraints">9. Vector Memory Alignment Constraints</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If the elements accessed by a vector memory instruction are not
naturally aligned to the memory element size, either an address
misaligned exception is raised on that element or the element is
transferred successfully.</p>
</div>
<div class="paragraph">
<p>Vector memory accesses follow the same rules for atomicity as scalar
memory accesses.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vector_memory_consistency_model">10. Vector Memory Consistency Model</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vector memory instructions appear to execute in program order on the
local hart.  Vector memory instructions follow RVWMO at the
instruction level, and element operations are ordered within the
instruction as if performed by an element-ordered sequence of
syntactically independent scalar instructions.  Vector indexed-ordered
stores write elements to memory in element order.  Vector
indexed-unordered stores do not preserve element order for writes
within a single vector store instruction.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Need to flesh out details.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vector_arithmetic_instruction_formats">11. Vector Arithmetic Instruction Formats</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The vector arithmetic instructions use a new major opcode (OP-V =
1010111<sub>2</sub>) which neighbors OP-FP.  The three-bit <code>funct3</code> field is
used to define sub-categories of vector instructions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Formats for Vector Arithmetic Instructions under OP-V major opcode

31       26  25   24      20 19      15 14   12 11      7 6     0
  funct6   | vm  |   vs2    |    vs1   | 0 0 0 |    vd   |1010111| OP-V (OPIVV)
  funct6   | vm  |   vs2    |    vs1   | 0 0 1 |  vd/rd  |1010111| OP-V (OPFVV)
  funct6   | vm  |   vs2    |    vs1   | 0 1 0 |  vd/rd  |1010111| OP-V (OPMVV)
  funct6   | vm  |   vs2    |   simm5  | 0 1 1 |    vd   |1010111| OP-V (OPIVI)
  funct6   | vm  |   vs2    |    rs1   | 1 0 0 |    vd   |1010111| OP-V (OPIVX)
  funct6   | vm  |   vs2    |    rs1   | 1 0 1 |    vd   |1010111| OP-V (OPFVF)
  funct6   | vm  |   vs2    |    rs1   | 1 1 0 |  vd/rd  |1010111| OP-V (OPMVX)
     6        1        5          5        3        5        7</pre>
</div>
</div>
<div class="sect2">
<h3 id="_vector_arithmetic_instruction_encoding">11.1. Vector Arithmetic Instruction encoding</h3>
<div class="paragraph">
<p>The <code>funct3</code> field encodes the operand type and source locations.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. funct3</caption>
<colgroup>
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 18.75%;">
<col style="width: 31.25%;">
<col style="width: 31.25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3">funct3[2:0]</th>
<th class="tableblock halign-left valign-top">Operands</th>
<th class="tableblock halign-left valign-top">Source of scalar(s)</th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPIVV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vector-vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPFVV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vector-vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPMVV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vector-vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPIVI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vector-immediate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">imm[4:0]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPIVX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vector-scalar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPR x register rs1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPFVF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vector-scalar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FP f register rs1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPMVX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vector-scalar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPR x register rs1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPCFG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">scalars-imms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPR x register rs1 &amp; rs2/imm</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Integer operations are performed using unsigned or two&#8217;s-complement
signed integer arithmetic depending on the opcode.</p>
</div>
<div class="paragraph">
<p>All standard vector floating-point arithmetic operations follow the
IEEE-754/2008 standard.  All vector floating-point operations use the
dynamic rounding mode in the <code>frm</code> register.</p>
</div>
<div class="paragraph">
<p>Vector-vector operations take two vectors of operands from vector
register groups specified by <code>vs2</code> and <code>vs1</code> respectively.</p>
</div>
<div class="paragraph">
<p>Vector-scalar operations can have three possible forms, but in all
cases take one vector of operands from a vector register group
specified by <code>vs2</code> and a second scalar source operand from one of
three alternative sources.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>For integer operations, the scalar can be a 5-bit immediate encoded
in the <code>rs1</code> field.  The value is sign- or zero-extended to SEW bits.</p>
</li>
<li>
<p>For integer operations, the scalar can be taken from the scalar <code>x</code>
register specified by <code>rs1</code>.  If XLEN&gt;SEW, the least-significant bits
of the <code>x</code> register are used.  If XLEN&lt;SEW, the value from the <code>x</code>
register is sign-extended to SEW bits.</p>
</li>
<li>
<p>For floating-point
operations, the scalar can be taken from a scalar <code>f</code> register.  If
FLEN&gt;SEW, the value in the <code>f</code> registers is checked for a valid
NaN-boxed value, in which case the least-significant bits of the
`f`register are used, else the canonical NaN value is used.  If
FLEN&lt;SEW, the value is NaN-boxed (one-extended) to SEW.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The proposed Zfinx variants will take the floating-point scalar
argument from the <code>x</code> registers.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Vector arithmetic instructions are masked under control of the <code>vm</code>
field.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Assembly syntax pattern for vector binary arithmetic instructions

# Operations returning vector results, masked by vm (v0.t, &lt;nothing&gt;)
vop.vv  vd, vs2, vs1, vm  # integer vector-vector      vd[i] = vs2[i] op vs1[i]
vop.vx  vd, vs2, rs1, vm  # integer vector-scalar      vd[i] = vs2[i] op x[rs1]
vop.vi  vd, vs2, imm, vm  # integer vector-immediate   vd[i] = vs2[i] op imm

vfop.vv  vd, vs2, vs1, vm # FP vector-vector operation vd[i] = vs2[i] fop vs1[i]
vfop.vf  vd, vs2, rs1, vm # FP vector-scalar operation vd[i] = vs2[i] fop f[rs1]</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In the encoding, <code>vs2</code> is the first operand, while <code>rs1/simm5</code>
is the second operand. This is the opposite to the standard scalar
ordering.  This arrangement retains the existing encoding conventions
that instructions that read only one scalar register, read it from
<code>rs1</code>, and that 5-bit immediates are sourced from the <code>rs1</code> field.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre># Assembly syntax pattern for vector ternary arithmetic instructions (multiply-add)

# Integer operations overwriting sum input
vop.vv vd, vs1, vs2, vm  # vd[i] = vs1[i] * vs2[i] + vd[i]
vop.vx vd, rs1, vs2, vm  # vd[i] = x[rs1] * vs2[i] + vd[i]

# Integer operations overwriting product input
vop.vv vd, vs1, vs2, vm  # vd[i] = vs1[i] * vd[i] + vs2[i]
vop.vx vd, rs1, vs2, vm  # vd[i] = x[rs1] * vd[i] + vs2[i]

# Floating-point operations overwriting sum input
vfop.vv vd, vs1, vs2, vm  # vd[i] = vs1[i] * vs2[i] + vd[i]
vfop.vf vd, rs1, vs2, vm  # vd[i] = f[rs1] * vs2[i] + vd[i]

# Floating-point operations overwriting product input
vfop.vv vd, vs1, vs2, vm  # vd[i] = vs1[i] * vd[i] + vs2[i]
vfop.vf vd, rs1, vs2, vm  # vd[i] = f[rs1] * vd[i] + vs2[i]</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For ternary multiply-add operations, the assembler syntax always
places the destination vector register first, followed by either <code>rs1</code>
or <code>vs1</code>, then <code>vs2</code>.  This ordering provides a more natural reading
of the assembler for these ternary operations, as the multiply
operands are always next to each other.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec-widening">11.2. Widening Vector Arithmetic Instructions</h3>
<div class="paragraph">
<p>A few vector arithmetic instructions are defined to be <em>widening</em>
operations where the destination elements are 2*SEW wide and are
stored in a vector register group with twice the number of vector
registers.</p>
</div>
<div class="paragraph">
<p>The first operand can be either single or double-width. These are
generally written with a <code>vw*</code> prefix on the opcode or <code>vfw*</code> for
vector floating-point operations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Assembly syntax pattern for vector widening arithmetic instructions

# Double-width result, two single-width sources: 2*SEW = SEW op SEW
vwop.vv  vd, vs2, vs1, vm  # integer vector-vector      vd[i] = vs2[i] op vs1[i]
vwop.vx  vd, vs2, rs1, vm  # integer vector-scalar      vd[i] = vs2[i] op x[rs1]

# Double-width result, first source double-width, second source single-width: 2*SEW = 2*SEW op SEW
vwop.wv  vd, vs2, vs1, vm  # integer vector-vector      vd[i] = vs2[i] op vs1[i]
vwop.wx  vd, vs2, rs1, vm  # integer vector-scalar      vd[i] = vs2[i] op x[rs1]</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Originally, a <code>w</code> suffix was used on opcode, but this could be
confused with the use of a <code>w</code> suffix to mean word-sized operations in
doubleword integers, so the <code>w</code> was moved to prefix.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The floating-point widening operations were changed to <code>vfw*</code>
from <code>vwf*</code> to be more consistent with any scalar widening
floating-point operations that will be written as <code>fw*</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For integer multiply-add, another possible widening option
increases the size of the accumulator to 4*SEW (i.e., 4*SEW +=
SEW*SEW).  These would be distinguished by a <code>vw4*</code> prefix on the
opcode.  These are not included at this time, but are a possible
addition to spec.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The destination vector register group results are arranged as if both
SEW and LMUL were at twice their current settings (i.e., the
destination element width is 2*SEW, and the destination vector
register group LMUL is 2*LMUL).</p>
</div>
<div class="paragraph">
<p>For all widening instructions, the destination element width must be a
supported element width and the destination LMUL value must also be a
supported LMUL value (&#8804;8, i.e., current LMUL must be &#8804;4),
otherwise an illegal instruction exception is raised.</p>
</div>
<div class="paragraph">
<p>The destination vector register group must be specified using a vector
register number that is valid for the destination&#8217;s LMUL value,
otherwise an illegal instruction exception is raised.</p>
</div>
<div class="paragraph">
<p>The destination vector register group cannot overlap a source vector
register group of a different element width (including the mask
register if masked), otherwise an illegal instruction exception is
raised.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This constraint is necessary to support restart with non-zero
<code>vstart</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For the <code>vw&lt;op&gt;.wv vd, vs2, vs1</code> format instructions, it is legal
for vd to equal vs2.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec-narrowing">11.3. Narrowing Vector Arithmetic Instructions</h3>
<div class="paragraph">
<p>A few instructions are provided to convert double-width source vectors
into single-width destination vectors.  These instructions convert a
vector register group organized as if LMUL and SEW were twice the
current settings, and convert to a vector register group with the
current LMUL/SEW vectors/elements.</p>
</div>
<div class="paragraph">
<p>If (2*LMUL &gt; 8), or (2 * SEW) &gt; ELEN, an illegal instruction exception
is raised.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
An alternative design decision would have been to treat LMUL as
defining the size of the source vector register group.  The choice
here is motivated by the belief the chosen approach will require fewer
LMUL changes.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The source and destination vector register groups have to be specified
with a vector register number that is legal for the source and
destination LMUL value respectively, otherwise an illegal instruction
exception is raised.</p>
</div>
<div class="paragraph">
<p>Where there is a second source vector register group (specified by
<code>vs1</code>), this has the same (narrower) width as the result.</p>
</div>
<div class="paragraph">
<p>The destination vector register group cannot overlap the first source
vector register group (specified by <code>vs2</code>).  The destination vector
register group cannot overlap the mask register if used, unless
LMUL=1. If either constraint is violated, an illegal instruction
exception is raised.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It is safe to overwrite a second source vector register group
with the same LMUL and element width as the result, or to overwrite a
mask register when LMUL=1.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A <code>vn*</code> prefix on the opcode is used to distinguish these instructions
in the assembler, or a <code>vfn*</code> prefix for narrowing floating-point
opcodes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Comparison operations that set a mask register are also
implicitly a narrowing operation.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vector_integer_arithmetic_instructions">12. Vector Integer Arithmetic Instructions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A set of vector integer arithmetic instructions are provided.</p>
</div>
<div class="sect2">
<h3 id="_vector_single_width_integer_add_and_subtract">12.1. Vector Single-Width Integer Add and Subtract</h3>
<div class="paragraph">
<p>Vector integer add and subtract are provided.  Reverse-subtract
instructions are also provided for the vector-scalar forms.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Integer adds.
vadd.vv vd, vs2, vs1, vm   # Vector-vector
vadd.vx vd, vs2, rs1, vm   # vector-scalar
vadd.vi vd, vs2, imm, vm   # vector-immediate

# Integer subtract
vsub.vv vd, vs2, vs1, vm   # Vector-vector
vsub.vx vd, vs2, rs1, vm   # vector-scalar

# Integer reverse subtract
vrsub.vx vd, vs2, rs1, vm   # vd[i] = rs1 - vs2[i]
vrsub.vi vd, vs2, imm, vm   # vd[i] = imm - vs2[i]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_widening_integer_addsubtract">12.2. Vector Widening Integer Add/Subtract</h3>
<div class="paragraph">
<p>The widening add/subtract instructions are provided in both signed and
unsigned variants, depending on whether the narrower source operands
are first sign- or zero-extended before forming the double-width sum.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Widening unsigned integer add/subtract, 2*SEW = SEW +/- SEW
vwaddu.vv  vd, vs2, vs1, vm  # vector-vector
vwaddu.vx  vd, vs2, rs1, vm  # vector-scalar
vwsubu.vv  vd, vs2, vs1, vm  # vector-vector
vwsubu.vx  vd, vs2, rs1, vm  # vector-scalar

# Widening signed integer add/subtract, 2*SEW = SEW +/- SEW
vwadd.vv  vd, vs2, vs1, vm  # vector-vector
vwadd.vx  vd, vs2, rs1, vm  # vector-scalar
vwsub.vv  vd, vs2, vs1, vm  # vector-vector
vwsub.vx  vd, vs2, rs1, vm  # vector-scalar

# Widening unsigned integer add/subtract, 2*SEW = 2*SEW +/- SEW
vwaddu.wv  vd, vs2, vs1, vm  # vector-vector
vwaddu.wx  vd, vs2, rs1, vm  # vector-scalar
vwsubu.wv  vd, vs2, vs1, vm  # vector-vector
vwsubu.wx  vd, vs2, rs1, vm  # vector-scalar

# Widening signed integer add/subtract, 2*SEW = 2*SEW +/- SEW
vwadd.wv  vd, vs2, vs1, vm  # vector-vector
vwadd.wx  vd, vs2, rs1, vm  # vector-scalar
vwsub.wv  vd, vs2, vs1, vm  # vector-vector
vwsub.wx  vd, vs2, rs1, vm  # vector-scalar</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
An integer value can be doubled in width using the widening add
instructions with a scalar operand of <code>x0</code>.  Can define assembly
pseudoinstructions <code>vwcvt.x.x.v vd,vs,vm = vwadd.vx vd,vs,x0,vm</code> and
<code>vwcvtu.x.x.v vd,vs,vm = vwaddu.vx vd,vs,x0,vm</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_integer_add_with_carry_subtract_with_borrow_instructions">12.3. Vector Integer Add-with-Carry / Subtract-with-Borrow Instructions</h3>
<div class="paragraph">
<p>To support multi-word integer arithmetic, instructions that operate on
a carry bit are provided.  For each operation (add or subtract), two
instructions are provided: one to provide the result (SEW width), and
the second to generate the carry output (single bit encoded as a mask
boolean).</p>
</div>
<div class="paragraph">
<p>These instructions are encoded as unmasked instructions (vm=1) and
operate on all body elements.  Encodings corresponding to the masked
versions (vm=0) of these instructions are reserved.</p>
</div>
<div class="paragraph">
<p>The carry inputs and outputs are represented using the mask register
layout as described in Section <a href="#sec-mask-register-layout">Mask Register Layout</a>.  Due to
encoding constraints, the carry input must come from the implicit <code>v0</code>
register, but carry outputs can be written to any vector register that
respects the source/destination overlap restrictions below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> # Produce sum with carry.

# vd[i] = vs2[i] + vs1[i] + v0[i].LSB
 vadc.vvm   vd, vs2, vs1, v0  # Vector-vector

 # vd[i] = vs2[i] + x[rs1] + v0[i].LSB
 vadc.vxm   vd, vs2, rs1, v0  # Vector-scalar

 # vd[i] = vs2[i] + imm + v0[i].LSB
 vadc.vim   vd, vs2, imm, v0  # Vector-immediate

 # Produce carry out in mask register format

# vd[i] = carry_out(vs2[i] + vs1[i] + v0[i].LSB)
 vmadc.vvm   vd, vs2, vs1, v0  # Vector-vector

 # vd[i] = carry_out(vs2[i] + x[rs1] + v0[i].LSB)
 vmadc.vxm   vd, vs2, rs1, v0  # Vector-scalar

 # vd[i] = carry_out(vs2[i] + imm + v0[i].LSB)
 vmadc.vim   vd, vs2, imm, v0  # Vector-immediate</pre>
</div>
</div>
<div class="paragraph">
<p>Because implementing a carry propagation requires executing two
instructions with unchanged inputs, destructive accumulations will
require an additional move to obtain correct results.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  # Example multi-word arithmetic sequence, accumulating into v4
  vmadc.vvm v1, v4, v8, v0  # Get carry into temp register v1
  vadc.vvm v4, v4, v8, v0   # Calc new sum
  vmcpy.m v0, v1             # Move temp carry into v0 for next word</pre>
</div>
</div>
<div class="paragraph">
<p>The subtract with borrow instruction <code>vsbc</code> performs the equivalent
function to support long word arithmetic for subtraction.  There are
no subtract with immediate instructions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> # Produce difference with borrow.

# vd[i] = vs2[i] - vs1[i] - v0[i].LSB
 vsbc.vvm   vd, vs2, vs1, v0  # Vector-vector

 # vd[i] = vs2[i] - x[rs1] - v0[i].LSB
 vsbc.vxm   vd, vs2, rs1, v0  # Vector-scalar

 # Produce borrow out in mask register format

 # vd[i] = borrow_out(vs2[i] - vs1[i] - v0[i].LSB)
 vmsbc.vvm   vd, vs2, vs1, v0  # Vector-vector

 # vd[i] = borrow_out(vs2[i] - x[rs1] - v0[i].LSB)
 vmsbc.vxm   vd, vs2, rs1, v0  # Vector-scalar</pre>
</div>
</div>
<div class="paragraph">
<p>For <code>vmsbc</code>, the borrow is defined to be 1 iff the difference, prior to
truncation, is negative.</p>
</div>
<div class="paragraph">
<p>For <code>vadc</code> and <code>vsbc</code>, an illegal instruction exception is raised
if the destination vector register is <code>v0</code> and LMUL &gt; 1.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This constraint corresponds to the constraint on masked vector
operations that overwrite the mask register.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For <code>vmadc</code> and <code>vmsbc</code>, an illegal instruction exception is raised if
the destination vector register overlaps a source vector register
group and LMUL &gt; 1.</p>
</div>
</div>
<div class="sect2">
<h3 id="_vector_bitwise_logical_instructions">12.4. Vector Bitwise Logical Instructions</h3>
<div class="listingblock">
<div class="content">
<pre># Bitwise logical operations.
vand.vv vd, vs2, vs1, vm   # Vector-vector
vand.vx vd, vs2, rs1, vm   # vector-scalar
vand.vi vd, vs2, imm, vm   # vector-immediate

vor.vv vd, vs2, vs1, vm    # Vector-vector
vor.vx vd, vs2, rs1, vm    # vector-scalar
vor.vi vd, vs2, imm, vm    # vector-immediate

vxor.vv vd, vs2, vs1, vm    # Vector-vector
vxor.vx vd, vs2, rs1, vm    # vector-scalar
vxor.vi vd, vs2, imm, vm    # vector-immediate</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
With an immediate of -1, scalar-immediate forms of the <code>vxor</code>
instruction provide a bitwise NOT operation.  This can be provided as
an assembler pseudoinstruction <code>vnot.v</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_single_width_bit_shift_instructions">12.5. Vector Single-Width Bit Shift Instructions</h3>
<div class="paragraph">
<p>A full complement of vector shift instructions are provided, including
logical shift left, and logical (zero-extending) and arithmetic
(sign-extending) shift right.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Bit shift operations
vsll.vv vd, vs2, vs1, vm   # Vector-vector
vsll.vx vd, vs2, rs1, vm   # vector-scalar
vsll.vi vd, vs2, uimm, vm   # vector-immediate

vsrl.vv vd, vs2, vs1, vm   # Vector-vector
vsrl.vx vd, vs2, rs1, vm   # vector-scalar
vsrl.vi vd, vs2, uimm, vm   # vector-immediate

vsra.vv vd, vs2, vs1, vm   # Vector-vector
vsra.vx vd, vs2, rs1, vm   # vector-scalar
vsra.vi vd, vs2, uimm, vm   # vector-immediate</pre>
</div>
</div>
<div class="paragraph">
<p>Only the low lg2(SEW) bits are read to obtain the shift amount.</p>
</div>
<div class="paragraph">
<p>The immediate is treated as an unsigned shift amount, with a maximum
shift amount of 31.</p>
</div>
</div>
<div class="sect2">
<h3 id="_vector_narrowing_integer_right_shift_instructions">12.6. Vector Narrowing Integer Right Shift Instructions</h3>
<div class="paragraph">
<p>The narrowing right shifts extract a smaller field from a wider
operand and have both zero-extending (<code>srl</code>) and sign-extending
(<code>sra</code>) forms.  The shift amount can come from a vector or a scalar
<code>x</code> register or a 5-bit immediate.  The low lg2(2*SEW) bits of the
vector or scalar shift amount value are used (e.g., the low 6 bits for
a SEW=64-bit to SEW=32-bit narrowing operation).  The unsigned immediate form
supports shift amounts up to 31 only.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> # Narrowing shift right logical, SEW = (2*SEW) &gt;&gt; SEW
 vnsrl.vv vd, vs2, vs1, vm   # vector-vector
 vnsrl.vx vd, vs2, rs1, vm   # vector-scalar
 vnsrl.vi vd, vs2, uimm, vm   # vector-immediate

 # Narrowing shift right arithmetic, SEW = (2*SEW) &gt;&gt; SEW
 vnsra.vv vd, vs2, vs1, vm   # vector-vector
 vnsra.vx vd, vs2, rs1, vm   # vector-scalar
 vnsra.vi vd, vs2, uimm, vm   # vector-immediate</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It could be useful to add support for <code>n4</code> variants, where the
destination is 1/4 width of source.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_integer_comparison_instructions">12.7. Vector Integer Comparison Instructions</h3>
<div class="paragraph">
<p>The following integer compare instructions write 1 to the
destination mask register element if the comparison evaluates to true,
and 0 otherwise.  The destination mask vector is always held in a
single vector register, with a layout of elements as described in
Section <a href="#sec-mask-register-layout">Mask Register Layout</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Set if equal
vmseq.vv vd, vs2, vs1, vm  # Vector-vector
vmseq.vx vd, vs2, rs1, vm  # vector-scalar
vmseq.vi vd, vs2, imm, vm  # vector-immediate

# Set if not equal
vmsne.vv vd, vs2, vs1, vm  # Vector-vector
vmsne.vx vd, vs2, rs1, vm  # vector-scalar
vmsne.vi vd, vs2, imm, vm  # vector-immediate

# Set if less than, unsigned
vmsltu.vv vd, vs2, vs1, vm  # Vector-vector
vmsltu.vx vd, vs2, rs1, vm  # Vector-scalar

# Set if less than, signed
vmslt.vv vd, vs2, vs1, vm  # Vector-vector
vmslt.vx vd, vs2, rs1, vm  # vector-scalar

# Set if less than or equal, unsigned
vmsleu.vv vd, vs2, vs1, vm   # Vector-vector
vmsleu.vx vd, vs2, rs1, vm   # vector-scalar
vmsleu.vi vd, vs2, imm, vm   # Vector-immediate

# Set if less than or equal, signed
vmsle.vv vd, vs2, vs1, vm  # Vector-vector
vmsle.vx vd, vs2, rs1, vm  # vector-scalar
vmsle.vi vd, vs2, imm, vm  # vector-immediate

# Set if greater than, unsigned
vmsgtu.vx vd, vs2, rs1, vm   # Vector-scalar
vmsgtu.vi vd, vs2, imm, vm   # Vector-immediate

# Set if greater than, signed
vmsgt.vx vd, vs2, rs1, vm    # Vector-scalar
vmsgt.vi vd, vs2, imm, vm    # Vector-immediate

# Following two instructions are not provided directly
# Set if greater than or equal, unsigned
# vmsgeu.vx vd, vs2, rs1, vm    # Vector-scalar
# Set if greater than or equal, signed
# vmsge.vx vd, vs2, rs1, vm    # Vector-scalar</pre>
</div>
</div>
<div class="paragraph">
<p>The following table indicates how all comparisons are implemented in
native machine code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Comparison      Assembler Mapping             Assembler Pseudoinstruction

va &lt; vb         vmslt{u}.vv vd, va, vb, vm
va &lt;= vb        vmsle{u}.vv vd, va, vb, vm
va &gt; vb         vmslt{u}.vv vd, vb, va, vm    vmsgt{u}.vv vd, va, vb, vm
va &gt;= vb        vmsle{u}.vv vd, vb, va, vm    vmsge{u}.vv vd, va, vb, vm

va &lt; x          vmslt{u}.vx vd, va, x, vm
va &lt;= x         vmsle{u}.vx vd, va, x, vm
va &gt; x          vmsgt{u}.vx vd, va, x, vm
va &gt;= x         see below

va &lt; i          vmsle{u}.vi vd, va, i-1, vm    vmslt{u}.vi vd, va, i, vm
va &lt;= i         vmsle{u}.vi vd, va, i, vm
va &gt; i          vmsgt{u}.vi vd, va, i, vm
va &gt;= i         vmsgt{u}.vi vd, va, i-1, vm    vmsge{u}.vi vd, va, i, vm

va, vb vector register groups
x      scalar integer register
i      immediate</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The immediate forms of <code>vmslt{u}.vi</code> are not provided as the
immediate value can be decreased by 1 and the <code>vmsle{u}.vi</code> variants
used instead.  The <code>vmsle.vi</code> range is -16 to 15, resulting in an
effective <code>vmslt.vi</code> range of -15 to 16.  The <code>vmsleu.vi</code> range is 0 to
15 (and <code>(~0)-15</code> to <code>~0</code>), giving an effective <code>vmsltu.vi</code> range of 1 to 16
(Note, <code>vmsltu.vi</code> with immediate 0 is not useful as it is always
false). Similarly, <code>vmsge{u}.vi</code> is not provided and the comparison is
implemented using <code>vmsgt{u}.vi</code> with the immediate decremented by one.
The resulting effective <code>vmsge.vi</code> range is -15 to 16, and the
resulting effective <code>vmsgeu.vi</code> range is 1 to 16 (Note, <code>vmsgeu.vi</code> with
immediate 0 is not useful as it is always true).
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>vmsgt</code> forms for register scalar and immediates are provided
to allow a single comparison instruction to provide the correct
polarity of mask value without using additional mask logical
instructions.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To reduce encoding space, the <code>vmsge{u}.vx</code> form is not directly
provided, and so the <code>va &#8805; x</code> case requires special treatment.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>vmsge{u}.vx</code> could potentially be encoded in a
non-orthogonal way under the unused OPIVI variant of <code>vmslt{u}</code>.  These
would be the only instructions in OPIVI that use a scalar `x`register
however.  Alternatively, a further two funct6 encodings could be used,
but these would have a different operand format (writes to mask
register) than others in the same group of 8 funct6 encodings.  The
current PoR is to omit these instructions and to synthesize where
needed as described below.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>vmsge{u}.vx</code> operation can be synthesized by reducing the
value of <code>x</code> by 1 and using the <code>vmsgt{u}.vx</code> instruction, when it is
known that this will not underflow the representation in <code>x</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Sequences to synthesize `vmsge{u}.vx` instruction

va &gt;= x,  x &gt; minimum

   addi t0, x, -1; vmsgt{u}.vx vd, va, t0, vm</pre>
</div>
</div>
<div class="paragraph">
<p>The above sequence will usually be the most efficient implementation,
but assembler pseudoinstructions can be provided for cases where the
range of <code>x</code> is unknown.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>unmasked va &gt;= x

  pseudoinstruction: vmsge{u}.vx vd, va, x
  expansion: vmslt{u}.vx vd, va, x; vmnand.mm vd, vd, vd

masked va &gt;= x, vd != v0

  pseudoinstruction: vmsge{u}.vx vd, va, x, v0.t
  expansion: vmslt{u}.vx vd, va, x, v0.t; vmxor.mm vd, vd, v0

masked va &gt;= x, any vd

  pseudoinstruction: vmsge{u}.vx vd, va, x, v0.t, vt
  expansion: vmslt{u}.vx vt, va, x;  vmandnot.mm vd, vd, vt

  The vt argument to the pseudoinstruction must name a temporary vector register that is
  not same as vd and which will be clobbered by the pseudoinstruction</pre>
</div>
</div>
<div class="paragraph">
<p>Comparisons effectively AND in the mask, e.g,</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    # (a &lt; b) &amp;&amp; (b &lt; c) in two instructions
    vmslt.vv    v0, va, vb        # All body elements written
    vmslt.vv    v0, vb, vc, v0.t  # Only update at set mask</pre>
</div>
</div>
<div class="paragraph">
<p>For all comparison instructions, an illegal instruction exception is raised if
the destination vector register overlaps a source vector register group and
LMUL &gt; 1.</p>
</div>
</div>
<div class="sect2">
<h3 id="_vector_integer_minmax_instructions">12.8. Vector Integer Min/Max Instructions</h3>
<div class="paragraph">
<p>Signed and unsigned integer minimum and maximum instructions are
supported.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Unsigned minimum
vminu.vv vd, vs2, vs1, vm   # Vector-vector
vminu.vx vd, vs2, rs1, vm   # vector-scalar

# Signed minimum
vmin.vv vd, vs2, vs1, vm   # Vector-vector
vmin.vx vd, vs2, rs1, vm   # vector-scalar

# Unsigned maximum
vmaxu.vv vd, vs2, vs1, vm   # Vector-vector
vmaxu.vx vd, vs2, rs1, vm   # vector-scalar

# Signed maximum
vmax.vv vd, vs2, vs1, vm   # Vector-vector
vmax.vx vd, vs2, rs1, vm   # vector-scalar</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_single_width_integer_multiply_instructions">12.9. Vector Single-Width Integer Multiply Instructions</h3>
<div class="paragraph">
<p>The single-width multiply instructions perform a SEW-bit*SEW-bit
multiply and return an SEW-bit-wide result.  The <code><strong>mulh</strong></code> versions
write the high word of the product to the destination register.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Signed multiply, returning low bits of product
vmul.vv vd, vs2, vs1, vm   # Vector-vector
vmul.vx vd, vs2, rs1, vm   # vector-scalar

# Signed multiply, returning high bits of product
vmulh.vv vd, vs2, vs1, vm   # Vector-vector
vmulh.vx vd, vs2, rs1, vm   # vector-scalar

# Unsigned multiply, returning high bits of product
vmulhu.vv vd, vs2, vs1, vm   # Vector-vector
vmulhu.vx vd, vs2, rs1, vm   # vector-scalar

# Signed(vs2)-Unsigned multiply, returning high bits of product
vmulhsu.vv vd, vs2, vs1, vm   # Vector-vector
vmulhsu.vx vd, vs2, rs1, vm   # vector-scalar</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
There is no <code>vmulhus</code> opcode to return high half of
unsigned-vector * signed-scalar product.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The current <code>vmulh*</code> opcodes perform simple fractional
multiplies, but with no option to scale, round, and/or saturate the
result.  Can consider changing definition of <code>vmulh</code>, <code>vmulhu</code>,
<code>vmulhsu</code> to use <code>vxrm</code> rounding mode when discarding low half of
product.  There is no possibility of overflow in this case.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_integer_divide_instructions">12.10. Vector Integer Divide Instructions</h3>
<div class="paragraph">
<p>The divide and remainder instructions are equivalent to the RISC-V
standard scalar integer multiply/divides, with the same results for
extreme inputs.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    # Unsigned divide.
    vdivu.vv vd, vs2, vs1, vm   # Vector-vector
    vdivu.vx vd, vs2, rs1, vm   # vector-scalar

    # Signed divide
    vdiv.vv vd, vs2, vs1, vm   # Vector-vector
    vdiv.vx vd, vs2, rs1, vm   # vector-scalar

    # Unsigned remainder
    vremu.vv vd, vs2, vs1, vm   # Vector-vector
    vremu.vx vd, vs2, rs1, vm   # vector-scalar

    # Signed remainder
    vrem.vv vd, vs2, vs1, vm   # Vector-vector
    vrem.vx vd, vs2, rs1, vm   # vector-scalar</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The decision to include integer divide and remainder was
contentious. The argument in favor is that without a standard
instruction, software would have to pick some algorithm to perform the
operation, which would likely perform poorly on some
microarchitectures versus others.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
There is no instruction to perform a "scalar divide by vector"
operation.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_widening_integer_multiply_instructions">12.11. Vector Widening Integer Multiply Instructions</h3>
<div class="paragraph">
<p>The widening integer multiply instructions return the full 2*SEW-bit
product from an SEW-bit*SEW-bit multiply.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Widening signed-integer multiply
vwmul.vv  vd, vs2, vs1, vm# vector-vector
vwmul.vx  vd, vs2, rs1, vm # vector-scalar

# Widening unsigned-integer multiply
vwmulu.vv vd, vs2, vs1, vm # vector-vector
vwmulu.vx vd, vs2, rs1, vm # vector-scalar

# Widening signed-unsigned integer multiply
vwmulsu.vv vd, vs2, vs1, vm # vector-vector
vwmulsu.vx vd, vs2, rs1, vm # vector-scalar</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_single_width_integer_multiply_add_instructions">12.12. Vector Single-Width Integer Multiply-Add Instructions</h3>
<div class="paragraph">
<p>The integer multiply-add instructions are destructive and are provided
in two forms, one that overwrites the addend or minuend
(<code>vmacc</code>, <code>vnmsac</code>) and one that overwrites the first multiplicand
(<code>vmadd</code>, <code>vnmsub</code>).</p>
</div>
<div class="paragraph">
<p>The low half of the product is added or subtracted from the third operand.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
"sac" is intended to be read as "subtract from accumulator". The
opcode is "vnmsac" to match the (unfortunately counterintuitive)
floating-point <code>fnmsub</code> instruction definition.  Similarly for the
"vnmsub" opcode.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre># Integer multiply-add, overwrite addend
vmacc.vv vd, vs1, vs2, vm    # vd[i] = +(vs1[i] * vs2[i]) + vd[i]
vmacc.vx vd, rs1, vs2, vm    # vd[i] = +(x[rs1] * vs2[i]) + vd[i]

# Integer multiply-sub, overwrite minuend
vnmsac.vv vd, vs1, vs2, vm    # vd[i] = -(vs1[i] * vs2[i]) + vd[i]
vnmsac.vx vd, rs1, vs2, vm    # vd[i] = -(x[rs1] * vs2[i]) + vd[i]

# Integer multiply-add, overwrite multiplicand
vmadd.vv vd, vs1, vs2, vm    # vd[i] = (vs1[i] * vd[i]) + vs2[i]
vmadd.vx vd, rs1, vs2, vm    # vd[i] = (x[rs1] * vd[i]) + vs2[i]

# Integer multiply-sub, overwrite multiplicand
vnmsub.vv vd, vs1, vs2, vm    # vd[i] = -(vs1[i] * vd[i]) + vs2[i]
vnmsub.vx vd, rs1, vs2, vm    # vd[i] = -(x[rs1] * vd[i]) + vs2[i]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_widening_integer_multiply_add_instructions">12.13. Vector Widening Integer Multiply-Add Instructions</h3>
<div class="paragraph">
<p>The widening integer multiply-add instructions add a SEW-bit*SEW-bit
multiply result to (from) a 2*SEW-bit value and produce a 2*SEW-bit
result.  All combinations of signed and unsigned multiply operands are
supported.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Widening unsigned-integer multiply-add, overwrite addend
vwmaccu.vv vd, vs1, vs2, vm    # vd[i] = +(vs1[i] * vs2[i]) + vd[i]
vwmaccu.vx vd, rs1, vs2, vm    # vd[i] = +(x[rs1] * vs2[i]) + vd[i]

# Widening signed-integer multiply-add, overwrite addend
vwmacc.vv vd, vs1, vs2, vm    # vd[i] = +(vs1[i] * vs2[i]) + vd[i]
vwmacc.vx vd, rs1, vs2, vm    # vd[i] = +(x[rs1] * vs2[i]) + vd[i]

# Widening signed-unsigned-integer multiply-add, overwrite addend
vwmaccsu.vv vd, vs1, vs2, vm    # vd[i] = +(signed(vs1[i]) * unsigned(vs2[i])) + vd[i]
vwmaccsu.vx vd, rs1, vs2, vm    # vd[i] = +(signed(x[rs1]) * unsigned(vs2[i])) + vd[i]

# Widening unsigned-signed-integer multiply-add, overwrite addend
vwmaccus.vx vd, rs1, vs2, vm    # vd[i] = +(unsigned(x[rs1]) * signed(vs2[i])) + vd[i]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_integer_merge_instructions">12.14. Vector Integer Merge Instructions</h3>
<div class="paragraph">
<p>The vector integer merge instructions combine two source operands
based on the mask field.  Unlike regular arithmetic instructions, the
merge operates on all body elements (i.e., the set of elements from
<code>vstart</code> up to the current vector length in <code>vl</code>).</p>
</div>
<div class="paragraph">
<p>The <code>vmerge</code> instructions are always masked (<code>vm=0</code>).
The instructions combine two
sources as follows.  At elements where the mask value is zero, the
first operand is copied to the destination element, otherwise the
second operand is copied to the destination element.  The first
operand is always a vector register group specified by <code>vs2</code>.  The
second operand is a vector register group specified by <code>vs1</code> or a
scalar <code>x</code> register specified by <code>rs1</code> or a 5-bit sign-extended
immediate.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>vmerge.vvm vd, vs2, vs1, v0  # vd[i] = v0[i].LSB ? vs1[i] : vs2[i]
vmerge.vxm vd, vs2, rs1, v0  # vd[i] = v0[i].LSB ? x[rs1] : vs2[i]
vmerge.vim vd, vs2, imm, v0  # vd[i] = v0[i].LSB ? imm    : vs2[i]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_integer_move_instructions">12.15. Vector Integer Move Instructions</h3>
<div class="paragraph">
<p>The vector integer move instructions copy a source operand to a vector
register group.  These instructions are always unmasked (<code>vm=1</code>).
The first operand specifier (<code>vs2</code>) must contain <code>v0</code>, and any other
vector register number in <code>vs2</code> is <em>reserved</em>.  This instruction
copies the <code>vs1</code>, <code>rs1</code>, or immediate operand to the first <code>vl</code>
locations of the destination vector register group.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>vmv.v.v vd, vs1 # vd[i] = vs1[i]
vmv.v.x vd, rs1 # vd[i] = rs1
vmv.v.i vd, imm # vd[i] = imm</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Mask values can be widened into SEW-width elements using a
sequence <code>vmv.v.i vd, 0; vmerge.vim vd, vd, 1, v0</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The vector integer move instructions share the encoding with the vector
merge instructions, but with <code>vm=1</code> and <code>vs2=v0</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vector_fixed_point_arithmetic_instructions">13. Vector Fixed-Point Arithmetic Instructions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A set of vector arithmetic instructions are provided to support
fixed-point arithmetic.</p>
</div>
<div class="paragraph">
<p>An N-bit element can hold two&#8217;s-complement signed integers in the
range -2<sup>N-1</sup>&#8230;&#8203;+2<sup>N-1</sup>-1, and unsigned integers in the range 0
&#8230;&#8203; +2<sup>N</sup>-1.  The fixed-point instructions help preserve precision in
narrow operands by supporting scaling and rounding, and can handle
overflow by saturating results into the destination format range.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The widening integer operations described above can also be used
to remove the possibility of overflow.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_vector_single_width_saturating_add_and_subtract">13.1. Vector Single-Width Saturating Add and Subtract</h3>
<div class="paragraph">
<p>Saturating forms of integer add and subtract are provided, for both
signed and unsigned integers.  If the result would overflow the
destination, the result is replaced with the closest representable
value, and the <code>vxsat</code> bit is set.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Saturating adds of unsigned integers.
vsaddu.vv vd, vs2, vs1, vm   # Vector-vector
vsaddu.vx vd, vs2, rs1, vm   # vector-scalar
vsaddu.vi vd, vs2, imm, vm   # vector-immediate

# Saturating adds of signed integers.
vsadd.vv vd, vs2, vs1, vm   # Vector-vector
vsadd.vx vd, vs2, rs1, vm   # vector-scalar
vsadd.vi vd, vs2, imm, vm   # vector-immediate

# Saturating subtract of unsigned integers.
vssubu.vv vd, vs2, vs1, vm   # Vector-vector
vssubu.vx vd, vs2, rs1, vm   # vector-scalar

# Saturating subtract of signed integers.
vssub.vv vd, vs2, vs1, vm   # Vector-vector
vssub.vx vd, vs2, rs1, vm   # vector-scalar</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_single_width_averaging_add_and_subtract">13.2. Vector Single-Width Averaging Add and Subtract</h3>
<div class="paragraph">
<p>The averaging add and subtract instructions right shift the result by
one bit and round off the result according to the setting in <code>vxrm</code>.
There can be no overflow in the result.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># For vrxm=rnu, round = 1

# Averaging add
# result = (src1 + src2 + round) &gt;&gt; 1;

# Averaging adds of integers.
vaadd.vv vd, vs2, vs1, vm   # Vector-vector
vaadd.vx vd, vs2, rs1, vm   # vector-scalar
vaadd.vi vd, vs2, imm, vm   # vector-immediate

# Averaging subtract
# result = (src1 - src2 + round) &gt;&gt; 1;

# Averaging subtract of integers.
vasub.vv vd, vs2, vs1, vm   # Vector-vector
vasub.vx vd, vs2, rs1, vm   # vector-scalar</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_single_width_fractional_multiply_with_rounding_and_saturation">13.3. Vector Single-Width Fractional Multiply with Rounding and Saturation</h3>
<div class="paragraph">
<p>The signed fractional multiply instruction produces a 2*SEW product of
the two SEW inputs, then shifts the result right by SEW-1 bits,
rounding these bits according to <code>vxrm</code>, then saturates the result to
fit into SEW bits.  If the result causes saturation, the <code>vxsat</code> bit
is set.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Signed saturating and rounding fractional multiply
vsmul.vv vd, vs2, vs1, vm  # vd[i] = clip((vs2[i]*vs1[i]+round)&gt;&gt;(SEW-1))
vsmul.vx vd, vs2, rs1, vm  # vd[i] = clip((vs2[i]*x[rs1]+round)&gt;&gt;(SEW-1))</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When multiplying two N-bit signed numbers, the largest magnitude
is obtained for -2<sup>N-1</sup> * -2<sup>N-1</sup> producing a result +2<sup>2N-2</sup>, which
has a single (zero) sign bit when held in 2N bits.  All other products
have two sign bits in 2N bits.  To retain greater precision in N
result bits, the product is shifted right by one bit less than N,
saturating the largest magnitude result but increasing result
precision by one bit for all other products.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Considering adding <code>vxrm</code>-controlled rounding to <code>vmulhu</code>,
<code>vmulhsu</code>, and <code>vmulh</code> to further support fixed-point.  These would
not have saturation.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_widening_saturating_scaled_multiply_add">13.4. Vector Widening Saturating Scaled Multiply-Add</h3>
<div class="paragraph">
<p>The widening saturating scaled multiply-add instructions perform an
SEW-bit * SEW-bit multiply to yield a 2*SEW-bit product. The product
is then right-shifted by SEW/2 bits with the shifted bits rounded off
according to <code>vxrm</code>, and the rounded product is added to a 2*SEW-bit
destination accumulator, with saturation if the result would overflow
the destination accumulator. The <code>vxsat</code> bit is set if any overflow
occurs.</p>
</div>
<div class="paragraph">
<p>If any multiplier operand is signed, then the result is treated as a
signed value for overflow/saturation.  If both multiplier operands are
unsigned then the result is treated as an unsigned value for
overflow/saturation.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">SEW</th>
<th class="tableblock halign-left valign-top">Product Width</th>
<th class="tableblock halign-left valign-top">Rounded Product</th>
<th class="tableblock halign-left valign-top">Accumulator</th>
<th class="tableblock halign-left valign-top">Guard Bits</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">48</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre># Widening unsigned-integer scaled multiply-accumulate
vwsmaccu.vv vd, vs1, vs2, vm # vd[i] = clipu((+(vs1[i]*vs2[i]+round)&gt;&gt;SEW/2)+vd[i])
vwsmaccu.vx vd, rs1, vs2, vm # vd[i] = clipu((+(x[rs1]*vs2[i]+round)&gt;&gt;SEW/2)+vd[i])

# Widening signed-integer scaled multiply-accumulate
vwsmacc.vv vd, vs1, vs2, vm  # vd[i] = clip((+(vs1[i]*vs2[i]+round)&gt;&gt;SEW/2)+vd[i])
vwsmacc.vx vd, rs1, vs2, vm  # vd[i] = clip((+(x[rs1]*vs2[i]+round)&gt;&gt;SEW/2)+vd[i])

# Widening signed-unsigned-integer scaled multiply-accumulate
vwsmaccsu.vv vd, vs1, vs2, vm
             # vd[i] = clip(((signed(vs1[i])*unsigned(vs2[i])+round)&gt;&gt;SEW/2)+vd[i])
vwsmaccsu.vx vd, rs1, vs2, vm
             # vd[i] = clip(((signed(x[rs1])*unsigned(vs2[i])+round)&gt;&gt;SEW/2)+vd[i])

# Widening unsigned-signed-integer scaled  multiply-accumulate
vwsmaccus.vx vd, rs1, vs2, vm
             # vd[i] = clip(((unsigned(x[rs1])*signed(vs2[i])+round)&gt;&gt;SEW/2)+vd[i])

# For vxrm=rnu, round = (1 &lt;&lt; (SEW/2-1))</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
An arbitrary scaling/shift amount would be more flexible but
would require a fourth source operand.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_single_width_scaling_shift_instructions">13.5. Vector Single-Width Scaling Shift Instructions</h3>
<div class="paragraph">
<p>These instructions shift the input value right, and round off the
shifted out bits according to <code>vxrm</code>.  The scaling right shifts have
both zero-extending (<code>vssrl</code>) and sign-extending (<code>vssra</code>) forms. The
low lg2(SEW) bits of the vector or scalar shift amount value are used.
The immediate form supports shift amounts up to 31 only.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> # For vxrm=rnu, round = 1 &lt;&lt; (src2-1), where src2 is vs1[i], x[rs1], uimm
 # Scaling shift right logical
 vssrl.vv vd, vs2, vs1, vm   # vd[i] = ((vs2[i] + round)&gt;&gt;vs1[i])
 vssrl.vx vd, vs2, rs1, vm   # vd[i] = ((vs2[i] + round)&gt;&gt;x[rs1])
 vssrl.vi vd, vs2, uimm, vm   # vd[i] = ((vs2[i] + round)&gt;&gt;uimm)

 # Scaling shift right arithmetic
 vssra.vv vd, vs2, vs1, vm   # vd[i] = ((vs2[i] + round)&gt;&gt;vs1[i])
 vssra.vx vd, vs2, rs1, vm   # vd[i] = ((vs2[i] + round)&gt;&gt;x[rs1])
 vssra.vi vd, vs2, uimm, vm   # vd[i] = ((vs2[i] + round)&gt;&gt;uimm)</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_narrowing_fixed_point_clip_instructions">13.6. Vector Narrowing Fixed-Point Clip Instructions</h3>
<div class="paragraph">
<p>The <code>vnclip</code> instructions are used to pack a fixed-point value into a
narrower destination.  The instructions support rounding, scaling, and
saturation into the final destination format.</p>
</div>
<div class="paragraph">
<p>The second argument (vector element, scalar value, immediate value)
gives the amount to right shift the source as in the narrowing shift
instructions, which provides the scaling.  The low lg2(2*SEW) bits of
the vector or scalar shift amount value are used (e.g., the low 6 bits
for a SEW=64-bit to SEW=32-bit narrowing operation).  The immediate
form supports shift amounts up to 31 only.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> # Narrowing unsigned clip
 vnclipu.vv vd, vs2, vs1, vm   # vector-vector
 vnclipu.vx vd, vs2, rs1, vm   # vector-scalar
 vnclipu.vi vd, vs2, uimm, vm   # vector-immediate

# Narrowing signed clip,  vd[i] = clip(round(vs2[i] + rnd) &gt;&gt; vs1[i])
#                          SEW           2*SEW                 SEW
 vnclip.vv vd, vs2, vs1, vm   # vector-vector
 vnclip.vx vd, vs2, rs1, vm   # vector-scalar
 vnclip.vi vd, vs2, uimm, vm   # vector-immediate</pre>
</div>
</div>
<div class="paragraph">
<p>For <code>vnclipu</code>/<code>vnclip</code>, the rounding mode is specified in the <code>vxrm</code>
CSR.  Rounding occurs around the least-significant bit of the
destination and before saturation.</p>
</div>
<div class="paragraph">
<p>For <code>vnclipu</code>, the shifted rounded source value is treated as an
unsigned integer and saturates if the result would overflow the
destination viewed as an unsigned integer.</p>
</div>
<div class="paragraph">
<p>For <code>vnclip</code>, the shifted rounded source value is treated as a signed
integer and saturates if the result would overflow the destination viewed
as a signed integer.</p>
</div>
<div class="paragraph">
<p>If any destination element is saturated, the <code>vxsat</code> bit is set in the
<code>vxsat</code> register.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vector_floating_point_instructions">14. Vector Floating-Point Instructions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The standard vector floating-point instructions treat 16-bit, 32-bit,
64-bit, and 128-bit elements as IEEE-754/2008-compatible values.  If
the current SEW does not correspond to a supported IEEE floating-point
type, an illegal instruction exception is raised.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The floating-point element widths that are supported depend on
the platform.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Platforms supporting 16-bit half-precision floating-point values
will also have to implement scalar half-precision floating-point
support in the <code>f</code> registers.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The vector floating-point instructions have the same behavior as the
scalar floating-point instructions with regard to NaNs.</p>
</div>
<div class="paragraph">
<p>Scalar values for vector-scalar operations can be sourced from the
standard scalar <code>f</code> registers.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Scalar floating-point values will be sourced from the integer
<code>x</code> registers in the proposed Zfinx variant.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_vector_floating_point_exception_flags">14.1. Vector Floating-Point Exception Flags</h3>
<div class="paragraph">
<p>A vector floating-point exception at any active floating-point element
sets the standard FP exception flags in the <code>fflags</code> register.  Inactive
elements do not set FP exception flags.</p>
</div>
</div>
<div class="sect2">
<h3 id="_vector_single_width_floating_point_addsubtract_instructions">14.2. Vector Single-Width Floating-Point Add/Subtract Instructions</h3>
<div class="listingblock">
<div class="content">
<pre>    # Floating-point add
    vfadd.vv vd, vs2, vs1, vm   # Vector-vector
    vfadd.vf vd, vs2, rs1, vm   # vector-scalar

    # Floating-point subtract
    vfsub.vv vd, vs2, vs1, vm   # Vector-vector
    vfsub.vf vd, vs2, rs1, vm   # Vector-scalar vd[i] = vs2[i] - f[rs1]
    vfrsub.vf vd, vs2, rs1, vm  # Scalar-vector vd[i] = f[rs1] - vs2[i]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_widening_floating_point_addsubtract_instructions">14.3. Vector Widening Floating-Point Add/Subtract Instructions</h3>
<div class="listingblock">
<div class="content">
<pre># Widening FP add/subtract, 2*SEW = SEW +/- SEW
vfwadd.vv vd, vs2, vs1, vm  # vector-vector
vfwadd.vf vd, vs2, rs1, vm  # vector-scalar
vfwsub.vv vd, vs2, vs1, vm  # vector-vector
vfwsub.vf vd, vs2, rs1, vm  # vector-scalar

# Widening FP add/subtract, 2*SEW = 2*SEW +/- SEW
vfwadd.wv  vd, vs2, vs1, vm  # vector-vector
vfwadd.wf  vd, vs2, rs1, vm  # vector-scalar
vfwsub.wv  vd, vs2, vs1, vm  # vector-vector
vfwsub.wf  vd, vs2, rs1, vm  # vector-scalar</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_single_width_floating_point_multiplydivide_instructions">14.4. Vector Single-Width Floating-Point Multiply/Divide Instructions</h3>
<div class="listingblock">
<div class="content">
<pre>    # Floating-point multiply
    vfmul.vv vd, vs2, vs1, vm   # Vector-vector
    vfmul.vf vd, vs2, rs1, vm   # vector-scalar

    # Floating-point divide
    vfdiv.vv vd, vs2, vs1, vm   # Vector-vector
    vfdiv.vf vd, vs2, rs1, vm   # vector-scalar

    # Reverse floating-point divide vector = scalar / vector
    vfrdiv.vf vd, vs2, rs1, vm  # scalar-vector, vd[i] = f[rs1]/vs2[i]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_widening_floating_point_multiply">14.5. Vector Widening Floating-Point Multiply</h3>
<div class="listingblock">
<div class="content">
<pre># Widening floating-point multiply
vfwmul.vv    vd, vs2, vs1, vm # vector-vector
vfwmul.vf    vd, vs2, rs1, vm # vector-scalar</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_single_width_floating_point_fused_multiply_add_instructions">14.6. Vector Single-Width Floating-Point Fused Multiply-Add Instructions</h3>
<div class="paragraph">
<p>All four varieties of fused multiply-add are provided, and in two
destructive forms that overwrite one of the operands, either the
addend or the first multiplicand.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># FP multiply-accumulate, overwrites addend
vfmacc.vv vd, vs1, vs2, vm    # vd[i] = +(vs1[i] * vs2[i]) + vd[i]
vfmacc.vf vd, rs1, vs2, vm    # vd[i] = +(f[rs1] * vs2[i]) + vd[i]

# FP negate-(multiply-accumulate), overwrites subtrahend
vfnmacc.vv vd, vs1, vs2, vm   # vd[i] = -(vs1[i] * vs2[i]) - vd[i]
vfnmacc.vf vd, rs1, vs2, vm   # vd[i] = -(f[rs1] * vs2[i]) - vd[i]

# FP multiply-subtract-accumulator, overwrites subtrahend
vfmsac.vv vd, vs1, vs2, vm    # vd[i] = +(vs1[i] * vs2[i]) - vd[i]
vfmsac.vf vd, rs1, vs2, vm    # vd[i] = +(f[rs1] * vs2[i]) - vd[i]

# FP negate-(multiply-subtract-accumulator), overwrites minuend
vfnmsac.vv vd, vs1, vs2, vm   # vd[i] = -(vs1[i] * vs2[i]) + vd[i]
vfnmsac.vf vd, rs1, vs2, vm   # vd[i] = -(f[rs1] * vs2[i]) + vd[i]

# FP multiply-add, overwrites multiplicand
vfmadd.vv vd, vs1, vs2, vm    # vd[i] = +(vs1[i] * vd[i]) + vs2[i]
vfmadd.vf vd, rs1, vs2, vm    # vd[i] = +(f[rs1] * vd[i]) + vs2[i]

# FP negate-(multiply-add), overwrites multiplicand
vfnmadd.vv vd, vs1, vs2, vm   # vd[i] = -(vs1[i] * vd[i]) - vs2[i]
vfnmadd.vf vd, rs1, vs2, vm   # vd[i] = -(f[rs1] * vd[i]) - vs2[i]

# FP multiply-sub, overwrites multiplicand
vfmsub.vv vd, vs1, vs2, vm    # vd[i] = +(vs1[i] * vd[i]) - vs2[i]
vfmsub.vf vd, rs1, vs2, vm    # vd[i] = +(f[rs1] * vd[i]) - vs2[i]

# FP negate-(multiply-sub), overwrites multiplicand
vfnmsub.vv vd, vs1, vs2, vm   # vd[i] = -(vs1[i] * vd[i]) + vs2[i]
vfnmsub.vf vd, rs1, vs2, vm   # vd[i] = -(f[rs1] * vd[i]) + vs2[i]</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It would be possible to use the two unused rounding modes in the
scalar FP FMA encoding to provide a few non-destructive FMAs.
However, this would be the only maskable operation with three inputs
and separate output.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_widening_floating_point_fused_multiply_add_instructions">14.7. Vector Widening Floating-Point Fused Multiply-Add Instructions</h3>
<div class="paragraph">
<p>The widening floating-point fused multiply-add instructions all
overwrite the wide addend with the result.  The multiplier inputs are
all SEW wide, while the addend and destination is 2*SEW bits wide.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># FP widening multiply-accumulate, overwrites addend
vfwmacc.vv vd, vs1, vs2, vm    # vd[i] = +(vs1[i] * vs2[i]) + vd[i]
vfwmacc.vf vd, rs1, vs2, vm    # vd[i] = +(f[rs1] * vs2[i]) + vd[i]

# FP widening negate-(multiply-accumulate), overwrites addend
vfwnmacc.vv vd, vs1, vs2, vm   # vd[i] = -(vs1[i] * vs2[i]) - vd[i]
vfwnmacc.vf vd, rs1, vs2, vm   # vd[i] = -(f[rs1] * vs2[i]) - vd[i]

# FP widening multiply-subtract-accumulator, overwrites addend
vfwmsac.vv vd, vs1, vs2, vm    # vd[i] = +(vs1[i] * vs2[i]) - vd[i]
vfwmsac.vf vd, rs1, vs2, vm    # vd[i] = +(f[rs1] * vs2[i]) - vd[i]

# FP widening negate-(multiply-subtract-accumulator), overwrites addend
vfwnmsac.vv vd, vs1, vs2, vm   # vd[i] = -(vs1[i] * vs2[i]) + vd[i]
vfwnmsac.vf vd, rs1, vs2, vm   # vd[i] = -(f[rs1] * vs2[i]) + vd[i]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_floating_point_square_root_instruction">14.8. Vector Floating-Point Square-Root Instruction</h3>
<div class="paragraph">
<p>This is a unary vector-vector instruction.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    # Floating-point square root
    vfsqrt.v vd, vs2, vm   # Vector-vector square root</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_floating_point_minmax_instructions">14.9. Vector Floating-Point MIN/MAX Instructions</h3>
<div class="paragraph">
<p>The vector floating-point <code>vfmin</code> and <code>vfmax</code> instructions have the
same behavior as the corresponding scalar floating-point instructions
in version 2.2 of the RISC-V F/D/Q extension.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    # Floating-point minimum
    vfmin.vv vd, vs2, vs1, vm   # Vector-vector
    vfmin.vf vd, vs2, rs1, vm   # vector-scalar

    # Floating-point maximum
    vfmax.vv vd, vs2, vs1, vm   # Vector-vector
    vfmax.vf vd, vs2, rs1, vm   # vector-scalar</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_floating_point_sign_injection_instructions">14.10. Vector Floating-Point Sign-Injection Instructions</h3>
<div class="paragraph">
<p>Vector versions of the scalar sign-injection instructions.  The result
takes all bits except the sign bit from the vector <code>vs2</code> operands.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    vfsgnj.vv vd, vs2, vs1, vm   # Vector-vector
    vfsgnj.vf vd, vs2, rs1, vm   # vector-scalar

    vfsgnjn.vv vd, vs2, vs1, vm   # Vector-vector
    vfsgnjn.vf vd, vs2, rs1, vm   # vector-scalar

    vfsgnjx.vv vd, vs2, vs1, vm   # Vector-vector
    vfsgnjx.vf vd, vs2, rs1, vm   # vector-scalar</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_floating_point_compare_instructions">14.11. Vector Floating-Point Compare Instructions</h3>
<div class="paragraph">
<p>These vector FP compare instructions compare two source operands and
write the comparison result to a mask register.  The destination mask
vector is always held in a single vector register, with a layout of
elements as described in Section <a href="#sec-mask-register-layout">Mask Register Layout</a>.</p>
</div>
<div class="paragraph">
<p>The compare instructions follow the semantics of the scalar
floating-point compare instructions.  <code>vmfeq</code> and <code>vmfne</code> raise the invalid
operation exception only on signaling NaN inputs.  <code>vmflt</code>, <code>vmfle</code>, <code>vmfgt</code>,
and <code>vmfge</code> raise the invalid operation exception on both signaling and
quiet NaN inputs.</p>
</div>
<div class="paragraph">
<p>For all comparison instructions, an illegal instruction exception is raised if
the destination vector register overlaps a source vector register group and
LMUL &gt; 1.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    # Compare equal
    vmfeq.vv vd, vs2, vs1, vm  # Vector-vector
    vmfeq.vf vd, vs2, rs1, vm  # vector-scalar

    # Compare not equal
    vmfne.vv vd, vs2, vs1, vm  # Vector-vector
    vmfne.vf vd, vs2, rs1, vm  # vector-scalar

    # Compare less than
    vmflt.vv vd, vs2, vs1, vm  # Vector-vector
    vmflt.vf vd, vs2, rs1, vm  # vector-scalar

    # Compare less than or equal
    vmfle.vv vd, vs2, vs1, vm  # Vector-vector
    vmfle.vf vd, vs2, rs1, vm  # vector-scalar

    # Compare greater than
    vmfgt.vf vd, vs2, rs1, vm  # vector-scalar

    # Compare greater than or equal
    vmfge.vf vd, vs2, rs1, vm  # vector-scalar</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>Comparison      Assembler Mapping             Assembler pseudoinstruction

va &lt; vb         vmflt.vv vd, va, vb, vm
va &lt;= vb        vmfle.vv vd, va, vb, vm
va &gt; vb         vmflt.vv vd, vb, va, vm    vmfgt.vv vd, va, vb, vm
va &gt;= vb        vmfle.vv vd, vb, va, vm    vmfge.vv vd, va, vb, vm

va &lt; f          vmflt.vf vd, va, f, vm
va &lt;= f         vmfle.vf vd, va, f, vm
va &gt; f          vmfgt.vf vd, va, f, vm
va &gt;= f         vmfge.vf vd, va, f, vm

va, vb vector register groups
f      scalar floating-point register</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Providing all forms is necessary to correctly handle unordered
comparisons for NaNs.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
C99 floating-point quiet comparisons can be implemented by masking
the signaling comparisons when either input is NaN, as follows.  When
the comparand is a non-NaN constant, the middle two instructions can be
omitted.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>    # Example of implementing isgreater()
    vmfeq.vv v0, va, va        # Only set where A is not NaN.
    vmfeq.vv v1, vb, vb        # Only set where B is not NaN.
    vmand.mm v0, v0, v1        # Only set where A and B are ordered,
    vmfgt.vv v0, va, vb, v0.t  #  so only set flags on ordered values.</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In the above sequence, it is tempting to mask the second <code>vmfeq</code>
instruction and remove the <code>vmand</code> instruction, but this more efficient
sequence incorrectly fails to raise the invalid exception when an
element of <code>va</code> contains a quiet NaN and the corresponding element in
<code>vb</code> contains a signaling NaN.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_floating_point_classify_instruction">14.12. Vector Floating-Point Classify Instruction</h3>
<div class="paragraph">
<p>This is a unary vector-vector instruction that operates in the same
way as the scalar classify instruction.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    vfclass.v vd, vs2, vm   # Vector-vector</pre>
</div>
</div>
<div class="paragraph">
<p>The 10-bit mask produced by this instruction is placed in the
least-significant bits of the result elements.  The instruction is
only defined for SEW=16b and above, so the result will always fit in
the destination elements.</p>
</div>
</div>
<div class="sect2">
<h3 id="_vector_floating_point_merge_instruction">14.13. Vector Floating-Point Merge Instruction</h3>
<div class="paragraph">
<p>A vector-scalar floating-point merge instruction is provided, which
operates on all body elements, from <code>vstart</code> up to the current vector
length in <code>vl</code> regardless of mask value.</p>
</div>
<div class="paragraph">
<p>The <code>vfmerge.vfm</code> instruction is always masked (<code>vm=0</code>).
At elements where the mask value is zero, the first vector operand is
copied to the destination element, otherwise a scalar floating-point
register value is copied to the destination element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>vfmerge.vfm vd, vs2, rs1, v0  # vd[i] = v0[i].LSB ? f[rs1] : vs2[i]</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In Zfinx systems, the instruction is identical to <code>vmerge.vxm</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_floating_point_move_instruction">14.14. Vector Floating-Point Move Instruction</h3>
<div class="paragraph">
<p>The vector floating-point move instruction <em>splats</em> a floating-point scalar
operand to a vector register group.  The instruction copies a scalar <code>f</code>
register value to all active elements of a vector register group.  This
instruction is always unmasked (<code>vm=1</code>).  The instruction must have the <code>vs2</code>
field set to <code>v0</code>, with all other values for <code>vs2</code> reserved.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>vfmv.v.f vd, rs1  # vd[i] = f[rs1]</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In Zfinx systems, the instruction is identical to <code>vmv.v.x</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>vfmv.v.f</code> instruction shares the encoding with the <code>vfmerge.vfm</code>
instruction, but with <code>vm=1</code> and <code>vs2=v0</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_single_width_floating_pointinteger_type_convert_instructions">14.15. Single-Width Floating-Point/Integer Type-Convert Instructions</h3>
<div class="paragraph">
<p>Conversion operations are provided to convert to and from
floating-point values and unsigned and signed integers, where both
source and destination are SEW wide.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>vfcvt.xu.f.v vd, vs2, vm   # Convert float to unsigned integer.
vfcvt.x.f.v  vd, vs2, vm   # Convert float to signed integer.

vfcvt.f.xu.v vd, vs2, vm   # Convert unsigned integer to float.
vfcvt.f.x.v  vd, vs2, vm   # Convert signed integer to float.</pre>
</div>
</div>
<div class="paragraph">
<p>The conversions follow the same rules on exceptional conditions as the
scalar conversion instructions.  The conversions always use the
dynamic rounding mode in <code>frm</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_widening_floating_pointinteger_type_convert_instructions">14.16. Widening Floating-Point/Integer Type-Convert Instructions</h3>
<div class="paragraph">
<p>A set of conversion instructions are provided to convert between
narrower integer and floating-point datatypes to a type of twice the
width.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>vfwcvt.xu.f.v vd, vs2, vm   # Convert float to double-width unsigned integer.
vfwcvt.x.f.v  vd, vs2, vm   # Convert float to double-width signed integer.

vfwcvt.f.xu.v vd, vs2, vm   # Convert unsigned integer to double-width float.
vfwcvt.f.x.v  vd, vs2, vm   # Convert signed integer to double-width float.

vfwcvt.f.f.v vd, vs2, vm   # Convert single-width float to double-width float.</pre>
</div>
</div>
<div class="paragraph">
<p>These instructions have the same constraints on vector register overlap
as other widening instructions (see <a href="#sec-widening">Widening Vector Arithmetic Instructions</a>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A double-width IEEE floating-point value can always represent a
single-width integer exactly.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A double-width IEEE floating-point value can always represent a
single-width IEEE floating-point value exactly.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A full set of floating-point widening conversions are not
supported as single instructions, but any widening conversion can be
implemented as several doubling steps with equivalent results and no
additional exception flags raised.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_narrowing_floating_pointinteger_type_convert_instructions">14.17. Narrowing Floating-Point/Integer Type-Convert Instructions</h3>
<div class="paragraph">
<p>A set of conversion instructions are provided to convert wider integer
and floating-point datatypes to a type of half the width.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>vfncvt.xu.f.v vd, vs2, vm   # Convert double-width float to unsigned integer.
vfncvt.x.f.v  vd, vs2, vm   # Convert double-width float to signed integer.

vfncvt.f.xu.v vd, vs2, vm   # Convert double-width unsigned integer to float.
vfncvt.f.x.v  vd, vs2, vm   # Convert double-width signed integer to float.

vfncvt.f.f.v vd, vs2, vm   # Convert double-width float to single-width float.</pre>
</div>
</div>
<div class="paragraph">
<p>These instructions have the same constraints on vector register overlap
as other narrowing instructions (see <a href="#sec-narrowing">Narrowing Vector Arithmetic Instructions</a>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A full set of floating-point widening conversions are not
supported as single instructions. Conversions can be implemented in
several halving steps, with equivalently rounded results and with the
same exception flags raised (possibly raised redundantly in multiple
steps).
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
An integer value can be halved in width using the narrowing
integer shift instructions with a shift amount of 0.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vector_reduction_operations">15. Vector Reduction Operations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vector reduction operations take a vector register group of elements
and a scalar held in element 0 of a vector register, and perform a
reduction using some binary operator, to produce a scalar result in
element 0 of a vector register.  The scalar input and output operands
are held in element 0 of a single vector register, not a vector
register group, so any vector register can be the scalar source or
destination of a vector reduction regardless of LMUL setting.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Reductions read and write the scalar operand and result into
element 0 of a vector register to avoid a loss of decoupling with the
scalar processor, and to support future polymorphic use with future
types not supported in the scalar unit.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Inactive elements from the source vector register group are excluded
from the reduction, but the scalar operand is always included
regardless of mask.</p>
</div>
<div class="paragraph">
<p>The other elements in the destination vector register ( 0 &lt; index &lt;
VLEN/SEW) are left unchanged.</p>
</div>
<div class="paragraph">
<p>If <code>vl</code>=0, no operation is performed and the destination register is
not updated.</p>
</div>
<div class="paragraph">
<p>Traps on vector reduction instructions are always reported with a
<code>vstart</code> of 0.  Vector reduction operations raise an illegal
instruction exception if <code>vstart</code> is non-zero.</p>
</div>
<div class="paragraph">
<p>The assembler syntax for a reduction operation is <code>vredop.vs</code>, where
the <code>.vs</code> suffix denotes the first operand is a vector register group
and the second operand is a scalar stored in element 0 of a vector
register.</p>
</div>
<div class="sect2">
<h3 id="_vector_single_width_integer_reduction_instructions">15.1. Vector Single-Width Integer Reduction Instructions</h3>
<div class="paragraph">
<p>All operands and results of single-width reduction instructions have
the same SEW width.  Overflows wrap around on arithmetic sums.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    # Simple reductions, where [*] denotes all active elements:
    vredsum.vs  vd, vs2, vs1, vm   # vd[0] =  sum( vs1[0] , vs2[*] )
    vredmaxu.vs vd, vs2, vs1, vm   # vd[0] = maxu( vs1[0] , vs2[*] )
    vredmax.vs  vd, vs2, vs1, vm   # vd[0] =  max( vs1[0] , vs2[*] )
    vredminu.vs vd, vs2, vs1, vm   # vd[0] = minu( vs1[0] , vs2[*] )
    vredmin.vs  vd, vs2, vs1, vm   # vd[0] =  min( vs1[0] , vs2[*] )
    vredand.vs  vd, vs2, vs1, vm   # vd[0] =  and( vs1[0] , vs2[*] )
    vredor.vs   vd, vs2, vs1, vm   # vd[0] =   or( vs1[0] , vs2[*] )
    vredxor.vs  vd, vs2, vs1, vm   # vd[0] =  xor( vs1[0] , vs2[*] )</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_widening_integer_reduction_instructions">15.2. Vector Widening Integer Reduction Instructions</h3>
<div class="paragraph">
<p>The unsigned <code>vwredsumu.vs</code> instruction zero-extends the SEW-wide
vector elements before summing them, then adds the 2*SEW-width scalar
element, and stores the result in a 2*SEW-width scalar element.</p>
</div>
<div class="paragraph">
<p>The <code>vwredsum.vs</code> instruction sign-extends the SEW-wide vector
elements before summing them.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    # Unsigned sum reduction into double-width accumulator
    vwredsumu.vs vd, vs2, vs1, vm   # 2*SEW = 2*SEW + sum(zero-extend(SEW))

    # Signed sum reduction into double-width accumulator
    vwredsum.vs  vd, vs2, vs1, vm   # 2*SEW = 2*SEW + sum(sign-extend(SEW))</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_single_width_floating_point_reduction_instructions">15.3. Vector Single-Width Floating-Point Reduction Instructions</h3>
<div class="listingblock">
<div class="content">
<pre>    # Simple reductions.
    vfredosum.vs vd, vs2, vs1, vm # Ordered sum
    vfredsum.vs  vd, vs2, vs1, vm # Unordered sum
    vfredmax.vs  vd, vs2, vs1, vm # Maximum value
    vfredmin.vs  vd, vs2, vs1, vm # Minimum value</pre>
</div>
</div>
<div class="sect3">
<h4 id="_vector_ordered_single_width_floating_point_sum_reduction">15.3.1. Vector Ordered Single-Width Floating-Point Sum Reduction</h4>
<div class="paragraph">
<p>The <code>vfredosum</code> instruction must sum the floating-point values in
element order, starting with the scalar in <code>vs1[0]</code>--that is, it
performs the computation: <code>(((vs1[0] + vs2[0]) + vs2[1]) + &#8230;&#8203;)<br>
vs2[vl-1]</code>, where each addition operates identically to the scalar
floating-point instructions in terms of raising exception flags and
generating or propagating special values.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The ordered reduction supports compiler autovectorization, while
the unordered FP sum allows for faster implementations.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the operation is masked (<code>vm=0</code>), the masked-off elements do not
affect the result or the exception flags.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If no elements are active, no additions are performed, so the scalar in
<code>vs1[0]</code> is simply copied to the destination register, without canonicalizing
NaN values and without setting any exception flags.  This behavior preserves
the handling of NaNs, exceptions, and rounding when autovectorizing a scalar
summation loop.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_vector_unordered_single_width_floating_point_sum_reduction">15.3.2. Vector Unordered Single-Width Floating-Point Sum Reduction</h4>
<div class="paragraph">
<p>The unordered sum reduction instruction, <code>vfredsum</code>, provides an
implementation more freedom in performing the reduction.</p>
</div>
<div class="paragraph">
<p>The implementation can produce a result equivalent to a reduction tree
composed of binary operator nodes, with the inputs being elements from
the source vector register group (<code>vs2</code>) and the source scalar value
(<code>vs1[0]</code>).  Each operator in the tree accepts two inputs and produces
one result.  Each operator can either perform an exact addition, or a
floating-point addition according to the RISC-V IEEE scalar
floating-point specification and with the currently active
floating-point dynamic rounding mode.
A node where one input is derived only from elements masked-off or beyond the
active vector length may either treat that input as IEEE +0.0 of the
appropriate SEW or simply copy the other input to its output.  The root node in
the tree must produce an IEEE result of the appropriate SEW.  An implementation
is allowed to add an additional IEEE +0.0 to the final result.</p>
</div>
<div class="paragraph">
<p>The reduction tree structure must be deterministic for a given value
in <code>vtype</code> and <code>vl</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As a consequence of this definition, implementations need not propagate
NaN payloads through the reduction tree when no elements are active. In
particular, if no elements are active and the scalar input is NaN,
implementations are permitted to canonicalize the NaN and, if the NaN is
signaling, set the invalid exception flag.  Implementations are alternatively
permitted to pass through the original NaN and set no exception flags, as with
<code>vfredosum</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>vfredosum</code> instruction is a valid implementation of the
<code>vfredsum</code> instruction.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_vector_single_width_floating_max_and_min_reductions">15.3.3. Vector Single-Width Floating Max and Min Reductions</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Floating-point max and min reductions should return the same
final value and raise the same exception flags regardless of operation
order.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_widening_floating_point_reduction_instructions">15.4. Vector Widening Floating-Point Reduction Instructions</h3>
<div class="paragraph">
<p>Widening forms of the sum reductions are provided that
read and write a double-width reduction result.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> # Simple reductions.
 vfwredosum.vs vd, vs2, vs1, vm # Ordered sum
 vfwredsum.vs vd, vs2, vs1, vm  # Unordered sum</pre>
</div>
</div>
<div class="paragraph">
<p>The reduction of the SEW-width elements is performed as in the
single-width reduction case, with the elements in <code>vs2</code> promoted
to 2*SEW bits before adding to the 2*SEW-bit accumulator.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vector_mask_instructions">16. Vector Mask Instructions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Several instructions are provided to help operate on mask values held in
a vector register.</p>
</div>
<div class="sect2">
<h3 id="sec-mask-register-logical">16.1. Vector Mask-Register Logical Instructions</h3>
<div class="paragraph">
<p>Vector mask-register logical operations operate on mask registers.
The size of one element in a mask register is SEW/LMUL, so these
instructions all operate on single vector registers regardless of the
setting of the <code>vlmul</code> field in <code>vtype</code>.  They do not change the value
of <code>vlmul</code>.</p>
</div>
<div class="paragraph">
<p>As with other vector instructions, the elements with indices less than
<code>vstart</code> are unchanged, and <code>vstart</code> is reset to zero after execution.
Vector mask logical instructions are always unmasked so there are no
inactive elements.  Mask elements past <code>vl</code>, the tail elements, are
unchanged.</p>
</div>
<div class="paragraph">
<p>Within a mask element, these instructions perform their operations
using only the least-significant bit of each operand and zero-extend
the single-bit result to fill the destination mask element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    vmand.mm vd, vs2, vs1     # vd[i] =   vs2[i].LSB &amp;&amp;  vs1[i].LSB
    vmnand.mm vd, vs2, vs1    # vd[i] = !(vs2[i].LSB &amp;&amp;  vs1[i].LSB)
    vmandnot.mm vd, vs2, vs1  # vd[i] =   vs2[i].LSB &amp;&amp; !vs1[i].LSB
    vmxor.mm  vd, vs2, vs1    # vd[i] =   vs2[i].LSB ^^  vs1[i].LSB
    vmor.mm  vd, vs2, vs1     # vd[i] =   vs2[i].LSB ||  vs1[i].LSB
    vmnor.mm  vd, vs2, vs1    # vd[i] = !(vs2[i[.LSB ||  vs1[i].LSB)
    vmornot.mm  vd, vs2, vs1  # vd[i] =   vs2[i].LSB || !vs1[i].LSB
    vmxnor.mm vd, vs2, vs1    # vd[i] = !(vs2[i].LSB ^^  vs1[i].LSB)</pre>
</div>
</div>
<div class="paragraph">
<p>Several assembler pseudoinstructions are defined as shorthand for
common uses of mask logical operations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    vmcpy.m vd, vs  =&gt; vmand.mm vd, vs, vs  # Copy mask register
    vmclr.m vd     =&gt; vmxor.mm vd, vd, vd   # Clear mask register
    vmset.m vd     =&gt; vmxnor.mm vd, vd, vd  # Set mask register
    vmnot.m vd, vs =&gt; vmnand.mm vd, vs, vs  # Invert bits</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The vmcpy.m instruction is not called vmmv as elsewhere in the
architecture mv implies a bitwise copy without interpreting the bits.
The vmcpy.m instruction will clear upper bits of the destination mask
register to zero regardless of source values in these bits.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The set of eight mask logical instructions can generate any of the 16
possibly binary logical functions of the two input masks:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="4">inputs</th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">src2</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 37.5%;">
<col style="width: 37.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="4">output</th>
<th class="tableblock halign-left valign-top">instruction</th>
<th class="tableblock halign-left valign-top">pseudoinstruction</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmxor.mm vd, vd, vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmclr.m vd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmnor.mm vd, src1, src2</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmandnot.mm vd, src2, src1</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmnand.mm vd, src1, src1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmnot.m vd, src1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmandnot.mm vd, src1, src2</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmnand.mm vd, src2, src2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmnot.m vd, src2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmxor.mm vd, src1, src2</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmnand.mm vd, src1, src2</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmand.mm vd, src1, src2</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmxnor.mm vd, src1, src2</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmand.mm vd, src2, src2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmcpy.m vd, src2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmornot.mm vd, src2, src1</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmand.mm vd, src1, src1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmcpy.m vd, src1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmornot.mm vd, src1, src2</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmxnor.mm vd, vd, vd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmset.m vd</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The vector mask logical instructions are designed to be easily
fused with a following masked vector operation to effectively expand
the number of predicate registers by moving values into <code>v0</code> before
use.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_mask_population_count_vpopc">16.2. Vector mask population count <code>vpopc</code></h3>
<div class="listingblock">
<div class="content">
<pre>    vpopc.m rd, vs2, vm</pre>
</div>
</div>
<div class="paragraph">
<p>The source operand is a single vector register holding mask register
values as described in Section <a href="#sec-mask-register-layout">Mask Register Layout</a>.</p>
</div>
<div class="paragraph">
<p>The <code>vpopc.m</code> instruction counts the number of mask elements of the
active elements of the vector source mask register that have their
least-significant bit set, and writes the result to a scalar <code>x</code>
register.</p>
</div>
<div class="paragraph">
<p>The operation can be performed under a mask, in which case only the
masked elements are counted.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> vpopc.m rd, vs2, v0.t # x[rd] = sum_i ( vs2[i].LSB &amp;&amp; v0[i].LSB )</pre>
</div>
</div>
<div class="paragraph">
<p>Traps on <code>vpopc.m</code> are always reported with a <code>vstart</code> of 0.  The
<code>vpopc</code> instruction will raise an illegal instruction exception if
<code>vstart</code> is non-zero.</p>
</div>
</div>
<div class="sect2">
<h3 id="_vfirst_find_first_set_mask_bit">16.3. <code>vfirst</code> find-first-set mask bit</h3>
<div class="listingblock">
<div class="content">
<pre>    vfirst.m rd, vs2, vm</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>vfirst</code> instruction finds the lowest-numbered active element of
the source mask vector that has its LSB set and writes that element&#8217;s
index to a GPR.  If no element has an LSB set, -1 is written to the
GPR.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Software can assume that any negative value (highest bit set)
corresponds to no element found, as vector lengths will never exceed
2<sup>31</sup> on any implementation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Traps on <code>vfirst</code> are always reported with a <code>vstart</code> of 0.  The
<code>vfirst</code> instruction will raise an illegal instruction exception if
<code>vstart</code> is non-zero.</p>
</div>
</div>
<div class="sect2">
<h3 id="_vmsbf_m_set_before_first_mask_bit">16.4. <code>vmsbf.m</code> set-before-first mask bit</h3>
<div class="listingblock">
<div class="content">
<pre>    vmsbf.m vd, vs2, vm

 # Example

     7 6 5 4 3 2 1 0   Element number

     1 0 0 1 0 1 0 0   v3 contents
                       vmsbf.m v2, v3
     0 0 0 0 0 0 1 1   v2 contents

     1 0 0 1 0 1 0 1   v3 contents
                       vmsbf.m v2, v3
     0 0 0 0 0 0 0 0   v2

     0 0 0 0 0 0 0 0   v3 contents
                       vmsbf.m v2, v3
     1 1 1 1 1 1 1 1   v2

     1 1 0 0 0 0 1 1   v0 vcontents
     1 0 0 1 0 1 0 0   v3 contents
                       vmsbf.m v2, v3, v0.t
     0 1 x x x x 1 1   v2 contents</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>vmsbf.m</code> instruction takes a mask register as input and writes
results to a mask register.  The instruction writes a 1 to all active
mask elements before the first source element that has a set LSB, then
writes a zero to that element and all following active elements.  If
there is no set bit in the source vector, then all active elements in
the destination are written with a 1.</p>
</div>
<div class="paragraph">
<p>The tail elements in the destination mask register are unchanged.</p>
</div>
<div class="paragraph">
<p>Traps on <code>vmsbf.m</code> are always reported with a <code>vstart</code> of 0.  The
<code>vmsbf</code> instruction will raise an illegal instruction exception if
<code>vstart</code> is non-zero.</p>
</div>
</div>
<div class="sect2">
<h3 id="_vmsif_m_set_including_first_mask_bit">16.5. <code>vmsif.m</code> set-including-first mask bit</h3>
<div class="paragraph">
<p>The vector mask set-including-first instruction is similar to
set-before-first, except it also includes the element with a set bit.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    vmsif.m vd, vs2, vm

 # Example

     7 6 5 4 3 2 1 0   Element number

     1 0 0 1 0 1 0 0   v3 contents
                       vmsif.m v2, v3
     0 0 0 0 0 1 1 1   v2 contents

     1 0 0 1 0 1 0 1   v3 contents
                       vmsif.m v2, v3
     0 0 0 0 0 0 0 1   v2

     1 1 0 0 0 0 1 1   v0 vcontents
     1 0 0 1 0 1 0 0   v3 contents
                       vmsif.m v2, v3, v0.t
     1 1 x x x x 1 1   v2 contents</pre>
</div>
</div>
<div class="paragraph">
<p>The tail elements in the destination mask register are unchanged.</p>
</div>
<div class="paragraph">
<p>Traps on <code>vmsif.m</code> are always reported with a <code>vstart</code> of 0.  The
<code>vmsif</code> instruction will raise an illegal instruction exception if
<code>vstart</code> is non-zero.</p>
</div>
</div>
<div class="sect2">
<h3 id="_vmsof_m_set_only_first_mask_bit">16.6. <code>vmsof.m</code> set-only-first mask bit</h3>
<div class="paragraph">
<p>The vector mask set-only-first instruction is similar to
set-before-first, except it only sets the first element with a bit
set, if any.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    vmsof.m vd, vs2, vm

 # Example

     7 6 5 4 3 2 1 0   Element number

     1 0 0 1 0 1 0 0   v3 contents
                       vmsof.m v2, v3
     0 0 0 0 0 1 0 0   v2 contents

     1 0 0 1 0 1 0 1   v3 contents
                       vmsof.m v2, v3
     0 0 0 0 0 0 0 1   v2

     1 1 0 0 0 0 1 1   v0 vcontents
     1 1 0 1 0 1 0 0   v3 contents
                       vmsof.m v2, v3, v0.t
     0 1 x x x x 0 0   v2 contents</pre>
</div>
</div>
<div class="paragraph">
<p>The tail elements in the destination mask register are unchanged.</p>
</div>
<div class="paragraph">
<p>Traps on <code>vmsof.m</code> are always reported with a <code>vstart</code> of 0.  The
<code>vmsof</code> instruction will raise an illegal instruction exception if
<code>vstart</code> is non-zero.</p>
</div>
</div>
<div class="sect2">
<h3 id="_example_using_vector_mask_instructions">16.7. Example using vector mask instructions</h3>
<div class="paragraph">
<p>The following is an example of vectorizing a data-dependent exit loop.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  # char* strcpy(char *dst, const char* src)
strcpy:
      mv a2, a0             # Copy dst
      li t0, -1             # Infinite AVL
loop:
    vsetvli x0, t0, e8      # Max length vectors of bytes
    vlbuff.v v1, (a1)       # Get src bytes
      csrr t1, vl           # Get number of bytes fetched
    vmseq.vi v0, v1, 0      # Flag zero bytes
    vfirst.m a3, v0         # Zero found?
      add a1, a1, t1        # Bump pointer
    vmsif.m v0, v0          # Set mask up to and including zero byte.
    vsb.v v1, (a2), v0.t    # Write out bytes
      add a2, a2, t1        # Bump pointer
      bltz a3, loop         # Zero byte not found, so loop

      ret

  # char* strncpy(char *dst, const char* src, size_t n)
strncpy:
      mv a3, a0             # Copy dst
loop:
    vsetvli x0, a2, e8   # Vectors of bytes.
    vlbuff.v v1, (a1)       # Get src bytes
    vmseq.vi v0, v1, 0      # Flag zero bytes
    vfirst.m a4, v0         # Zero found?
    vmsif.m v0, v0          # Set mask up to and including zero byte.
    vsb.v v1, (a3), v0.t    # Write out bytes
      csrr t1, vl           # Get number of bytes fetched
      sub a2, a2, t1        # Decrement count.
      bgez a4, zero_tail    # Zero remaining bytes.
      add a1, a1, t1        # Bump pointer
      add a3, a3, t1        # Bump pointer
      bnez a2, loop         # Anymore?

      ret

zero_tail:
    vsetvli x0, a2, e8,m8   # Vectors of bytes.
    vmv.v.i v0, 0           # Splat zero.

zero_loop:
    vsetvli t1, a2, e8,m8   # Vectors of bytes.
    vsb.v v0, (a3)          # Store zero.
      sub a2, a2, t1        # Decrement count.
      add a3, a3, t1        # Bump pointer
      bnez a2, zero_loop    # Anymore?

      ret</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_iota_instruction">16.8. Vector Iota Instruction</h3>
<div class="paragraph">
<p>The <code>viota.m</code> instruction reads a source vector mask register and
writes to each element of the destination vector register group the
sum of all the least-significant bits of elements in the mask register
whose index is less than the element, e.g., a parallel prefix sum of
the mask values.</p>
</div>
<div class="paragraph">
<p>This instruction can be masked, in which case only the enabled
elements contribute to the sum and only the enabled elements are
written.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> viota.m vd, vs2, vm

 # Example

     7 6 5 4 3 2 1 0   Element number

     1 0 0 1 0 0 0 1   v2 contents
                       viota.m v4, v2 # Unmasked
     2 2 2 1 1 1 1 0   v4 result

     1 1 1 0 1 0 1 1   v0 contents
     1 0 0 1 0 0 0 1   v2 contents
     2 3 4 5 6 7 8 9   v4 contents
                       viota.m v4, v2, v0.t # Masked
     1 1 1 5 1 7 1 0   v4 results</pre>
</div>
</div>
<div class="paragraph">
<p>The result value is zero-extended to fill the destination element if
SEW is wider than the result.  If the result value would overflow the
destination SEW, the least-significant SEW bits are retained.</p>
</div>
<div class="paragraph">
<p>Traps on <code>viota.m</code> are always reported with a <code>vstart</code> of 0, and
execution is always restarted from the beginning when resuming after a
trap handler.  An illegal instruction exception is raised if <code>vstart</code>
is non-zero.</p>
</div>
<div class="paragraph">
<p>An illegal instruction exception is raised if the destination vector
register group overlaps the source vector mask register.  If the
instruction is masked, an illegal instruction exception is issued if
the destination vector register group overlaps <code>v0</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
These constraints exist for two reasons.  First, to simplify
avoidance of WAR hazards in implementations with temporally long vector
registers and no vector register renaming.  Second, to enable resuming
execution after a trap simpler.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>viota.m</code> instruction can be combined with memory scatter
instructions (indexed stores) to perform vector compress functions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    # Compact non-zero elements from input memory array to output memory array
    #
    # size_t compact_non_zero(size_t n, const int* in, int* out)
    # {
    #   size_t i;
    #   size_t count = 0;
    #   int *p = out;
    #
    #   for (i=0; i&lt;n; i++)
    #   {
    #       const int v = *in++;
    #       if (v != 0)
    #           *p++ = v;
    #   }
    #
    #   return (size_t) (p - out);
    # }
    #
    # a0 = n
    # a1 = &amp;in
    # a2 = &amp;out

compact_non_zero:
    li a6, 0                      # Clear count of non-zero elements
loop:
    vsetvli a5, a0, e32,m8  # 32-bit integers
    vlw.v v8, (a1)                # Load input vector
      sub a0, a0, a5              # Decrement number done
      slli a5, a5, 2              # Multiply by four bytes
    vmsne.vi v0, v8, 0            # Locate non-zero values
      add a1, a1, a5              # Bump input pointer
    vpopc.m a5, v0                # Count number of elements set in v0
    viota.m v16, v0               # Get destination offsets of active elements
      add a6, a6, a5              # Accumulate number of elements
    vsll.vi v16, v16, 2, v0.t     # Multiply offsets by four bytes
      slli a5, a5, 2              # Multiply number of non-zero elements by four bytes
    vsuxw.v v8, (a2), v16, v0.t   # Scatter using scaled viota results under mask
      add a2, a2, a5              # Bump output pointer
      bnez a0, loop               # Any more?

      mv a0, a6                   # Return count
      ret</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_element_index_instruction">16.9. Vector Element Index Instruction</h3>
<div class="paragraph">
<p>The <code>vid.v</code> instruction writes each element&#8217;s index to the
destination vector register group, from 0 to <code>vl</code>-1.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    vid.v vd, vm  # Write element ID to destination.</pre>
</div>
</div>
<div class="paragraph">
<p>The instruction can be masked.</p>
</div>
<div class="paragraph">
<p>The <code>vs2</code> field of the instruction must be set to <code>v0</code>, otherwise the
encoding is <em>reserved</em>.</p>
</div>
<div class="paragraph">
<p>The result value is zero-extended to fill the destination element if
SEW is wider than the result.  If the result value would overflow the
destination SEW, the least-significant SEW bits are retained.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This constraint is to avoid WAR hazards in long vector
implementations without register renaming, and to support restart.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Microarchitectures can implement <code>vid.v</code> instruction using the
same datapath as <code>viota.m</code> but with an implicit set mask source.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vector_permutation_instructions">17. Vector Permutation Instructions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A range of permutation instructions are provided to move elements
around within the vector registers.</p>
</div>
<div class="sect2">
<h3 id="_integer_scalar_move_instructions">17.1. Integer Scalar Move Instructions</h3>
<div class="paragraph">
<p>The integer scalar read/write instructions transfer a single
value between a scalar <code>x</code> register and element 0 of a vector
register.  The instructions ignore LMUL and vector register groups.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>vmv.x.s rd, vs2  # rd = vs2[0] (rs1=0)
vmv.s.x vd, rs1  # vd[0] = rs1 (vs2=0)</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>vmv.x.s</code> instruction copies a single SEW-wide element from index 0 of the
source vector register to a destination integer register.  If SEW &gt; XLEN, the
least-significant XLEN bits are transferred and the upper SEW-XLEN bits are
ignored.  If SEW &lt; XLEN, the value is sign-extended to XLEN bits.</p>
</div>
<div class="paragraph">
<p>The <code>vmv.s.x</code> instruction copies the scalar integer register to element 0 of
the destination vector register.  If SEW &lt; XLEN, the least-significant bits
are copied and the upper XLEN-SEW bits are ignored.  If SEW &gt; XLEN, the value
is sign-extended to SEW bits.  The other elements in the destination vector
register ( 0 &lt; index &lt; VLEN/SEW) are unchanged.  If <code>vstart</code> &#8805; <code>vl</code>, no
operation is performed and the destination register is not updated.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As a consequence, when <code>vl</code>=0, no elements are updated in the
destination vector register group, regardless of <code>vstart</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The encodings corresponding to the masked versions (vm=0) of <code>vmv.x.s</code>
and <code>vmv.s.x</code> are reserved.</p>
</div>
</div>
<div class="sect2">
<h3 id="_floating_point_scalar_move_instructions">17.2. Floating-Point Scalar Move Instructions</h3>
<div class="paragraph">
<p>The floating-point scalar read/write instructions transfer a single
value between a scalar <code>f</code> register and element 0 of a vector
register.  The instructions ignore LMUL and vector register groups.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>vfmv.f.s rd, vs2  # rd = vs2[0] (rs1=0)
vfmv.s.f vd, rs1  # vd[0] = rs1 (vs2=0)</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>vfmv.f.s</code> instruction copies a single SEW-wide element from index
0 of the source vector register to a destination scalar floating-point
register.  If SEW &gt; FLEN, the least-significant FLEN bits are
transferred and the upper SEW-FLEN bits are ignored.  If SEW &lt; FLEN,
the value is NaN-boxed (1-extended) to FLEN bits.</p>
</div>
<div class="paragraph">
<p>The <code>vfmv.s.f</code> instruction copies the scalar register to element 0 of
the destination vector register.  If SEW &lt; FLEN, the least-significant
bits are copied and the upper FLEN-SEW bits are ignored.  If SEW &gt;
FLEN, the value is NaN-boxed (1-extended) to SEW bits.  The other
elements in the destination vector register ( 0 &lt; index &lt; VLEN/SEW)
are unchanged.  If <code>vstart</code> &#8805; <code>vl</code>, no operation is performed and
the destination register is not updated.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As a consequence, when <code>vl</code>=0, no elements are updated in the
destination vector register group, regardless of <code>vstart</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The encodings corresponding to the masked versions (vm=0) of <code>vfmv.f.s</code>
and <code>vfmv.s.f</code> are reserved.</p>
</div>
</div>
<div class="sect2">
<h3 id="_vector_slide_instructions">17.3. Vector Slide Instructions</h3>
<div class="paragraph">
<p>The slide instructions move elements up and down a vector register
group.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The slide operations can be implemented much more efficiently
than using the arbitrary register gather instruction.  Implementations
may optimize certain OFFSET values for <code>vslideup</code> and <code>vslidedown</code>.
In particular, power-of-2 offsets may operate substantially faster
than other offsets.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For all of the <code>vslideup</code>, <code>vslidedown</code>, <code>vslide1up</code>, and
<code>vslide1down</code> instructions, if <code>vstart</code> &#8805; <code>vl</code>, the instruction performs no
operation and leaves the destination vector register unchanged.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As a consequence, when <code>vl</code>=0, no elements are updated in the
destination vector register group, regardless of <code>vstart</code>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_vector_slideup_instructions">17.3.1. Vector Slideup Instructions</h4>
<div class="listingblock">
<div class="content">
<pre> vslideup.vx vd, vs2, rs1, vm        # vd[i+rs1] = vs2[i]
 vslideup.vi vd, vs2, uimm[4:0], vm  # vd[i+uimm] = vs2[i]</pre>
</div>
</div>
<div class="paragraph">
<p>For <code>vslideup</code>, the value in <code>vl</code> specifies the number of destination
elements that are written.  The start index (<em>OFFSET</em>) for the
destination can be either specified using an unsigned integer in the
<code>x</code> register specified by <code>rs1</code>, or a 5-bit immediate treated as an
unsigned 5-bit quantity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>   vslideup behavior for destination elements

   OFFSET is amount to slideup, either from x register or a 5-bit immediate

                    0 &lt;  i &lt; max(vstart, OFFSET)  Unchanged
  max(vstart, OFFSET) &lt;= i &lt; vl                   vd[i] = vs2[i-OFFSET] if mask enabled,
                                                   unchanged if not
                   vl &lt;= i &lt; VLMAX                Tail elements, unchanged</pre>
</div>
</div>
<div class="paragraph">
<p>The destination vector register group for <code>vslideup</code> cannot overlap
the vector register group of the source, otherwise an illegal
instruction exception is raised.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The non-overlap constraint avoids WAR hazards on the
input vectors during execution, and enables restart with non-zero
<code>vstart</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_vector_slidedown_instructions">17.3.2. Vector Slidedown Instructions</h4>
<div class="listingblock">
<div class="content">
<pre> vslidedown.vx vd, vs2, rs1, vm       # vd[i] = vs2[i+rs1]
 vslidedown.vi vd, vs2, uimm[4:0], vm # vd[i] = vs2[i+uimm]</pre>
</div>
</div>
<div class="paragraph">
<p>For <code>vslidedown</code>, the value in <code>vl</code> specifies the number of
destination elements that are written.</p>
</div>
<div class="paragraph">
<p>The start index (<em>OFFSET</em>) for the source can be either specified
using an unsigned integer in the <code>x</code> register specified by <code>rs1</code>, or a
5-bit immediate treated as an unsigned 5-bit quantity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    vslidedown behavior for source elements for element i in slide
                     0 &lt;= i+OFFSET &lt; VLMAX   Read vs2[i+offset]
                 VLMAX &lt;= i+OFFSET           Read as 0

    vslidedown behavior for destination element i in slide
                     0 &lt;  i &lt; vstart         Unchanged
                vstart &lt;= i &lt; vl             Updated if mask enabled, unchanged if not
                    vl &lt;= i &lt; VLMAX          Unchanged</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vector_slide1up">17.3.3. Vector Slide1up</h4>
<div class="paragraph">
<p>Variants of slide are provided that only move by one element but which
also allow a scalar integer value to be inserted at the vacated
element position.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> vslide1up.vx vd, vs2, rs1, vm        # vd[0]=x[rs1], vd[i+1] = vs2[i]</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>vslide1up</code> instruction places the <code>x</code> register argument at
location 0 of the destination vector register group, provided that
element 0 is active, otherwise the destination element is unchanged.
If XLEN &lt; SEW, the value is zero-extended to SEW bits.  If XLEN &gt; SEW,
the least-significant bits are copied over and the high SEW-XLEN bits
are ignored.</p>
</div>
<div class="paragraph">
<p>The remaining active <code>vl</code>-1 elements are copied over from index <em>i</em> in
the source vector register group to index <em>i</em>+1 in the destination
vector register group.</p>
</div>
<div class="paragraph">
<p>The <code>vl</code> register specifies how many of the destination vector
register elements are written with source values, and all tail
elements are unchanged.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>   vslide1up behavior

                    i &lt; vstart  unchanged
                0 = i = vstart  vd[i] = x[rs1] if mask enabled, unchanged if not
  max(vstart, 1) &lt;= i &lt; vl      vd[i] = vs2[i-1] if mask enabled, unchanged if not
              vl &lt;= i &lt; VLMAX   unchanged</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>vslide1up</code> instruction requires that the destination vector
register group does not overlap the source vector register group.
Otherwise, an illegal instruction exception is raised.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vector_slide1down_instruction">17.3.4. Vector Slide1down Instruction</h4>
<div class="paragraph">
<p>The <code>vslide1down</code> instruction copies the first <code>vl</code>-1 active elements
values from index <em>i</em>+1 in the source vector register group to index
<em>i</em> in the destination vector register group.</p>
</div>
<div class="paragraph">
<p>The <code>vl</code> register specifies how many of the destination vector
register elements are written with source values, and all tail
elements are unchanged.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> vslide1down.vx vd, vs2, rs1, vm      # vd[i] = vs2[i+1], vd[vl-1]=x[rs1]</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>vslide1down</code> instruction places the <code>x</code> register argument at
location <code>vl</code>-1 in the destination vector register, provided that
element <code>vl-1</code> is active, otherwise the destination element is
unchanged. If XLEN &lt; SEW, the value is zero-extended to SEW bits.  If
XLEN &gt; SEW, the least-significant bits are copied over and the high
SEW-XLEN bits are ignored.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>   vslide1down behavior

                       i &lt; vstart  unchanged
             vstart &lt;= i &lt; vl-1    vd[i] = vs2[i+1] if mask enabled, unchanged if not
             vstart &lt;= i = vl-1    vd[vl-1] = x[rs1] if mask enabled, unchanged if not
                 vl &lt;= i &lt; VLMAX   unchanged</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>vslide1down</code> instruction can be used to load values into a
vector register without using memory and without disturbing other
vector registers.  This provides a path for debuggers to modify the
contents of a vector register, albeit slowly, with multiple repeated
<code>vslide1down</code> invocations.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_register_gather_instruction">17.4. Vector Register Gather Instruction</h3>
<div class="paragraph">
<p>The vector register gather instruction reads elements from a first
source vector register group at locations given by a second source
vector register group.  The index values in the second vector are
treated as unsigned integers.  The source vector can be read at any
index &lt; VLMAX regardless of <code>vl</code>.  The number of elements to write to
the destination register is given by <code>vl</code>, and elements past <code>vl</code> in
the destination are unchanged.  The operation can be masked.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>vrgather.vv vd, vs2, vs1, vm # vd[i] = (vs1[i] &gt;= VLMAX) ? 0 : vs2[vs1[i]];</pre>
</div>
</div>
<div class="paragraph">
<p>If the element indices are out of range ( <code>vs1[i]</code> &#8805; VLMAX )
then zero is returned for the element value.</p>
</div>
<div class="paragraph">
<p>Vector-scalar and vector-immediate forms of the register gather are
also provided.  These read one element from the source vector at the
given index, and write this value to the <code>vl</code> elements at the start of
the destination vector register. The index value in the scalar register
and the immediate are treated as unsigned integers.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
These forms allow any vector element to be "splatted" to an entire vector.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>vrgather.vx vd, vs2, rs1, vm # vd[i] = (x[rs1] &gt;= VLMAX) ? 0 : vs2[rs1]
vrgather.vi vd, vs2, uimm, vm # vd[i] = (uimm &gt;= VLMAX) ? 0 : vs2[uimm]</pre>
</div>
</div>
<div class="paragraph">
<p>For any <code>vrgather</code> instruction, the destination vector register group
cannot overlap with the source vector register groups, including the
mask register if the operation is masked, otherwise an illegal
instruction exception is raised.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When SEW=8, only vector elements 0-255 can be referenced.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vector_compress_instruction">17.5. Vector Compress Instruction</h3>
<div class="paragraph">
<p>The vector compress instruction allows elements selected by a vector
mask register from a source vector register group to be packed into
contiguous elements at the start of the destination vector register
group.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  vcompress.vm vd, vs2, vs1  # Compress into vd elements of vs2 where vs1 is enabled</pre>
</div>
</div>
<div class="paragraph">
<p>The vector mask register specified by <code>vs1</code> indicates which of the
first <code>vl</code> elements of vector register group <code>vs2</code> should be extracted
and packed into contiguous elements at the beginning of vector
register <code>vd</code>. Any remaining elements of <code>vd</code> are unchanged.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    Example use of vcompress instruction

        1 1 0 1 0 0 1 0 1   v0
        8 7 6 5 4 3 2 1 0   v1
                                vcompress.vm v2, v1, v0
        0 0 0 0 8 7 5 2 0   v2</pre>
</div>
</div>
<div class="paragraph">
<p>The destination vector register group cannot overlap the source vector
register group or the source vector mask register, otherwise an
illegal instruction exception is raised.</p>
</div>
<div class="paragraph">
<p>A trap on a <code>vcompress</code> instruction is always reported with a
<code>vstart</code> of 0.  Executing a <code>vcompress</code> instruction with a non-zero
<code>vstart</code> raises an illegal instruction exception.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Although possible, <code>vcompress</code> is one of the more difficult
instructions to restart with a non-zero <code>vstart</code>, so assumption is
implementations will choose not do that but will instead restart from
element 0.  This does mean elements in destination register after
<code>vstart</code> will already have been updated.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exception_handling">18. Exception Handling</h2>
<div class="sectionbody">
<div class="paragraph">
<p>On a trap during a vector instruction (caused by either a synchronous
exception or an asynchronous interrupt), the existing <code>*epc</code> CSR is
written with a pointer to the errant vector instruction, while the
<code>vstart</code> CSR contains the element index that caused the trap to be
taken.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
We chose to add a <code>vstart</code> CSR to allow resumption of a
partially executed vector instruction to reduce interrupt latencies
and to simplify forward-progress guarantees.  This is similar to the
scheme in the IBM 3090 vector facility.  To ensure forward progress
without the <code>vstart</code> CSR, implementations would have to guarantee an
entire vector instruction can always complete atomically without
generating a trap.  This is particularly difficult to ensure in the
presence of strided or scatter/gather operations and demand-paged
virtual memory.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_precise_vector_traps">18.1. Precise vector traps</h3>
<div class="paragraph">
<p>Precise vector traps require that:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>all instructions older than the trapping vector instruction have committed their results</p>
</li>
<li>
<p>no instructions newer than the trapping vector instruction have altered architectural state</p>
</li>
<li>
<p>any operations within the trapping vector instruction affecting result elements preceding the index in the <code>vstart</code> CSR have committed their results</p>
</li>
<li>
<p>no operations within the trapping vector instruction affecting elements at or following the <code>vstart</code> CSR have altered architectural state except if restarting and completing the affected vector instruction will recover the correct state.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We relax the last requirement to allow elements following <code>vstart</code> to
have been updated at the time the trap is reported, provided that
re-executing the instruction from the given <code>vstart</code> will correctly
overwrite those elements.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
We assume most supervisor-mode environments will require precise
vector traps.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Except where noted above, vector instructions are allowed to overwrite
their inputs, and so in most cases, the vector instruction restart
must be from the <code>vstart</code> location. However, there are a number of
cases where this overwrite is prohibited to enable execution of the
the vector instructions to be idempotent and hence restartable from
any location.</p>
</div>
</div>
<div class="sect2">
<h3 id="_imprecise_vector_traps">18.2. Imprecise vector traps</h3>
<div class="paragraph">
<p>Imprecise vector traps are traps that are not precise.  In particular,
instructions newer than <code>*epc</code> may have committed results, and
instructions older than <code>*epc</code> may have not completed execution.
Imprecise traps are primarily intended to be used in situations where
reporting an error and terminating execution is the appropriate
response.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A platform might specify that interrupts are precise while other
traps are imprecise.  We assume many embedded platforms will only
generate imprecise traps for vector instructions on fatal errors, so
do not require resumable traps.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_selectable_preciseimprecise_traps">18.3. Selectable precise/imprecise traps</h3>
<div class="paragraph">
<p>Some platforms may choose to provide a privileged mode bit to select
between precise and imprecise vector traps.  Imprecise mode would run
at high-performance but possibly make it difficult to discern error
causes, while precise mode would run more slowly, but support
debugging of errors albeit with a possibility of not experiencing the
same errors as in imprecise mode.</p>
</div>
</div>
<div class="sect2">
<h3 id="_swappable_traps">18.4. Swappable traps</h3>
<div class="paragraph">
<p>Another trap mode can support swappable state in the vector unit,
where on a trap, special instructions can save and restore the vector
unit microarchitectural state, to allow execution to continue
correctly around imprecise traps.</p>
</div>
<div class="paragraph">
<p>This mechanism is not defined in the base vector ISA.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_divided_element_extension_zvediv">19. Divided Element Extension ('Zvediv')</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
EDIV is the mostly likely part of the spec to change
substantially.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The divided element extension allows each element to be treated as a
packed sub-vector of narrower elements. This provides efficient
support for some forms of narrow-width and mixed-width arithmetic, and
also to allow outer-loop vectorization of short vector and matrix
operations.  In addition to modifying the behavior of some existing
instructions, a few new instructions are provided to operate on
vectors when EDIV &gt; 1.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This is written as an extension for now, but could become
part of mandatory base in Unix vector profile.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The divided element extension adds a two-bit field, <code>vediv[1:0]</code> to
the <code>vtype</code> register.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 15. <code>vtype</code> register layout</caption>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-right valign-top">Bits</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">XLEN-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vill</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Illegal value if set</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">XLEN-2:7</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved (write 0)</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">6:5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vediv[1:0]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used by EDIV extension</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">4:2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsew[2:0]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard element width (SEW) setting</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">1:0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vlmul[1:0]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vector register group multiplier (LMUL) setting</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>vediv</code> field encodes the number of ways, <em>EDIV</em>, into which each
SEW-bit element is subdivided into equal sub-elements.  A vector
register group is now considered to hold a vector of sub-vectors.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 6.25%;">
<col style="width: 81.25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="3">vediv [1:0]</th>
<th class="tableblock halign-left valign-top">Division EDIV</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(undivided, as in base)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">two equal sub-elements</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">four equal sub-elements</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eight equal sub-elements</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">SEW</p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">EDIV</p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Sub-element</p></td>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Integer accumulator</p></td>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">FP sum/dot accumulator</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FLEN=32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FLEN=64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FLEN=128</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">16b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">16b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">16b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">128b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128b</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">128b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">128b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">256b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128b</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">256b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128b</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">256b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64b</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Each implementation defines a minimum size for a sub-element, <em>SELEN</em>,
which must be at most 8 bits.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
While <em>SELEN</em> is a fourth implementation-specific parameter,
values smaller than 8 would be considered an additional extension.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_instructions_not_affected_by_ediv">19.1. Instructions not affected by EDIV</h3>
<div class="paragraph">
<p>The vector start register <code>vstart</code> and exception reporting continue to
work as before.</p>
</div>
<div class="paragraph">
<p>The vector length <code>vl</code> control and vector masking continue to operate
at the element level.</p>
</div>
<div class="paragraph">
<p>Vector masking continues to operate at the element level, so
sub-elements cannot be individually masked.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
SEW can be changed dynamically to enabled per-element masking
for sub-elements of 8 bits and greater.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Vector load/store and AMO instructions are unaffected by EDIV, and
continue to move whole elements.</p>
</div>
<div class="paragraph">
<p>Vector mask logical operations are unchanged by EDIV setting, and
continue to operate on vector registers containing element masks.</p>
</div>
<div class="paragraph">
<p>Vector mask population count (<code>vpopc</code>), find-first and related
instructions (<code>vfirst</code>, <code>vmsbf</code>, <code>vmsif</code>, <code>vmsof</code>), iota (<code>viota</code>),
and element index (<code>vid</code>) instructions are unaffected by EDIV.</p>
</div>
<div class="paragraph">
<p>Vector integer bit insert/extract, and integer and floating-point
scalar move instruction are unaffected by EDIV.</p>
</div>
<div class="paragraph">
<p>Vector slide-up/slide-down are unaffected by EDIV.</p>
</div>
<div class="paragraph">
<p>Vector compress instructions are unaffected by EDIV.</p>
</div>
</div>
<div class="sect2">
<h3 id="_instructions_affected_by_ediv">19.2. Instructions Affected by EDIV</h3>
<div class="sect3">
<h4 id="_regular_vector_arithmetic_instructions_under_ediv">19.2.1. Regular Vector Arithmetic Instructions under EDIV</h4>
<div class="paragraph">
<p>Most vector arithmetic operations are modified to operate on the
individual sub-elements, so effective SEW is SEW/EDIV and effective
vector length is <code>vl</code> * EDIV.  For example, a vector add of 32-bit
elements with a <code>vl</code> of 5 and EDIV of 4, operates identically to a
vector add of 8-bit elements with a vector length of 20.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>vsetvli t0, a0, e32,m1,d4  # Vectors of 32-bit elements, divided into byte sub-elements
vadd.vv v1,v2,v3                     # Performs a vector of 4*vl 8-bit additions.
vsll.vx v1,v2,x1                     # Performs a vector of 4*vl 8-bit shifts.</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vector_add_with_carrysubtract_with_borrow_reserved_under_ediv1">19.2.2. Vector Add with Carry/Subtract with Borrow Reserved under EDIV&gt;1</h4>
<div class="paragraph">
<p>For EDIV &gt; 1, <code>vadc</code>, <code>vmadc</code>, <code>vsbc</code>, <code>vmsbc</code> are reserved.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vector_reduction_instructions_under_ediv">19.2.3. Vector Reduction Instructions under EDIV</h4>
<div class="paragraph">
<p>Vector single-width integer sum reduction instructions are reserved
under EDIV&gt;1.  Other vector single-width reductions and vector
widening integer sum reduction instructions now operate independently
on all elements in a vector, reducing sub-element values within an
element to an element-wide result.</p>
</div>
<div class="paragraph">
<p>The scalar input is taken from the least-significant bits of the
second operand, with the number of bits equal to the number of
significant result bits (i.e., for sum and dot reductions, the number
of bits are given in table above, for non-sum and non-dot reductions,
equal to the element size).</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Sum each sub-vector of four bytes into a 16-bit result.
vsetvli t0, a0, e32,d4  # Vectors of 32-bit elements, divided into byte sub-elements
vwredsum.vs v1, v2, v3 # v1[i][15:0] = v2[i][31:24] + v2[i][23:16]
                       #              + v2[i][15:8] + v2[i][7:0] + v3[i][15:0]

# Find maximum among sub-elements
vredmax.vs v5, v6, v7 # v5[i][7:0] = max(v6[i][31:24], v6[i][23:16],
                      #                    v6[i][15:8], v6[i][7:0], v7[i][7:0])</pre>
</div>
</div>
<div class="paragraph">
<p>Integer sub-element non-sum reductions produce a final result that is
max(8,SEW/EDIV) bits wide, sign- or zero-extended to full SEW if
necessary.</p>
</div>
<div class="paragraph">
<p>Integer sub-element widening sum reductions produce a final result
that is max(8,min(SEW,2*SEW/EDIV)) bits wide, sign- or zero-extended
to full SEW if necessary.</p>
</div>
<div class="paragraph">
<p>Single-width floating-point reductions produce a final result that is
SEW/EDIV bits wide.</p>
</div>
<div class="paragraph">
<p>Widening floating-point sum reductions produce a final result that is
min(2*SEW/EDIV,FLEN) bits wide, NaN-boxed to the full SEW width if
necessary.</p>
</div>
</div>
<div class="sect3">
<h4 id="_vector_register_gather_instructions_under_ediv">19.2.4. Vector Register Gather Instructions under EDIV</h4>
<div class="paragraph">
<p>Vector register gather instructions under non-zero EDIV only gather
sub-elements within the element.  The source and index values are
interpreted as relative to the enclosing element only.  Index values
&#8805; EDIV write a zero value into the result sub-element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>       |       |       |  SEW = 32b, EDIV=4
        7 6 5 4 3 2 1 0  bytes
        d e a d b e e f  v1
        0 1 9 2 0 2 3 2  v2
                            vrgather.vv v3, v1, v2
        d a 0 e f e b e  v3
                            vrgather.vi v4, v1, 1
        a a a a e e e e  v4</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Vector register gathers with scalar or immediate arguments can
"splat" values across sub-elements within an element.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Implementations can provide fast implementations of register
gathers constrained within a single element width.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_integer_dot_product_instruction">19.3. Vector Integer Dot-Product Instruction</h3>
<div class="paragraph">
<p>The integer dot-product reduction <code>vdot.vv</code> performs an element-wise
multiplication between the source sub-elements then accumulates the
results into the destination vector element.  Note the assembler syntax
uses a <code>.vv</code> suffix since both inputs are vectors of elements.</p>
</div>
<div class="paragraph">
<p>Sub-element integer dot reductions produce a final result
that is max(8,min(SEW,4*SEW/EDIV)) bits wide, sign- or zero-extended
to full SEW if necessary.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Unsigned dot-product
vdotu.vv vd, vs2, vs1, vm  # Vector-vector

# Signed dot-product
vdot.vv vd, vs2, vs1, vm   # Vector-vector</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>  # Dot product, SEW=32, EDIV=1
  vdot.vv  vd, vs2, vs1, vm   # vd[i][31:0] += vs2[i][31:0] * vs1[i][31:0]

  # Dot product, SEW=32, EDIV=2
  vdot.vv vd, vs2, vs1, vm # vd[i][31:0] += vs2[i][31:16] * vs1[i][31:16]
                                            + vs2[i][15:0] * vs1[i][15:0]

  # Dot product, SEW=32, EDIV=4
  vdot.vv vd, vs2, vs1, vm # vd[i][31:0] += vs2[i][31:24] * vs1[i][31:24]
                                            + vs2[i][23:16] * vs1[i][23:16]
                                            + vs2[i][15:8] * vs1[i][15:8]
                                            + vs2[i][7:0] * vs1[i][7:0]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vector_floating_point_dot_product_instruction">19.4. Vector Floating-Point Dot Product Instruction</h3>
<div class="paragraph">
<p>The floating-point dot-product reduction <code>vfdot.vv</code> performs an element-wise
multiplication between the source sub-elements then accumulates the
results into the destination vector element.  Note the assembler syntax
uses a <code>.vv</code> suffix since both inputs are vectors of elements.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Signed dot-product
vfdot.vv vd, vs2, vs1, vm   # Vector-vector</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre># Dot product. SEW=32, EDIV=2
vfdot.v  vd, vs2, vs1, vm # vd[i][31:0] += vs2[i][31:16] * vs1[i][31:16]
                                          + vs2[i][15:0] * vs1[i][15:0]

# Floating-point sub-vectors of two half-precision floats packed into 32-bit elements.
vsetvli t0, a0, e32,m1,d2  # Vectors of 32-bit elements, divided into 16b sub-elements
vfdot.vv v1, v2, v3   # v1[i][31:0] +=  v2[i][31:16]*v3[i][31:16] + v2[i][16:0]*v3[i][16:0]

# Floating-point sub-vectors of two half-precision floats packed into 32-bit elements.
vsetvli t0, a0, e32,m1,d2  # Vectors of 32-bit elements, divided into 16b sub-elements
vfdot.vv v1, v2, v3   # v1[i][31:0] +=  v2[i][31:16]*v3[i][31:16] + v2[i][16:0]*v3[i][16:0]

# Floating-point sub-vectors of four half-precision floats packed into 64-bit elements.
vsetvli t0, a0, e64,m1,d4  # Vectors of 64-bit elements, divided into 16b sub-elements
vfdot.vv v1, v2, v3
                 # v1[i][31:0] +=  v2[i][31:16]*v3[i][31:16] + v2[i][16:0]*v3[i][16:0] +
                 #                 v2[i][63:48]*v3[i][63:48] + v2[i][47:32]*v3[i][47:32];
                 # v1[i][63:32] = ~0 (NaN boxing)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vector_instruction_listing">20. Vector Instruction Listing</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6924%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="5">Integer</th>
<th class="tableblock halign-left valign-top" colspan="4">Integer</th>
<th class="tableblock halign-left valign-top" colspan="4">FP</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">funct3</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">funct3</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">funct3</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPIVV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPMVV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPFVV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPIVX</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPMVX</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPFVF</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPIVI</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6924%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="5">funct6</th>
<th class="tableblock halign-left valign-top" colspan="4">funct6</th>
<th class="tableblock halign-left valign-top" colspan="4">funct6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vadd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vredsum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfadd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000001</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vredand</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfredsum</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsub</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vredor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfsub</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vrsub</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vredxor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfredosum</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vminu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vredminu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfmin</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vredmin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfredmin</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmaxu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vredmaxu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfmax</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">000111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vredmax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfredmax</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001000</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001000</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfsgnj</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vand</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001001</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfsgnjn</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001010</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfsgnjx</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vxor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vrgather</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001100</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001100</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vslideup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vslide1up</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">001111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vslidedown</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vslide1down</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6924%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="5">funct6</th>
<th class="tableblock halign-left valign-top" colspan="4">funct6</th>
<th class="tableblock halign-left valign-top" colspan="4">funct6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">010000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vadc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VWXUNARY0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VWFUNARY0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010000</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VRXUNARY0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010000</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VRFUNARY0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">010001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmadc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010001</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010001</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">010010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsbc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010010</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010010</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">010011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmsbc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">010100</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VMUNARY0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010100</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">010101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">010110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">010111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmerge/vmv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vcompress</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfmerge.vf/vfmv</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">011000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmseq</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmandnot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmfeq</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">011001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmsne</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmand</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmfle</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">011010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmsltu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011010</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">011011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmslt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmxor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmflt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">011100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmsleu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmornot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmfne</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">011101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmsle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmnand</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmfgt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">011110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmsgtu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmnor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">011111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmsgt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmxnor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmfge</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6924%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="5">funct6</th>
<th class="tableblock halign-left valign-top" colspan="4">funct6</th>
<th class="tableblock halign-left valign-top" colspan="4">funct6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsaddu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vdivu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfdiv</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsadd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vdiv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100001</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfrdiv</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vssubu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vremu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VFUNARY0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vssub</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vrem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VFUNARY1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vaadd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmulhu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfmul</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsll</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmul</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vasub</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmulhsu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsmul</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmulh</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfrsub</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101000</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfmadd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsra</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmadd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfnmadd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vssrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101010</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfmsub</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vssra</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vnmsub</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfnmsub</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vnsrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101100</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfmacc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vnsra</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmacc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfnmacc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vnclipu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfmsac</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">101111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vnclip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vnmsac</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfnmsac</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6924%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="5">funct6</th>
<th class="tableblock halign-left valign-top" colspan="4">funct6</th>
<th class="tableblock halign-left valign-top" colspan="4">funct6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">110000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwredsumu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwaddu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwadd</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">110001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwredsum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwadd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwredsum</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">110010</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwsubu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwsub</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">110011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwsub</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwredosum</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">110100</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwaddu.w</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwadd.w</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">110101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwadd.w</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110101</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">110110</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwsubu.w</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwsub.w</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">110111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwsub.w</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">111000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vdotu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwmulu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwmul</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">111001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vdot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111001</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfdot</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">111010</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwmulsu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111010</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">111011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwmul</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111011</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">111100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwsmaccu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwmaccu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwmacc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">111101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwsmacc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwmacc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwnmacc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">111110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwsmaccus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwmaccus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwmsac</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">111111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwsmaccsu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111111</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vwmaccsu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwnmsac</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 16. VRXUNARY0 encoding space</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 87.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">vs2</th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmv.s.x</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 17. VWXUNARY0 encoding space</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 87.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">vs1</th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmv.x.s</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vpopc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfirst</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 18. VRFUNARY0 encoding space</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 87.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">vs2</th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfmv.s.f</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 19. VWFUNARY0 encoding space</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 87.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">vs1</th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfmv.f.s</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 20. VFUNARY0 encoding space</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 87.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">vs1</th>
<th class="tableblock halign-left valign-top">name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">single-width converts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfcvt.xu.f.v</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfcvt.x.f.v</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfcvt.f.xu.v</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfcvt.f.x.v</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">widening converts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">01000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwcvt.xu.f.v</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">01001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwcvt.x.f.v</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">01010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwcvt.f.xu.v</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">01011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwcvt.f.x.v</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">01100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfwcvt.f.f.v</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">narrowing converts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfncvt.xu.f.v</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfncvt.x.f.v</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfncvt.f.xu.v</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfncvt.f.x.v</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfncvt.f.f.v</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 21. VFUNARY1 encoding space</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 87.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">vs1</th>
<th class="tableblock halign-left valign-top">name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfsqrt.v</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vfclass.v</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 22. VMUNARY0 encoding space</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 87.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">vs1</th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmsbf</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmsof</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vmsif</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">viota</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vid</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_vector_assembly_code_examples">Appendix A: Vector Assembly Code Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following are provided as non-normative text to help explain the vector ISA.</p>
</div>
<div class="sect2">
<h3 id="_vector_vector_add_example">A.1. Vector-vector add example</h3>
<div class="listingblock">
<div class="content">
<pre>    # vector-vector add routine of 32-bit integers
    # void vvaddint32(size_t n, const int*x, const int*y, int*z)
    # { for (size_t i=0; i&lt;n; i++) { z[i]=x[i]+y[i]; } }
    #
    # a0 = n, a1 = x, a2 = y, a3 = z
    # Non-vector instructions are indented
vvaddint32:
    vsetvli t0, a0, e32 # Set vector length based on 32-bit vectors
    vlw.v v0, (a1)           # Get first vector
      sub a0, a0, t0         # Decrement number done
      slli t0, t0, 2         # Multiply number done by 4 bytes
      add a1, a1, t0         # Bump pointer
    vlw.v v1, (a2)           # Get second vector
      add a2, a2, t0         # Bump pointer
    vadd.vv v2, v0, v1        # Sum vectors
    vsw.v v2, (a3)           # Store result
      add a3, a3, t0         # Bump pointer
      bnez a0, vvaddint32    # Loop back
      ret                    # Finished</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_example_with_mixed_width_mask_and_compute">A.2. Example with mixed-width mask and compute.</h3>
<div class="listingblock">
<div class="content">
<pre># Code using one width for predicate and different width for masked
# compute.
#   int8_t a[]; int32_t b[], c[];
#   for (i=0;  i&lt;n; i++) { b[i] =  (a[i] &lt; 5) ? c[i] : 1; }
#
# Mixed-width code that keeps SEW/LMUL=8
  loop:
    vsetvli a4, a0, e8,m1  # Byte vector for predicate calc
    vlb.v v1, (a1)                # Load a[i]
      add a1, a1, a4              # Bump pointer.
    vmslt.vi v0, v1, 5            # a[i] &lt; 5?

    vsetvli x0, a0, e32,m4 # Vector of 32-bit values.
      sub a0, a0, a4              # Decrement count
    vmv.v.i v4, 1                 # Splat immediate to destination
    vlw.v v4, (a3), v0.t          # Load requested elements of C.
      sll t1, a4, 2
      add a3, a3, t1              # Bump pointer.
    vsw.v v4, (a2)                # Store b[i].
      add a2, a2, t1              # Bump pointer.
      bnez a0, loop               # Any more?</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_memcpy_example">A.3. Memcpy example</h3>
<div class="listingblock">
<div class="content">
<pre>    # void *memcpy(void* dest, const void* src, size_t n)
    # a0=dest, a1=src, a2=n
    #
  memcpy:
      mv a3, a0 # Copy destination
  loop:
    vsetvli t0, a2, e8,m8  # Vectors of 8b
    vlb.v v0, (a1)                # Load bytes
      add a1, a1, t0              # Bump pointer
      sub a2, a2, t0              # Decrement count
    vsb.v v0, (a3)                # Store bytes
      add a3, a3, t0              # Bump pointer
      bnez a2, loop               # Any more?
      ret                         # Return</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_conditional_example">A.4. Conditional example</h3>
<div class="listingblock">
<div class="content">
<pre># (int16) z[i] = ((int8) x[i] &lt; 5) ? (int16) a[i] : (int16) b[i];
#
# Fixed 16b SEW:

loop:
    vsetvli t0, a0, e16  # Use 16b elements.
    vlb.v v0, (a1)          # Get x[i], sign-extended to 16b
      sub a0, a0, t0        # Decrement element count
      add a1, a1, t0        # x[i] Bump pointer
    vmslt.vi v0, v0, 5      # Set mask in v0
      slli t0, t0, 1        # Multiply by 2 bytes
    vlh.v v1, (a2), v0.t    # z[i] = a[i] case
    vmnot.m v0, v0          # Invert v0
      add a2, a2, t0        # a[i] bump pointer
    vlh.v v1, (a3), v0.t    # z[i] = b[i] case
      add a3, a3, t0        # b[i] bump pointer
    vsh.v v1, (a4)          # Store z
      add a4, a4, t0        # b[i] bump pointer
      bnez a0, loop</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_saxpy_example">A.5. SAXPY example</h3>
<div class="listingblock">
<div class="content">
<pre># void
# saxpy(size_t n, const float a, const float *x, float *y)
# {
#   size_t i;
#   for (i=0; i&lt;n; i++)
#     y[i] = a * x[i] + y[i];
# }
#
# register arguments:
#     a0      n
#     fa0     a
#     a1      x
#     a2      y

saxpy:
    vsetvli a4, a0, e32, m8
    vlw.v v0, (a1)
    sub a0, a0, a4
    slli a4, a4, 2
    add a1, a1, a4
    vlw.v v8, (a2)
    vfmacc.vf v8, fa0, v0
    vsw.v v8, (a2)
    add a2, a2, a4
    bnez a0, saxpy
    ret</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sgemm_example">A.6. SGEMM example</h3>
<div class="listingblock">
<div class="content">
<pre># RV64IDV system
#
# void
# sgemm_nn(size_t n,
#          size_t m,
#          size_t k,
#          const float*a,   // m * k matrix
#          size_t lda,
#          const float*b,   // k * n matrix
#          size_t ldb,
#          float*c,         // m * n matrix
#          size_t ldc)
#
#  c += a*b (alpha=1, no transpose on input matrices)
#  matrices stored in C row-major order

#define n a0
#define m a1
#define k a2
#define ap a3
#define astride a4
#define bp a5
#define bstride a6
#define cp a7
#define cstride t0
#define kt t1
#define nt t2
#define bnp t3
#define cnp t4
#define akp t5
#define bkp s0
#define nvl s1
#define ccp s2
#define amp s3

# Use args as additional temporaries
#define ft12 fa0
#define ft13 fa1
#define ft14 fa2
#define ft15 fa3

# This version holds a 16*VLMAX block of C matrix in vector registers
# in inner loop, but otherwise does not cache or TLB tiling.

sgemm_nn:
    addi sp, sp, -FRAMESIZE
    sd s0, OFFSET(sp)
    sd s1, OFFSET(sp)
    sd s2, OFFSET(sp)

    # Check for zero size matrices
    beqz n, exit
    beqz m, exit
    beqz k, exit

    # Convert elements strides to byte strides.
    ld cstride, OFFSET(sp)   # Get arg from stack frame
    slli astride, astride, 2
    slli bstride, bstride, 2
    slli cstride, cstride, 2

    slti t6, m, 16
    bnez t6, end_rows

c_row_loop: # Loop across rows of C blocks

    mv nt, n  # Initialize n counter for next row of C blocks

    mv bnp, bp # Initialize B n-loop pointer to start
    mv cnp, cp # Initialize C n-loop pointer

c_col_loop: # Loop across one row of C blocks
    vsetvli nvl, nt, e32  # 32-bit vectors, LMUL=1

    mv akp, ap   # reset pointer into A to beginning
    mv bkp, bnp # step to next column in B matrix

    # Initalize current C submatrix block from memory.
    vlw.v  v0, (cnp); add ccp, cnp, cstride;
    vlw.v  v1, (ccp); add ccp, ccp, cstride;
    vlw.v  v2, (ccp); add ccp, ccp, cstride;
    vlw.v  v3, (ccp); add ccp, ccp, cstride;
    vlw.v  v4, (ccp); add ccp, ccp, cstride;
    vlw.v  v5, (ccp); add ccp, ccp, cstride;
    vlw.v  v6, (ccp); add ccp, ccp, cstride;
    vlw.v  v7, (ccp); add ccp, ccp, cstride;
    vlw.v  v8, (ccp); add ccp, ccp, cstride;
    vlw.v  v9, (ccp); add ccp, ccp, cstride;
    vlw.v v10, (ccp); add ccp, ccp, cstride;
    vlw.v v11, (ccp); add ccp, ccp, cstride;
    vlw.v v12, (ccp); add ccp, ccp, cstride;
    vlw.v v13, (ccp); add ccp, ccp, cstride;
    vlw.v v14, (ccp); add ccp, ccp, cstride;
    vlw.v v15, (ccp)


    mv kt, k # Initialize inner loop counter

    # Inner loop scheduled assuming 4-clock occupancy of vfmacc instruction and single-issue pipeline
    # Software pipeline loads
    flw ft0, (akp); add amp, akp, astride;
    flw ft1, (amp); add amp, amp, astride;
    flw ft2, (amp); add amp, amp, astride;
    flw ft3, (amp); add amp, amp, astride;
    # Get vector from B matrix
    vlw.v v16, (bkp)

    # Loop on inner dimension for current C block
 k_loop:
    vfmacc.vf v0, ft0, v16
    add bkp, bkp, bstride
    flw ft4, (amp)
    add amp, amp, astride
    vfmacc.vf v1, ft1, v16
    addi kt, kt, -1    # Decrement k counter
    flw ft5, (amp)
    add amp, amp, astride
    vfmacc.vf v2, ft2, v16
    flw ft6, (amp)
    add amp, amp, astride
    flw ft7, (amp)
    vfmacc.vf v3, ft3, v16
    add amp, amp, astride
    flw ft8, (amp)
    add amp, amp, astride
    vfmacc.vf v4, ft4, v16
    flw ft9, (amp)
    add amp, amp, astride
    vfmacc.vf v5, ft5, v16
    flw ft10, (amp)
    add amp, amp, astride
    vfmacc.vf v6, ft6, v16
    flw ft11, (amp)
    add amp, amp, astride
    vfmacc.vf v7, ft7, v16
    flw ft12, (amp)
    add amp, amp, astride
    vfmacc.vf v8, ft8, v16
    flw ft13, (amp)
    add amp, amp, astride
    vfmacc.vf v9, ft9, v16
    flw ft14, (amp)
    add amp, amp, astride
    vfmacc.vf v10, ft10, v16
    flw ft15, (amp)
    add amp, amp, astride
    addi akp, akp, 4            # Move to next column of a
    vfmacc.vf v11, ft11, v16
    beqz kt, 1f                 # Don't load past end of matrix
    flw ft0, (akp)
    add amp, akp, astride
1:  vfmacc.vf v12, ft12, v16
    beqz kt, 1f
    flw ft1, (amp)
    add amp, amp, astride
1:  vfmacc.vf v13, ft13, v16
    beqz kt, 1f
    flw ft2, (amp)
    add amp, amp, astride
1:  vfmacc.vf v14, ft14, v16
    beqz kt, 1f                 # Exit out of loop
    flw ft3, (amp)
    add amp, amp, astride
    vfmacc.vf v15, ft15, v16
    vlw.v v16, (bkp)            # Get next vector from B matrix, overlap loads with jump stalls
    j k_loop

1:  vfmacc.vf v15, ft15, v16

    # Save C matrix block back to memory
    vsw.v  v0, (cnp); add ccp, cnp, cstride;
    vsw.v  v1, (ccp); add ccp, ccp, cstride;
    vsw.v  v2, (ccp); add ccp, ccp, cstride;
    vsw.v  v3, (ccp); add ccp, ccp, cstride;
    vsw.v  v4, (ccp); add ccp, ccp, cstride;
    vsw.v  v5, (ccp); add ccp, ccp, cstride;
    vsw.v  v6, (ccp); add ccp, ccp, cstride;
    vsw.v  v7, (ccp); add ccp, ccp, cstride;
    vsw.v  v8, (ccp); add ccp, ccp, cstride;
    vsw.v  v9, (ccp); add ccp, ccp, cstride;
    vsw.v v10, (ccp); add ccp, ccp, cstride;
    vsw.v v11, (ccp); add ccp, ccp, cstride;
    vsw.v v12, (ccp); add ccp, ccp, cstride;
    vsw.v v13, (ccp); add ccp, ccp, cstride;
    vsw.v v14, (ccp); add ccp, ccp, cstride;
    vsw.v v15, (ccp)

    # Following tail instructions should be scheduled earlier in free slots during C block save.
    # Leaving here for clarity.

    # Bump pointers for loop across blocks in one row
    slli t6, nvl, 2
    add cnp, cnp, t6                         # Move C block pointer over
    add bnp, bnp, t6                         # Move B block pointer over
    sub nt, nt, nvl                          # Decrement element count in n dimension
    bnez nt, c_col_loop                      # Any more to do?

    # Move to next set of rows
    addi m, m, -16  # Did 16 rows above
    slli t6, astride, 4  # Multiply astride by 16
    add ap, ap, t6         # Move A matrix pointer down 16 rows
    slli t6, cstride, 4  # Multiply cstride by 16
    add cp, cp, t6         # Move C matrix pointer down 16 rows

    slti t6, m, 16
    beqz t6, c_row_loop

    # Handle end of matrix with fewer than 16 rows.
    # Can use smaller versions of above decreasing in powers-of-2 depending on code-size concerns.
end_rows:
    # Not done.

exit:
    ld s0, OFFSET(sp)
    ld s1, OFFSET(sp)
    ld s2, OFFSET(sp)
    addi sp, sp, FRAMESIZE
    ret</pre>
</div>
</div>
</div>
</div>
</div>
      </div>
    </div>
    <script>
(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';

var tspan = require('tspan');

var colors = {
    2: 0,
    3: 80,
    4: 170,
    5: 45,
    6: 126,
    7: 215
};

function typeStyle (t) {
    var color = colors[t];
    return (color !== undefined) ? ';fill:hsl(' + color + ',100%,50%)' : '';
}

function t (x, y) {
    return 'translate(' + x + ',' + y + ')';
}

function text (body, x, y) {
    var attr = {};
    if (x) { attr.x = x; }
    if (y) { attr.y = y; }
    return ['text', attr].concat(tspan.parse(body));
}

function isIntGTorDefault(val, min, def) {
    return (typeof val === 'number' && val > min) ? (val |0) : def;
}

function getSVG (w, h) {
    return ['svg', {
        xmlns: 'http://www.w3.org/2000/svg',
        width: w,
        height: h,
        viewBox: [0, 0, w, h].join(' ')
    }];
}

function hline (len, x, y) {
    var opt = {};
    if (x) {
        opt.x1 = x;
        opt.x2 = x + len;
    } else {
        opt.x2 = len;
    }
    if (y) {
        opt.y1 = y;
        opt.y2 = y;
    }
    return ['line', opt];
}

function vline (len, x, y) {
    var opt = {};
    if (x) {
        opt.x1 = x;
        opt.x2 = x;
    }
    if (y) {
        opt.y1 = y;
        opt.y2 = y + len;
    } else {
        opt.y2 = len;
    }
    return ['line', opt];
}

function getLabel (val, x, y, step, len) {
    var i, res = ['g', {}];
    if (typeof val === 'number') {
        for (i = 0; i < len; i++) {
            res.push(text(
                (val >> i) & 1,
                x + step * (len / 2 - i - 0.5),
                y
            ));
        }
        return res;
    }
    return text(val, x, y);
}

function getAttr (e, opt, step, lsbm, msbm) {
    var x = step * (opt.mod - ((msbm + lsbm) / 2) - 1);
    if (Array.isArray(e.attr)) {
        return e.attr.reduce(function (prev, a, i) {
            if (a === undefined || a === null) {
                return prev;
            }
            return prev.concat([getLabel(a, x, 16 * i, step, e.bits)]);
        }, ['g', {}]);
    }
    return getLabel(e.attr, x, 0, step, e.bits);
}

function labelArr (desc, opt) {
    var step = opt.hspace / opt.mod;
    var bits  = ['g', {transform: t(step / 2, opt.vspace / 5)}];
    var names = ['g', {transform: t(step / 2, opt.vspace / 2 + 4)}];
    var attrs = ['g', {transform: t(step / 2, opt.vspace)}];
    var blanks = ['g', {transform: t(0, opt.vspace / 4)}];
    desc.forEach(function (e) {
        var lsbm, msbm, lsb, msb;
        lsbm = 0;
        msbm = opt.mod - 1;
        lsb = opt.index * opt.mod;
        msb = (opt.index + 1) * opt.mod - 1;
        if (((e.lsb / opt.mod) >> 0) === opt.index) {
            lsbm = e.lsbm;
            lsb = e.lsb;
            if (((e.msb / opt.mod) >> 0) === opt.index) {
                msb = e.msb;
                msbm = e.msbm;
            }
        } else {
            if (((e.msb / opt.mod) >> 0) === opt.index) {
                msb = e.msb;
                msbm = e.msbm;
            } else {
                return;
            }
        }
        bits.push(text(lsb, step * (opt.mod - lsbm - 1)));
        if (lsbm !== msbm) {
            bits.push(text(msb, step * (opt.mod - msbm - 1)));
        }
        if (e.name) {
            names.push(getLabel(
                e.name,
                step * (opt.mod - ((msbm + lsbm) / 2) - 1),
                0,
                step,
                e.bits
            ));
        }

        if ((e.name === undefined) || (e.type !== undefined)) {
            blanks.push(['rect', {
                style: 'fill-opacity:0.1' + typeStyle(e.type),
                x: step * (opt.mod - msbm - 1),
                y: 0,
                width: step * (msbm - lsbm + 1),
                height: opt.vspace / 2
            }]);
        }
        if (e.attr !== undefined) {
            attrs.push(getAttr(e, opt, step, lsbm, msbm));
        }
    });
    return ['g', blanks, bits, names, attrs];
}

function cage (desc, opt) {
    var hspace = opt.hspace;
    var vspace = opt.vspace;
    var mod = opt.mod;
    var res = ['g', {
        transform: t(0, vspace / 4),
        stroke: 'black',
        'stroke-width': 1,
        'stroke-linecap': 'round'
    }];

    res.push(hline(hspace));
    res.push(vline(vspace / 2));
    res.push(hline(hspace, 0, vspace / 2));

    var i = opt.index * opt.mod, j = opt.mod;
    do {
        if ((j === opt.mod) || desc.some(function (e) { return (e.lsb === i); })) {
            res.push(vline((vspace / 2), j * (hspace / mod)));
        } else {
            res.push(vline((vspace / 16), j * (hspace / mod)));
            res.push(vline((vspace / 16), j * (hspace / mod), vspace * 7 / 16));
        }
        i++; j--;
    } while (j);
    return res;
}


function lane (desc, opt) {
    return ['g', {
        transform: t(4.5, (opt.lanes - opt.index - 1) * opt.vspace + 0.5),
        'text-anchor': 'middle',
        'font-size': opt.fontsize,
        'font-family': opt.fontfamily || 'sans-serif',
        'font-weight': opt.fontweight || 'normal'
    },
    cage(desc, opt),
    labelArr(desc, opt)
    ];
}

function render (desc, opt) {
    opt = (typeof opt === 'object') ? opt : {};

    opt.vspace = isIntGTorDefault(opt.vspace, 19, 80);
    opt.hspace = isIntGTorDefault(opt.hspace, 39, 800);
    opt.lanes = isIntGTorDefault(opt.lanes, 0, 1);
    opt.bits = isIntGTorDefault(opt.bits, 4, 32);
    opt.fontsize = isIntGTorDefault(opt.fontsize, 5, 14);

    opt.bigendian = opt.bigendian || false;

    var attributes = desc.reduce(function (prev, cur) {
        return Math.max(prev, (Array.isArray(cur.attr)) ? cur.attr.length : 0);
    }, 0) * 16;
    var res = getSVG(opt.hspace + 9, (opt.vspace + attributes) * opt.lanes + 5);

    var lsb = 0;
    var mod = opt.bits / opt.lanes;
    opt.mod = mod |0;

    desc.forEach(function (e) {
        e.lsb = lsb;
        e.lsbm = lsb % mod;
        lsb += e.bits;
        e.msb = lsb - 1;
        e.msbm = e.msb % mod;
    });

    var i;
    for (i = 0; i < opt.lanes; i++) {
        opt.index = i;
        res.push(lane(desc, opt));
    }
    return res;
}

module.exports = render;

},{"tspan":10}],2:[function(require,module,exports){
'use strict';

const renderAll = require('./render-all');

window.matchMedia('print').addListener(e => {
  console.log('mql');
  console.log(e);
});

document.addEventListener('DOMContentLoaded', () => {
  renderAll();
});

console.log('app is up');
/* eslint-env browser */

},{"./render-all":3}],3:[function(require,module,exports){
'use strict';

const hljs = require('highlight.js/lib/highlight');
const riscvasm = require('../lib/riscvasm.js');
const cpp = require('highlight.js/lib/languages/cpp.js');
const wavedrom = require('wavedrom');
const vreg = require('./vreg.js');

hljs.registerLanguage('riscvasm', riscvasm);
hljs.registerLanguage('cpp', cpp);

module.exports = () => document.querySelectorAll('pre code').forEach(block => {
  const lang = block.getAttribute('data-lang');
  if (lang === 'datasheet') {
    const source = eval('(' + block.innerHTML + ')');

    const newNode = document.createElement('div');
    const parent = block.parentNode;
    const grandparent = parent.parentNode;
    grandparent.replaceChild(newNode, parent);

    if (source.isa !== undefined) {
      const s = {
        reg: source.isa,
        config: Object.assign(source.config || {}, {lanes: 1, hspace: ((980 - 8) >> 5) << 5})
      };
      wavedrom.renderWaveElement(0, s, newNode, wavedrom.waveSkin.default);
    } else
    if (source.vreg !== undefined) {
      newNode.innerHTML = vreg(source.vreg);
    } else {
      return;
    }
  } else {
    hljs.highlightBlock(block);
  }
});

/* eslint-env browser */

},{"../lib/riscvasm.js":4,"./vreg.js":5,"highlight.js/lib/highlight":6,"highlight.js/lib/languages/cpp.js":7,"wavedrom":21}],4:[function(require,module,exports){
'use strict';

module.exports = function(hljs) {
    //local labels: %?[FB]?[AT]?\d{1,2}\w+
  return {
    case_insensitive: true,
    aliases: ['riscv'],
    lexemes: '\\.?' + hljs.IDENT_RE,
    keywords: {
      meta:
        //GNU preprocs
        '.2byte .4byte .align .ascii .asciz .balign .byte .code .data .else .end .endif .endm .endr .equ .err .exitm .extern .global .hword .if .ifdef .ifndef .include .irp .long .macro .rept .req .section .set .skip .space .text .word .ltorg ',
      built_in:
        'vd vs1 vs2 vs3 vm va vb v0 v1 v2 v3 v4 v5 v6 v7 v8 ' + // vector registers
        'rd rs1 rs2 ' + // integer registers
        '$0 $1 $2 $3 $4 $5 $6 $7 $8 $9 $10 $11 $12 $13 $14 $15 ' + // integer registers
        '$16 $17 $18 $19 $20 $21 $22 $23 $24 $25 $26 $27 $28 $29 $30 $31 ' + // integer registers
        'zero at v0 v1 a0 a1 a2 a3 a4 a5 a6 a7 ' + // integer register aliases
        't0 t1 t2 t3 t4 t5 t6 t7 t8 t9 s0 s1 s2 s3 s4 s5 s6 s7 s8 ' + // integer register aliases
        'k0 k1 gp sp fp ra ' + // integer register aliases
        '$f0 $f1 $f2 $f2 $f4 $f5 $f6 $f7 $f8 $f9 $f10 $f11 $f12 $f13 $f14 $f15 ' + // floating-point registers
        '$f16 $f17 $f18 $f19 $f20 $f21 $f22 $f23 $f24 $f25 $f26 $f27 $f28 $f29 $f30 $f31 ' + // floating-point registers
        'Context Random EntryLo0 EntryLo1 Context PageMask Wired EntryHi ' + // Coprocessor 0 registers
        'HWREna BadVAddr Count Compare SR IntCtl SRSCtl SRSMap Cause EPC PRId ' + // Coprocessor 0 registers
        'EBase Config Config1 Config2 Config3 LLAddr Debug DEPC DESAVE CacheErr ' + // Coprocessor 0 registers
        'ECC ErrorEPC TagLo DataLo TagHi DataHi WatchLo WatchHi PerfCtl PerfCnt ' // Coprocessor 0 registers
    },
    contains: [
      {
        className: 'keyword',
        begin: '\\b('+     //mnemonics
            // integer instructions
            'addi?u?|andi?|b(al)?|beql?|bgez(al)?l?|bgtzl?|blezl?|bltz(al)?l?|' +
            'bnel?|cl[oz]|divu?|ext|ins|j(al)?|jalr(\.hb)?|jr(\.hb)?|lbu?|lhu?|' +
            'll|lui|lw[lr]?|maddu?|mfhi|mflo|movn|movz|move|msubu?|mthi|mtlo|mul|' +
            'multu?|nop|nor|ori?|rotrv?|sb|sc|se[bh]|sh|sllv?|slti?u?|srav?|' +
            'srlv?|subu?|sw[lr]?|xori?|wsbh|' +
            // floating-point instructions
            'abs\.[sd]|add\.[sd]|alnv.ps|bc1[ft]l?|' +
            'c\.(s?f|un|u?eq|[ou]lt|[ou]le|ngle?|seq|l[et]|ng[et])\.[sd]|' +
            '(ceil|floor|round|trunc)\.[lw]\.[sd]|cfc1|cvt\.d\.[lsw]|' +
            'cvt\.l\.[dsw]|cvt\.ps\.s|cvt\.s\.[dlw]|cvt\.s\.p[lu]|cvt\.w\.[dls]|' +
            'div\.[ds]|ldx?c1|luxc1|lwx?c1|madd\.[sd]|mfc1|mov[fntz]?\.[ds]|' +
            'msub\.[sd]|mth?c1|mul\.[ds]|neg\.[ds]|nmadd\.[ds]|nmsub\.[ds]|' +
            'p[lu][lu]\.ps|recip\.fmt|r?sqrt\.[ds]|sdx?c1|sub\.[ds]|suxc1|' +
            'swx?c1|' +
            // system control instructions
            'break|cache|d?eret|[de]i|ehb|mfc0|mtc0|pause|prefx?|rdhwr|' +
            'rdpgpr|sdbbp|ssnop|synci?|syscall|teqi?|tgei?u?|tlb(p|r|w[ir])|' +
            'tlti?u?|tnei?|wait|wrpgpr'+
            // integer instructions
            '|csrr|ret|mv' +
            // vector instructions
            '|vsetvli|vid.v|vext.x.v|vmv.s.x|vfmv.f.s|vfmv.s.f|vmfirst.m' +
            '|vl[bhwe].v|vl[bhwe]u.v|vs[bhwe].v' +
            '|vl[sx][bhwe].v|vl[sx][bhwe]u.v|vs[sx][bhwe].v' +
            '|vlux[bhwe].v|vlux[bhwe]u.v|vsux[bhwe].v' +
            '|vl[bhwe]ff.v|vl[bhwe]uff.v' +
            '|vop.v[vxi]|v[fw]op.[wv][xfv]' +
            '|vred(sum|and|or|xor|(max|min)(u|)).v[sv]' +
            '|vwredsum(u|).vs' +
            '|vfred(osum|sum|max|min).vs' +
            '|vfwred(osum|sum).vs' +
            '|vm(and|nand|andnot|xor|or|nor|ornot|xnor).mm' +
            '|vmpopc.m' +
            '|vslide(up|down|1up|1down).v[xi]' +
            '|vrgather.v[vxi]' +
            '|vcompress.vm|vmsif.m|vseq.vi' +
            '|v(f|fw|fn)cvt.[xfv](u|).[xfv](u|).[xfv](u|)' +
            '|v(f|w|n|)((s|a|fw|)(add|sub)|dot|sqrt|rsub|adc|sbc|and|or|xor|nclip|sgnj(n|x|)|(s|)s(ll|rl|ra)|(s|)(eq|ne|lt|le|gt|ge)|ord|class|min|max|rdiv|div|rem|merge|(s|fw|)mul(h|s|hs|)|(ws|n|fw|fwn|)m(acc|sac|add|sub))(u|).[vw](f|v|x|i|)' +
        ')',
        end: '\\s'
      },
      hljs.COMMENT('[;#]', '$'),
      hljs.C_BLOCK_COMMENT_MODE,
      hljs.QUOTE_STRING_MODE,
      {
        className: 'string',
        begin: '\'',
        end: '[^\\\\]\'',
        relevance: 0
      },
      {
        className: 'title',
        begin: '\\|', end: '\\|',
        illegal: '\\n',
        relevance: 0
      },
      {
        className: 'number',
        variants: [
            {begin: '0x[0-9a-f]+'}, //hex
            {begin: '\\b-?\\d+'}           //bare number
        ],
        relevance: 0
      },
      {
        className: 'symbol',
        variants: [
            {begin: '^\\s*[a-z_\\.\\$][a-z0-9_\\.\\$]+:'}, //GNU MIPS syntax
            {begin: '^\\s*[0-9]+:'}, // numbered local labels
            {begin: '[0-9]+[bf]' }  // number local label reference (backwards, forwards)
        ],
        relevance: 0
      }
    ],
    illegal: '\/'
  };
};

/* eslint no-useless-escape: 1 */

},{}],5:[function(require,module,exports){
'use strict';

const onmlStringify = require('onml/lib/stringify');
const range = require('lodash.range');

const t = (x, y) => ({transform: 'translate(' + (x || 0) + ',' + (y || 0) + ')'});

const getSvg = cfg => {
  cfg = cfg || {};
  cfg.w = cfg.w || 880;
  cfg.h = cfg.h || 256;
  return ['svg', {
    xmlns: 'http://www.w3.org/2000/svg',
    width: cfg.w + 1,
    height: cfg.h + 1,
    viewBox: [0, 0, cfg.w + 1, cfg.h + 1].join(' ')
  }];
};

const render = props => {
  const {vlen, sew, lmul, slen} = props;
  const bwidth = 24;
  const hstep = bwidth * props.sew / 8;
  const vstep = 24;
  const bytes = 32;
  const hsteps = vlen / sew;
  const stripe = slen / sew;

  const head = getSvg({w: 880, h: (lmul + 1) * vstep + 4});

  const style = ['style', {}, `
    line { stroke: #000; stroke-width: 1px; }
    .vreg { font-size: 16px; alignment-baseline: middle; text-anchor: middle; }
    .rowlabel { text-anchor: start; }
    .collabel { font-size: 14px; }
  `];

  const grid = ['g', {}]
    .concat(
      range(lmul + 1).map(i =>
        ['line', {x1: 0, x2: -(hsteps * hstep),  y1: i * vstep, y2: i * vstep}]),
      range(hsteps + 1).map(i =>
        ['line', {y1: 0, y2: lmul * vstep, x1: -i * hstep, x2: -i * hstep}]));

  const colLabels = ['g', t(-bwidth / 2, -7)]
    .concat(
      range(vlen >> 3).map(i =>
        ['text', {class: 'vreg collabel', x: -i * bwidth}, i.toString(16).toUpperCase()]));

  const rowLabels = ['g', t(8, vstep >> 1)]
    .concat(
      range(lmul).map(i =>
        ['text', {class: 'vreg rowlabel', y: i * vstep}, 'v' + lmul + ' * n + ' + i]));

  const cells = ['g', t(-bwidth >> 1, (vstep >> 1) + 2)]
    .concat(
      range(lmul).map(y =>
        ['g', t(0, y * vstep)]
          .concat(
            range(hsteps).map(x =>
              ['text', {class: 'vreg', x: -x * hstep},
                (x + y * stripe + (((x / stripe)|0) * (stripe * lmul - stripe)))
                  .toString(16).toUpperCase()]))));

  return head.concat(
    [style],
    [['g', t(bwidth * bytes + 4.5, vstep + .5),
      ['text', {x: 8, y: -9, class: 'vreg rowlabel'}, 'Byte'],
      grid,
      colLabels,
      rowLabels,
      cells
    ]]);
};

module.exports = p => {
  const ml = render(p);
  const str = onmlStringify(ml);
  return str;
};

},{"lodash.range":8,"onml/lib/stringify":9}],6:[function(require,module,exports){
/*
Syntax highlighting with language autodetection.
https://highlightjs.org/
*/

(function(factory) {

  // Find the global object for export to both the browser and web workers.
  var globalObject = typeof window === 'object' && window ||
                     typeof self === 'object' && self;

  // Setup highlight.js for different environments. First is Node.js or
  // CommonJS.
  // `nodeType` is checked to ensure that `exports` is not a HTML element.
  if(typeof exports !== 'undefined' && !exports.nodeType) {
    factory(exports);
  } else if(globalObject) {
    // Export hljs globally even when using AMD for cases when this script
    // is loaded with others that may still expect a global hljs.
    globalObject.hljs = factory({});

    // Finally register the global hljs with AMD.
    if(typeof define === 'function' && define.amd) {
      define([], function() {
        return globalObject.hljs;
      });
    }
  }

}(function(hljs) {
  // Convenience variables for build-in objects
  var ArrayProto = [],
      objectKeys = Object.keys;

  // Global internal variables used within the highlight.js library.
  var languages = {},
      aliases   = {};

  // Regular expressions used throughout the highlight.js library.
  var noHighlightRe    = /^(no-?highlight|plain|text)$/i,
      languagePrefixRe = /\blang(?:uage)?-([\w-]+)\b/i,
      fixMarkupRe      = /((^(<[^>]+>|\t|)+|(?:\n)))/gm;

  // The object will be assigned by the build tool. It used to synchronize API 
  // of external language files with minified version of the highlight.js library.
  var API_REPLACES;

  var spanEndTag = '</span>';

  // Global options used when within external APIs. This is modified when
  // calling the `hljs.configure` function.
  var options = {
    classPrefix: 'hljs-',
    tabReplace: null,
    useBR: false,
    languages: undefined
  };


  /* Utility functions */

  function escape(value) {
    return value.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
  }

  function tag(node) {
    return node.nodeName.toLowerCase();
  }

  function testRe(re, lexeme) {
    var match = re && re.exec(lexeme);
    return match && match.index === 0;
  }

  function isNotHighlighted(language) {
    return noHighlightRe.test(language);
  }

  function blockLanguage(block) {
    var i, match, length, _class;
    var classes = block.className + ' ';

    classes += block.parentNode ? block.parentNode.className : '';

    // language-* takes precedence over non-prefixed class names.
    match = languagePrefixRe.exec(classes);
    if (match) {
      return getLanguage(match[1]) ? match[1] : 'no-highlight';
    }

    classes = classes.split(/\s+/);

    for (i = 0, length = classes.length; i < length; i++) {
      _class = classes[i];

      if (isNotHighlighted(_class) || getLanguage(_class)) {
        return _class;
      }
    }
  }

  function inherit(parent) {  // inherit(parent, override_obj, override_obj, ...)
    var key;
    var result = {};
    var objects = Array.prototype.slice.call(arguments, 1);

    for (key in parent)
      result[key] = parent[key];
    objects.forEach(function(obj) {
      for (key in obj)
        result[key] = obj[key];
    });
    return result;
  }

  /* Stream merging */

  function nodeStream(node) {
    var result = [];
    (function _nodeStream(node, offset) {
      for (var child = node.firstChild; child; child = child.nextSibling) {
        if (child.nodeType === 3)
          offset += child.nodeValue.length;
        else if (child.nodeType === 1) {
          result.push({
            event: 'start',
            offset: offset,
            node: child
          });
          offset = _nodeStream(child, offset);
          // Prevent void elements from having an end tag that would actually
          // double them in the output. There are more void elements in HTML
          // but we list only those realistically expected in code display.
          if (!tag(child).match(/br|hr|img|input/)) {
            result.push({
              event: 'stop',
              offset: offset,
              node: child
            });
          }
        }
      }
      return offset;
    })(node, 0);
    return result;
  }

  function mergeStreams(original, highlighted, value) {
    var processed = 0;
    var result = '';
    var nodeStack = [];

    function selectStream() {
      if (!original.length || !highlighted.length) {
        return original.length ? original : highlighted;
      }
      if (original[0].offset !== highlighted[0].offset) {
        return (original[0].offset < highlighted[0].offset) ? original : highlighted;
      }

      /*
      To avoid starting the stream just before it should stop the order is
      ensured that original always starts first and closes last:

      if (event1 == 'start' && event2 == 'start')
        return original;
      if (event1 == 'start' && event2 == 'stop')
        return highlighted;
      if (event1 == 'stop' && event2 == 'start')
        return original;
      if (event1 == 'stop' && event2 == 'stop')
        return highlighted;

      ... which is collapsed to:
      */
      return highlighted[0].event === 'start' ? original : highlighted;
    }

    function open(node) {
      function attr_str(a) {return ' ' + a.nodeName + '="' + escape(a.value).replace('"', '&quot;') + '"';}
      result += '<' + tag(node) + ArrayProto.map.call(node.attributes, attr_str).join('') + '>';
    }

    function close(node) {
      result += '</' + tag(node) + '>';
    }

    function render(event) {
      (event.event === 'start' ? open : close)(event.node);
    }

    while (original.length || highlighted.length) {
      var stream = selectStream();
      result += escape(value.substring(processed, stream[0].offset));
      processed = stream[0].offset;
      if (stream === original) {
        /*
        On any opening or closing tag of the original markup we first close
        the entire highlighted node stack, then render the original tag along
        with all the following original tags at the same offset and then
        reopen all the tags on the highlighted stack.
        */
        nodeStack.reverse().forEach(close);
        do {
          render(stream.splice(0, 1)[0]);
          stream = selectStream();
        } while (stream === original && stream.length && stream[0].offset === processed);
        nodeStack.reverse().forEach(open);
      } else {
        if (stream[0].event === 'start') {
          nodeStack.push(stream[0].node);
        } else {
          nodeStack.pop();
        }
        render(stream.splice(0, 1)[0]);
      }
    }
    return result + escape(value.substr(processed));
  }

  /* Initialization */

  function expand_mode(mode) {
    if (mode.variants && !mode.cached_variants) {
      mode.cached_variants = mode.variants.map(function(variant) {
        return inherit(mode, {variants: null}, variant);
      });
    }
    return mode.cached_variants || (mode.endsWithParent && [inherit(mode)]) || [mode];
  }

  function restoreLanguageApi(obj) {
    if(API_REPLACES && !obj.langApiRestored) {
      obj.langApiRestored = true;
      for(var key in API_REPLACES)
        obj[key] && (obj[API_REPLACES[key]] = obj[key]);
      (obj.contains || []).concat(obj.variants || []).forEach(restoreLanguageApi);
    }
  }

  function compileLanguage(language) {

    function reStr(re) {
        return (re && re.source) || re;
    }

    function langRe(value, global) {
      return new RegExp(
        reStr(value),
        'm' + (language.case_insensitive ? 'i' : '') + (global ? 'g' : '')
      );
    }

    // joinRe logically computes regexps.join(separator), but fixes the
    // backreferences so they continue to match.
    function joinRe(regexps, separator) {
      // backreferenceRe matches an open parenthesis or backreference. To avoid
      // an incorrect parse, it additionally matches the following:
      // - [...] elements, where the meaning of parentheses and escapes change
      // - other escape sequences, so we do not misparse escape sequences as
      //   interesting elements
      // - non-matching or lookahead parentheses, which do not capture. These
      //   follow the '(' with a '?'.
      var backreferenceRe = /\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;
      var numCaptures = 0;
      var ret = '';
      for (var i = 0; i < regexps.length; i++) {
        var offset = numCaptures;
        var re = reStr(regexps[i]);
        if (i > 0) {
          ret += separator;
        }
        while (re.length > 0) {
          var match = backreferenceRe.exec(re);
          if (match == null) {
            ret += re;
            break;
          }
          ret += re.substring(0, match.index);
          re = re.substring(match.index + match[0].length);
          if (match[0][0] == '\\' && match[1]) {
            // Adjust the backreference.
            ret += '\\' + String(Number(match[1]) + offset);
          } else {
            ret += match[0];
            if (match[0] == '(') {
              numCaptures++;
            }
          }
        }
      }
      return ret;
    }

    function compileMode(mode, parent) {
      if (mode.compiled)
        return;
      mode.compiled = true;

      mode.keywords = mode.keywords || mode.beginKeywords;
      if (mode.keywords) {
        var compiled_keywords = {};

        var flatten = function(className, str) {
          if (language.case_insensitive) {
            str = str.toLowerCase();
          }
          str.split(' ').forEach(function(kw) {
            var pair = kw.split('|');
            compiled_keywords[pair[0]] = [className, pair[1] ? Number(pair[1]) : 1];
          });
        };

        if (typeof mode.keywords === 'string') { // string
          flatten('keyword', mode.keywords);
        } else {
          objectKeys(mode.keywords).forEach(function (className) {
            flatten(className, mode.keywords[className]);
          });
        }
        mode.keywords = compiled_keywords;
      }
      mode.lexemesRe = langRe(mode.lexemes || /\w+/, true);

      if (parent) {
        if (mode.beginKeywords) {
          mode.begin = '\\b(' + mode.beginKeywords.split(' ').join('|') + ')\\b';
        }
        if (!mode.begin)
          mode.begin = /\B|\b/;
        mode.beginRe = langRe(mode.begin);
        if (mode.endSameAsBegin)
          mode.end = mode.begin;
        if (!mode.end && !mode.endsWithParent)
          mode.end = /\B|\b/;
        if (mode.end)
          mode.endRe = langRe(mode.end);
        mode.terminator_end = reStr(mode.end) || '';
        if (mode.endsWithParent && parent.terminator_end)
          mode.terminator_end += (mode.end ? '|' : '') + parent.terminator_end;
      }
      if (mode.illegal)
        mode.illegalRe = langRe(mode.illegal);
      if (mode.relevance == null)
        mode.relevance = 1;
      if (!mode.contains) {
        mode.contains = [];
      }
      mode.contains = Array.prototype.concat.apply([], mode.contains.map(function(c) {
        return expand_mode(c === 'self' ? mode : c);
      }));
      mode.contains.forEach(function(c) {compileMode(c, mode);});

      if (mode.starts) {
        compileMode(mode.starts, parent);
      }

      var terminators =
        mode.contains.map(function(c) {
          return c.beginKeywords ? '\\.?(?:' + c.begin + ')\\.?' : c.begin;
        })
        .concat([mode.terminator_end, mode.illegal])
        .map(reStr)
        .filter(Boolean);
      mode.terminators = terminators.length ? langRe(joinRe(terminators, '|'), true) : {exec: function(/*s*/) {return null;}};
    }
    
    compileMode(language);
  }

  /*
  Core highlighting function. Accepts a language name, or an alias, and a
  string with the code to highlight. Returns an object with the following
  properties:

  - relevance (int)
  - value (an HTML string with highlighting markup)

  */
  function highlight(name, value, ignore_illegals, continuation) {

    function escapeRe(value) {
      return new RegExp(value.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&'), 'm');
    }

    function subMode(lexeme, mode) {
      var i, length;

      for (i = 0, length = mode.contains.length; i < length; i++) {
        if (testRe(mode.contains[i].beginRe, lexeme)) {
          if (mode.contains[i].endSameAsBegin) {
            mode.contains[i].endRe = escapeRe( mode.contains[i].beginRe.exec(lexeme)[0] );
          }
          return mode.contains[i];
        }
      }
    }

    function endOfMode(mode, lexeme) {
      if (testRe(mode.endRe, lexeme)) {
        while (mode.endsParent && mode.parent) {
          mode = mode.parent;
        }
        return mode;
      }
      if (mode.endsWithParent) {
        return endOfMode(mode.parent, lexeme);
      }
    }

    function isIllegal(lexeme, mode) {
      return !ignore_illegals && testRe(mode.illegalRe, lexeme);
    }

    function keywordMatch(mode, match) {
      var match_str = language.case_insensitive ? match[0].toLowerCase() : match[0];
      return mode.keywords.hasOwnProperty(match_str) && mode.keywords[match_str];
    }

    function buildSpan(classname, insideSpan, leaveOpen, noPrefix) {
      var classPrefix = noPrefix ? '' : options.classPrefix,
          openSpan    = '<span class="' + classPrefix,
          closeSpan   = leaveOpen ? '' : spanEndTag;

      openSpan += classname + '">';

      if (!classname) return insideSpan;
      return openSpan + insideSpan + closeSpan;
    }

    function processKeywords() {
      var keyword_match, last_index, match, result;

      if (!top.keywords)
        return escape(mode_buffer);

      result = '';
      last_index = 0;
      top.lexemesRe.lastIndex = 0;
      match = top.lexemesRe.exec(mode_buffer);

      while (match) {
        result += escape(mode_buffer.substring(last_index, match.index));
        keyword_match = keywordMatch(top, match);
        if (keyword_match) {
          relevance += keyword_match[1];
          result += buildSpan(keyword_match[0], escape(match[0]));
        } else {
          result += escape(match[0]);
        }
        last_index = top.lexemesRe.lastIndex;
        match = top.lexemesRe.exec(mode_buffer);
      }
      return result + escape(mode_buffer.substr(last_index));
    }

    function processSubLanguage() {
      var explicit = typeof top.subLanguage === 'string';
      if (explicit && !languages[top.subLanguage]) {
        return escape(mode_buffer);
      }

      var result = explicit ?
                   highlight(top.subLanguage, mode_buffer, true, continuations[top.subLanguage]) :
                   highlightAuto(mode_buffer, top.subLanguage.length ? top.subLanguage : undefined);

      // Counting embedded language score towards the host language may be disabled
      // with zeroing the containing mode relevance. Usecase in point is Markdown that
      // allows XML everywhere and makes every XML snippet to have a much larger Markdown
      // score.
      if (top.relevance > 0) {
        relevance += result.relevance;
      }
      if (explicit) {
        continuations[top.subLanguage] = result.top;
      }
      return buildSpan(result.language, result.value, false, true);
    }

    function processBuffer() {
      result += (top.subLanguage != null ? processSubLanguage() : processKeywords());
      mode_buffer = '';
    }

    function startNewMode(mode) {
      result += mode.className? buildSpan(mode.className, '', true): '';
      top = Object.create(mode, {parent: {value: top}});
    }

    function processLexeme(buffer, lexeme) {

      mode_buffer += buffer;

      if (lexeme == null) {
        processBuffer();
        return 0;
      }

      var new_mode = subMode(lexeme, top);
      if (new_mode) {
        if (new_mode.skip) {
          mode_buffer += lexeme;
        } else {
          if (new_mode.excludeBegin) {
            mode_buffer += lexeme;
          }
          processBuffer();
          if (!new_mode.returnBegin && !new_mode.excludeBegin) {
            mode_buffer = lexeme;
          }
        }
        startNewMode(new_mode, lexeme);
        return new_mode.returnBegin ? 0 : lexeme.length;
      }

      var end_mode = endOfMode(top, lexeme);
      if (end_mode) {
        var origin = top;
        if (origin.skip) {
          mode_buffer += lexeme;
        } else {
          if (!(origin.returnEnd || origin.excludeEnd)) {
            mode_buffer += lexeme;
          }
          processBuffer();
          if (origin.excludeEnd) {
            mode_buffer = lexeme;
          }
        }
        do {
          if (top.className) {
            result += spanEndTag;
          }
          if (!top.skip && !top.subLanguage) {
            relevance += top.relevance;
          }
          top = top.parent;
        } while (top !== end_mode.parent);
        if (end_mode.starts) {
          if (end_mode.endSameAsBegin) {
            end_mode.starts.endRe = end_mode.endRe;
          }
          startNewMode(end_mode.starts, '');
        }
        return origin.returnEnd ? 0 : lexeme.length;
      }

      if (isIllegal(lexeme, top))
        throw new Error('Illegal lexeme "' + lexeme + '" for mode "' + (top.className || '<unnamed>') + '"');

      /*
      Parser should not reach this point as all types of lexemes should be caught
      earlier, but if it does due to some bug make sure it advances at least one
      character forward to prevent infinite looping.
      */
      mode_buffer += lexeme;
      return lexeme.length || 1;
    }

    var language = getLanguage(name);
    if (!language) {
      throw new Error('Unknown language: "' + name + '"');
    }

    compileLanguage(language);
    var top = continuation || language;
    var continuations = {}; // keep continuations for sub-languages
    var result = '', current;
    for(current = top; current !== language; current = current.parent) {
      if (current.className) {
        result = buildSpan(current.className, '', true) + result;
      }
    }
    var mode_buffer = '';
    var relevance = 0;
    try {
      var match, count, index = 0;
      while (true) {
        top.terminators.lastIndex = index;
        match = top.terminators.exec(value);
        if (!match)
          break;
        count = processLexeme(value.substring(index, match.index), match[0]);
        index = match.index + count;
      }
      processLexeme(value.substr(index));
      for(current = top; current.parent; current = current.parent) { // close dangling modes
        if (current.className) {
          result += spanEndTag;
        }
      }
      return {
        relevance: relevance,
        value: result,
        language: name,
        top: top
      };
    } catch (e) {
      if (e.message && e.message.indexOf('Illegal') !== -1) {
        return {
          relevance: 0,
          value: escape(value)
        };
      } else {
        throw e;
      }
    }
  }

  /*
  Highlighting with language detection. Accepts a string with the code to
  highlight. Returns an object with the following properties:

  - language (detected language)
  - relevance (int)
  - value (an HTML string with highlighting markup)
  - second_best (object with the same structure for second-best heuristically
    detected language, may be absent)

  */
  function highlightAuto(text, languageSubset) {
    languageSubset = languageSubset || options.languages || objectKeys(languages);
    var result = {
      relevance: 0,
      value: escape(text)
    };
    var second_best = result;
    languageSubset.filter(getLanguage).filter(autoDetection).forEach(function(name) {
      var current = highlight(name, text, false);
      current.language = name;
      if (current.relevance > second_best.relevance) {
        second_best = current;
      }
      if (current.relevance > result.relevance) {
        second_best = result;
        result = current;
      }
    });
    if (second_best.language) {
      result.second_best = second_best;
    }
    return result;
  }

  /*
  Post-processing of the highlighted markup:

  - replace TABs with something more useful
  - replace real line-breaks with '<br>' for non-pre containers

  */
  function fixMarkup(value) {
    return !(options.tabReplace || options.useBR)
      ? value
      : value.replace(fixMarkupRe, function(match, p1) {
          if (options.useBR && match === '\n') {
            return '<br>';
          } else if (options.tabReplace) {
            return p1.replace(/\t/g, options.tabReplace);
          }
          return '';
      });
  }

  function buildClassName(prevClassName, currentLang, resultLang) {
    var language = currentLang ? aliases[currentLang] : resultLang,
        result   = [prevClassName.trim()];

    if (!prevClassName.match(/\bhljs\b/)) {
      result.push('hljs');
    }

    if (prevClassName.indexOf(language) === -1) {
      result.push(language);
    }

    return result.join(' ').trim();
  }

  /*
  Applies highlighting to a DOM node containing code. Accepts a DOM node and
  two optional parameters for fixMarkup.
  */
  function highlightBlock(block) {
    var node, originalStream, result, resultNode, text;
    var language = blockLanguage(block);

    if (isNotHighlighted(language))
        return;

    if (options.useBR) {
      node = document.createElementNS('http://www.w3.org/1999/xhtml', 'div');
      node.innerHTML = block.innerHTML.replace(/\n/g, '').replace(/<br[ \/]*>/g, '\n');
    } else {
      node = block;
    }
    text = node.textContent;
    result = language ? highlight(language, text, true) : highlightAuto(text);

    originalStream = nodeStream(node);
    if (originalStream.length) {
      resultNode = document.createElementNS('http://www.w3.org/1999/xhtml', 'div');
      resultNode.innerHTML = result.value;
      result.value = mergeStreams(originalStream, nodeStream(resultNode), text);
    }
    result.value = fixMarkup(result.value);

    block.innerHTML = result.value;
    block.className = buildClassName(block.className, language, result.language);
    block.result = {
      language: result.language,
      re: result.relevance
    };
    if (result.second_best) {
      block.second_best = {
        language: result.second_best.language,
        re: result.second_best.relevance
      };
    }
  }

  /*
  Updates highlight.js global options with values passed in the form of an object.
  */
  function configure(user_options) {
    options = inherit(options, user_options);
  }

  /*
  Applies highlighting to all <pre><code>..</code></pre> blocks on a page.
  */
  function initHighlighting() {
    if (initHighlighting.called)
      return;
    initHighlighting.called = true;

    var blocks = document.querySelectorAll('pre code');
    ArrayProto.forEach.call(blocks, highlightBlock);
  }

  /*
  Attaches highlighting to the page load event.
  */
  function initHighlightingOnLoad() {
    addEventListener('DOMContentLoaded', initHighlighting, false);
    addEventListener('load', initHighlighting, false);
  }

  function registerLanguage(name, language) {
    var lang = languages[name] = language(hljs);
    restoreLanguageApi(lang);
    if (lang.aliases) {
      lang.aliases.forEach(function(alias) {aliases[alias] = name;});
    }
  }

  function listLanguages() {
    return objectKeys(languages);
  }

  function getLanguage(name) {
    name = (name || '').toLowerCase();
    return languages[name] || languages[aliases[name]];
  }

  function autoDetection(name) {
    var lang = getLanguage(name);
    return lang && !lang.disableAutodetect;
  }

  /* Interface definition */

  hljs.highlight = highlight;
  hljs.highlightAuto = highlightAuto;
  hljs.fixMarkup = fixMarkup;
  hljs.highlightBlock = highlightBlock;
  hljs.configure = configure;
  hljs.initHighlighting = initHighlighting;
  hljs.initHighlightingOnLoad = initHighlightingOnLoad;
  hljs.registerLanguage = registerLanguage;
  hljs.listLanguages = listLanguages;
  hljs.getLanguage = getLanguage;
  hljs.autoDetection = autoDetection;
  hljs.inherit = inherit;

  // Common regexps
  hljs.IDENT_RE = '[a-zA-Z]\\w*';
  hljs.UNDERSCORE_IDENT_RE = '[a-zA-Z_]\\w*';
  hljs.NUMBER_RE = '\\b\\d+(\\.\\d+)?';
  hljs.C_NUMBER_RE = '(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)'; // 0x..., 0..., decimal, float
  hljs.BINARY_NUMBER_RE = '\\b(0b[01]+)'; // 0b...
  hljs.RE_STARTERS_RE = '!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~';

  // Common modes
  hljs.BACKSLASH_ESCAPE = {
    begin: '\\\\[\\s\\S]', relevance: 0
  };
  hljs.APOS_STRING_MODE = {
    className: 'string',
    begin: '\'', end: '\'',
    illegal: '\\n',
    contains: [hljs.BACKSLASH_ESCAPE]
  };
  hljs.QUOTE_STRING_MODE = {
    className: 'string',
    begin: '"', end: '"',
    illegal: '\\n',
    contains: [hljs.BACKSLASH_ESCAPE]
  };
  hljs.PHRASAL_WORDS_MODE = {
    begin: /\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/
  };
  hljs.COMMENT = function (begin, end, inherits) {
    var mode = hljs.inherit(
      {
        className: 'comment',
        begin: begin, end: end,
        contains: []
      },
      inherits || {}
    );
    mode.contains.push(hljs.PHRASAL_WORDS_MODE);
    mode.contains.push({
      className: 'doctag',
      begin: '(?:TODO|FIXME|NOTE|BUG|XXX):',
      relevance: 0
    });
    return mode;
  };
  hljs.C_LINE_COMMENT_MODE = hljs.COMMENT('//', '$');
  hljs.C_BLOCK_COMMENT_MODE = hljs.COMMENT('/\\*', '\\*/');
  hljs.HASH_COMMENT_MODE = hljs.COMMENT('#', '$');
  hljs.NUMBER_MODE = {
    className: 'number',
    begin: hljs.NUMBER_RE,
    relevance: 0
  };
  hljs.C_NUMBER_MODE = {
    className: 'number',
    begin: hljs.C_NUMBER_RE,
    relevance: 0
  };
  hljs.BINARY_NUMBER_MODE = {
    className: 'number',
    begin: hljs.BINARY_NUMBER_RE,
    relevance: 0
  };
  hljs.CSS_NUMBER_MODE = {
    className: 'number',
    begin: hljs.NUMBER_RE + '(' +
      '%|em|ex|ch|rem'  +
      '|vw|vh|vmin|vmax' +
      '|cm|mm|in|pt|pc|px' +
      '|deg|grad|rad|turn' +
      '|s|ms' +
      '|Hz|kHz' +
      '|dpi|dpcm|dppx' +
      ')?',
    relevance: 0
  };
  hljs.REGEXP_MODE = {
    className: 'regexp',
    begin: /\//, end: /\/[gimuy]*/,
    illegal: /\n/,
    contains: [
      hljs.BACKSLASH_ESCAPE,
      {
        begin: /\[/, end: /\]/,
        relevance: 0,
        contains: [hljs.BACKSLASH_ESCAPE]
      }
    ]
  };
  hljs.TITLE_MODE = {
    className: 'title',
    begin: hljs.IDENT_RE,
    relevance: 0
  };
  hljs.UNDERSCORE_TITLE_MODE = {
    className: 'title',
    begin: hljs.UNDERSCORE_IDENT_RE,
    relevance: 0
  };
  hljs.METHOD_GUARD = {
    // excludes method names from keyword processing
    begin: '\\.\\s*' + hljs.UNDERSCORE_IDENT_RE,
    relevance: 0
  };

  return hljs;
}));

},{}],7:[function(require,module,exports){
module.exports = function(hljs) {
  var CPP_PRIMITIVE_TYPES = {
    className: 'keyword',
    begin: '\\b[a-z\\d_]*_t\\b'
  };

  var STRINGS = {
    className: 'string',
    variants: [
      {
        begin: '(u8?|U|L)?"', end: '"',
        illegal: '\\n',
        contains: [hljs.BACKSLASH_ESCAPE]
      },
      { begin: /(?:u8?|U|L)?R"([^()\\ ]{0,16})\((?:.|\n)*?\)\1"/ },
      {
        begin: '\'\\\\?.', end: '\'',
        illegal: '.'
      }
    ]
  };

  var NUMBERS = {
    className: 'number',
    variants: [
      { begin: '\\b(0b[01\']+)' },
      { begin: '(-?)\\b([\\d\']+(\\.[\\d\']*)?|\\.[\\d\']+)(u|U|l|L|ul|UL|f|F|b|B)' },
      { begin: '(-?)(\\b0[xX][a-fA-F0-9\']+|(\\b[\\d\']+(\\.[\\d\']*)?|\\.[\\d\']+)([eE][-+]?[\\d\']+)?)' }
    ],
    relevance: 0
  };

  var PREPROCESSOR =       {
    className: 'meta',
    begin: /#\s*[a-z]+\b/, end: /$/,
    keywords: {
      'meta-keyword':
        'if else elif endif define undef warning error line ' +
        'pragma ifdef ifndef include'
    },
    contains: [
      {
        begin: /\\\n/, relevance: 0
      },
      hljs.inherit(STRINGS, {className: 'meta-string'}),
      {
        className: 'meta-string',
        begin: /<[^\n>]*>/, end: /$/,
        illegal: '\\n',
      },
      hljs.C_LINE_COMMENT_MODE,
      hljs.C_BLOCK_COMMENT_MODE
    ]
  };

  var FUNCTION_TITLE = hljs.IDENT_RE + '\\s*\\(';

  var CPP_KEYWORDS = {
    keyword: 'int float while private char catch import module export virtual operator sizeof ' +
      'dynamic_cast|10 typedef const_cast|10 const for static_cast|10 union namespace ' +
      'unsigned long volatile static protected bool template mutable if public friend ' +
      'do goto auto void enum else break extern using asm case typeid ' +
      'short reinterpret_cast|10 default double register explicit signed typename try this ' +
      'switch continue inline delete alignof constexpr decltype ' +
      'noexcept static_assert thread_local restrict _Bool complex _Complex _Imaginary ' +
      'atomic_bool atomic_char atomic_schar ' +
      'atomic_uchar atomic_short atomic_ushort atomic_int atomic_uint atomic_long atomic_ulong atomic_llong ' +
      'atomic_ullong new throw return ' +
      'and or not',
    built_in: 'std string cin cout cerr clog stdin stdout stderr stringstream istringstream ostringstream ' +
      'auto_ptr deque list queue stack vector map set bitset multiset multimap unordered_set ' +
      'unordered_map unordered_multiset unordered_multimap array shared_ptr abort abs acos ' +
      'asin atan2 atan calloc ceil cosh cos exit exp fabs floor fmod fprintf fputs free frexp ' +
      'fscanf isalnum isalpha iscntrl isdigit isgraph islower isprint ispunct isspace isupper ' +
      'isxdigit tolower toupper labs ldexp log10 log malloc realloc memchr memcmp memcpy memset modf pow ' +
      'printf putchar puts scanf sinh sin snprintf sprintf sqrt sscanf strcat strchr strcmp ' +
      'strcpy strcspn strlen strncat strncmp strncpy strpbrk strrchr strspn strstr tanh tan ' +
      'vfprintf vprintf vsprintf endl initializer_list unique_ptr',
    literal: 'true false nullptr NULL'
  };

  var EXPRESSION_CONTAINS = [
    CPP_PRIMITIVE_TYPES,
    hljs.C_LINE_COMMENT_MODE,
    hljs.C_BLOCK_COMMENT_MODE,
    NUMBERS,
    STRINGS
  ];

  return {
    aliases: ['c', 'cc', 'h', 'c++', 'h++', 'hpp', 'hh', 'hxx', 'cxx'],
    keywords: CPP_KEYWORDS,
    illegal: '</',
    contains: EXPRESSION_CONTAINS.concat([
      PREPROCESSOR,
      {
        begin: '\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<', end: '>',
        keywords: CPP_KEYWORDS,
        contains: ['self', CPP_PRIMITIVE_TYPES]
      },
      {
        begin: hljs.IDENT_RE + '::',
        keywords: CPP_KEYWORDS
      },
      {
        // This mode covers expression context where we can't expect a function
        // definition and shouldn't highlight anything that looks like one:
        // `return some()`, `else if()`, `(x*sum(1, 2))`
        variants: [
          {begin: /=/, end: /;/},
          {begin: /\(/, end: /\)/},
          {beginKeywords: 'new throw return else', end: /;/}
        ],
        keywords: CPP_KEYWORDS,
        contains: EXPRESSION_CONTAINS.concat([
          {
            begin: /\(/, end: /\)/,
            keywords: CPP_KEYWORDS,
            contains: EXPRESSION_CONTAINS.concat(['self']),
            relevance: 0
          }
        ]),
        relevance: 0
      },
      {
        className: 'function',
        begin: '(' + hljs.IDENT_RE + '[\\*&\\s]+)+' + FUNCTION_TITLE,
        returnBegin: true, end: /[{;=]/,
        excludeEnd: true,
        keywords: CPP_KEYWORDS,
        illegal: /[^\w\s\*&]/,
        contains: [
          {
            begin: FUNCTION_TITLE, returnBegin: true,
            contains: [hljs.TITLE_MODE],
            relevance: 0
          },
          {
            className: 'params',
            begin: /\(/, end: /\)/,
            keywords: CPP_KEYWORDS,
            relevance: 0,
            contains: [
              hljs.C_LINE_COMMENT_MODE,
              hljs.C_BLOCK_COMMENT_MODE,
              STRINGS,
              NUMBERS,
              CPP_PRIMITIVE_TYPES,
              // Count matching parentheses.
              {
                begin: /\(/, end: /\)/,
                keywords: CPP_KEYWORDS,
                relevance: 0,
                contains: [
                  'self',
                  hljs.C_LINE_COMMENT_MODE,
                  hljs.C_BLOCK_COMMENT_MODE,
                  STRINGS,
                  NUMBERS,
                  CPP_PRIMITIVE_TYPES
                ]
              }
            ]
          },
          hljs.C_LINE_COMMENT_MODE,
          hljs.C_BLOCK_COMMENT_MODE,
          PREPROCESSOR
        ]
      },
      {
        className: 'class',
        beginKeywords: 'class struct', end: /[{;:]/,
        contains: [
          {begin: /</, end: />/, contains: ['self']}, // skip generic stuff
          hljs.TITLE_MODE
        ]
      }
    ]),
    exports: {
      preprocessor: PREPROCESSOR,
      strings: STRINGS,
      keywords: CPP_KEYWORDS
    }
  };
};
},{}],8:[function(require,module,exports){
/**
 * lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="npm" -o ./`
 * Copyright jQuery Foundation and other contributors <https://jquery.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */

/** Used as references for various `Number` constants. */
var INFINITY = 1 / 0,
    MAX_SAFE_INTEGER = 9007199254740991,
    MAX_INTEGER = 1.7976931348623157e+308,
    NAN = 0 / 0;

/** `Object#toString` result references. */
var funcTag = '[object Function]',
    genTag = '[object GeneratorFunction]',
    symbolTag = '[object Symbol]';

/** Used to match leading and trailing whitespace. */
var reTrim = /^\s+|\s+$/g;

/** Used to detect bad signed hexadecimal string values. */
var reIsBadHex = /^[-+]0x[0-9a-f]+$/i;

/** Used to detect binary string values. */
var reIsBinary = /^0b[01]+$/i;

/** Used to detect octal string values. */
var reIsOctal = /^0o[0-7]+$/i;

/** Used to detect unsigned integer values. */
var reIsUint = /^(?:0|[1-9]\d*)$/;

/** Built-in method references without a dependency on `root`. */
var freeParseInt = parseInt;

/** Used for built-in method references. */
var objectProto = Object.prototype;

/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */
var objectToString = objectProto.toString;

/* Built-in method references for those with the same name as other `lodash` methods. */
var nativeCeil = Math.ceil,
    nativeMax = Math.max;

/**
 * The base implementation of `_.range` and `_.rangeRight` which doesn't
 * coerce arguments.
 *
 * @private
 * @param {number} start The start of the range.
 * @param {number} end The end of the range.
 * @param {number} step The value to increment or decrement by.
 * @param {boolean} [fromRight] Specify iterating from right to left.
 * @returns {Array} Returns the range of numbers.
 */
function baseRange(start, end, step, fromRight) {
  var index = -1,
      length = nativeMax(nativeCeil((end - start) / (step || 1)), 0),
      result = Array(length);

  while (length--) {
    result[fromRight ? length : ++index] = start;
    start += step;
  }
  return result;
}

/**
 * Creates a `_.range` or `_.rangeRight` function.
 *
 * @private
 * @param {boolean} [fromRight] Specify iterating from right to left.
 * @returns {Function} Returns the new range function.
 */
function createRange(fromRight) {
  return function(start, end, step) {
    if (step && typeof step != 'number' && isIterateeCall(start, end, step)) {
      end = step = undefined;
    }
    // Ensure the sign of `-0` is preserved.
    start = toFinite(start);
    if (end === undefined) {
      end = start;
      start = 0;
    } else {
      end = toFinite(end);
    }
    step = step === undefined ? (start < end ? 1 : -1) : toFinite(step);
    return baseRange(start, end, step, fromRight);
  };
}

/**
 * Checks if `value` is a valid array-like index.
 *
 * @private
 * @param {*} value The value to check.
 * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.
 * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.
 */
function isIndex(value, length) {
  length = length == null ? MAX_SAFE_INTEGER : length;
  return !!length &&
    (typeof value == 'number' || reIsUint.test(value)) &&
    (value > -1 && value % 1 == 0 && value < length);
}

/**
 * Checks if the given arguments are from an iteratee call.
 *
 * @private
 * @param {*} value The potential iteratee value argument.
 * @param {*} index The potential iteratee index or key argument.
 * @param {*} object The potential iteratee object argument.
 * @returns {boolean} Returns `true` if the arguments are from an iteratee call,
 *  else `false`.
 */
function isIterateeCall(value, index, object) {
  if (!isObject(object)) {
    return false;
  }
  var type = typeof index;
  if (type == 'number'
        ? (isArrayLike(object) && isIndex(index, object.length))
        : (type == 'string' && index in object)
      ) {
    return eq(object[index], value);
  }
  return false;
}

/**
 * Performs a
 * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
 * comparison between two values to determine if they are equivalent.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
 * @example
 *
 * var object = { 'a': 1 };
 * var other = { 'a': 1 };
 *
 * _.eq(object, object);
 * // => true
 *
 * _.eq(object, other);
 * // => false
 *
 * _.eq('a', 'a');
 * // => true
 *
 * _.eq('a', Object('a'));
 * // => false
 *
 * _.eq(NaN, NaN);
 * // => true
 */
function eq(value, other) {
  return value === other || (value !== value && other !== other);
}

/**
 * Checks if `value` is array-like. A value is considered array-like if it's
 * not a function and has a `value.length` that's an integer greater than or
 * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is array-like, else `false`.
 * @example
 *
 * _.isArrayLike([1, 2, 3]);
 * // => true
 *
 * _.isArrayLike(document.body.children);
 * // => true
 *
 * _.isArrayLike('abc');
 * // => true
 *
 * _.isArrayLike(_.noop);
 * // => false
 */
function isArrayLike(value) {
  return value != null && isLength(value.length) && !isFunction(value);
}

/**
 * Checks if `value` is classified as a `Function` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a function, else `false`.
 * @example
 *
 * _.isFunction(_);
 * // => true
 *
 * _.isFunction(/abc/);
 * // => false
 */
function isFunction(value) {
  // The use of `Object#toString` avoids issues with the `typeof` operator
  // in Safari 8-9 which returns 'object' for typed array and other constructors.
  var tag = isObject(value) ? objectToString.call(value) : '';
  return tag == funcTag || tag == genTag;
}

/**
 * Checks if `value` is a valid array-like length.
 *
 * **Note:** This method is loosely based on
 * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.
 * @example
 *
 * _.isLength(3);
 * // => true
 *
 * _.isLength(Number.MIN_VALUE);
 * // => false
 *
 * _.isLength(Infinity);
 * // => false
 *
 * _.isLength('3');
 * // => false
 */
function isLength(value) {
  return typeof value == 'number' &&
    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;
}

/**
 * Checks if `value` is the
 * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)
 * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an object, else `false`.
 * @example
 *
 * _.isObject({});
 * // => true
 *
 * _.isObject([1, 2, 3]);
 * // => true
 *
 * _.isObject(_.noop);
 * // => true
 *
 * _.isObject(null);
 * // => false
 */
function isObject(value) {
  var type = typeof value;
  return !!value && (type == 'object' || type == 'function');
}

/**
 * Checks if `value` is object-like. A value is object-like if it's not `null`
 * and has a `typeof` result of "object".
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is object-like, else `false`.
 * @example
 *
 * _.isObjectLike({});
 * // => true
 *
 * _.isObjectLike([1, 2, 3]);
 * // => true
 *
 * _.isObjectLike(_.noop);
 * // => false
 *
 * _.isObjectLike(null);
 * // => false
 */
function isObjectLike(value) {
  return !!value && typeof value == 'object';
}

/**
 * Checks if `value` is classified as a `Symbol` primitive or object.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.
 * @example
 *
 * _.isSymbol(Symbol.iterator);
 * // => true
 *
 * _.isSymbol('abc');
 * // => false
 */
function isSymbol(value) {
  return typeof value == 'symbol' ||
    (isObjectLike(value) && objectToString.call(value) == symbolTag);
}

/**
 * Converts `value` to a finite number.
 *
 * @static
 * @memberOf _
 * @since 4.12.0
 * @category Lang
 * @param {*} value The value to convert.
 * @returns {number} Returns the converted number.
 * @example
 *
 * _.toFinite(3.2);
 * // => 3.2
 *
 * _.toFinite(Number.MIN_VALUE);
 * // => 5e-324
 *
 * _.toFinite(Infinity);
 * // => 1.7976931348623157e+308
 *
 * _.toFinite('3.2');
 * // => 3.2
 */
function toFinite(value) {
  if (!value) {
    return value === 0 ? value : 0;
  }
  value = toNumber(value);
  if (value === INFINITY || value === -INFINITY) {
    var sign = (value < 0 ? -1 : 1);
    return sign * MAX_INTEGER;
  }
  return value === value ? value : 0;
}

/**
 * Converts `value` to a number.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to process.
 * @returns {number} Returns the number.
 * @example
 *
 * _.toNumber(3.2);
 * // => 3.2
 *
 * _.toNumber(Number.MIN_VALUE);
 * // => 5e-324
 *
 * _.toNumber(Infinity);
 * // => Infinity
 *
 * _.toNumber('3.2');
 * // => 3.2
 */
function toNumber(value) {
  if (typeof value == 'number') {
    return value;
  }
  if (isSymbol(value)) {
    return NAN;
  }
  if (isObject(value)) {
    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;
    value = isObject(other) ? (other + '') : other;
  }
  if (typeof value != 'string') {
    return value === 0 ? value : +value;
  }
  value = value.replace(reTrim, '');
  var isBinary = reIsBinary.test(value);
  return (isBinary || reIsOctal.test(value))
    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)
    : (reIsBadHex.test(value) ? NAN : +value);
}

/**
 * Creates an array of numbers (positive and/or negative) progressing from
 * `start` up to, but not including, `end`. A step of `-1` is used if a negative
 * `start` is specified without an `end` or `step`. If `end` is not specified,
 * it's set to `start` with `start` then set to `0`.
 *
 * **Note:** JavaScript follows the IEEE-754 standard for resolving
 * floating-point values which can produce unexpected results.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Util
 * @param {number} [start=0] The start of the range.
 * @param {number} end The end of the range.
 * @param {number} [step=1] The value to increment or decrement by.
 * @returns {Array} Returns the range of numbers.
 * @see _.inRange, _.rangeRight
 * @example
 *
 * _.range(4);
 * // => [0, 1, 2, 3]
 *
 * _.range(-4);
 * // => [0, -1, -2, -3]
 *
 * _.range(1, 5);
 * // => [1, 2, 3, 4]
 *
 * _.range(0, 20, 5);
 * // => [0, 5, 10, 15]
 *
 * _.range(0, -4, -1);
 * // => [0, -1, -2, -3]
 *
 * _.range(1, 4, 0);
 * // => [1, 1, 1]
 *
 * _.range(0);
 * // => []
 */
var range = createRange();

module.exports = range;

},{}],9:[function(require,module,exports){
'use strict';

function isObject (o) {
    return o && Object.prototype.toString.call(o) === '[object Object]';
}

function indent (txt) {
    var arr, res = [];

    if (typeof txt !== 'string') {
        return txt;
    }

    arr = txt.split('\n');

    if (arr.length === 1) {
        return '  ' + txt;
    }

    arr.forEach(function (e) {
        if (e.trim() === '') {
            res.push(e);
            return;
        }
        res.push('  ' + e);
    });

    return res.join('\n');
}

function clean (txt) {
    var arr = txt.split('\n');
    var res = [];
    arr.forEach(function (e) {
        if (e.trim() === '') {
            return;
        }
        res.push(e);
    });
    return res.join('\n');
}

function stringify (a) {
    var res, body, isEmpty, isFlat;

    body = '';
    isFlat = true;
    isEmpty = a.some(function (e, i, arr) {
        if (i === 0) {
            res = '<' + e;
            if (arr.length === 1) {
                return true;
            }
            return;
        }

        if (i === 1) {
            if (isObject(e)) {
                Object.keys(e).forEach(function (key) {
                    res += ' ' + key + '="' + e[key] + '"';
                });
                if (arr.length === 2) {
                    return true;
                }
                res += '>';
                return;
            } else {
                res += '>';
            }
        }

        switch (typeof e) {
        case 'string':
        case 'number':
        case 'boolean':
            body += e + '\n';
            return;
        }

        isFlat = false;
        body += stringify(e);
    });

    if (isEmpty) {
        return res + '/>\n'; // short form
    } else {
        if (isFlat) {
            return res + clean(body) + '</' + a[0] + '>\n';
        } else {
            return res + '\n' + indent(body) + '</' + a[0] + '>\n';
        }
    }
}

module.exports = stringify;

},{}],10:[function(require,module,exports){
'use strict';

var parse = require('./parse'),
    reparse = require('./reparse');

exports.parse = parse;
exports.reparse = reparse;

},{"./parse":11,"./reparse":12}],11:[function(require,module,exports){
'use strict';

var token = /<o>|<ins>|<s>|<sub>|<sup>|<b>|<i>|<tt>|<\/o>|<\/ins>|<\/s>|<\/sub>|<\/sup>|<\/b>|<\/i>|<\/tt>/;

function update (s, cmd) {
    if (cmd.add) {
        cmd.add.split(';').forEach(function (e) {
            var arr = e.split(' ');
            s[arr[0]][arr[1]] = true;
        });
    }
    if (cmd.del) {
        cmd.del.split(';').forEach(function (e) {
            var arr = e.split(' ');
            delete s[arr[0]][arr[1]];
        });
    }
}

var trans = {
    '<o>'    : { add: 'text-decoration overline' },
    '</o>'   : { del: 'text-decoration overline' },

    '<ins>'  : { add: 'text-decoration underline' },
    '</ins>' : { del: 'text-decoration underline' },

    '<s>'    : { add: 'text-decoration line-through' },
    '</s>'   : { del: 'text-decoration line-through' },

    '<b>'    : { add: 'font-weight bold' },
    '</b>'   : { del: 'font-weight bold' },

    '<i>'    : { add: 'font-style italic' },
    '</i>'   : { del: 'font-style italic' },

    '<sub>'  : { add: 'baseline-shift sub;font-size .7em' },
    '</sub>' : { del: 'baseline-shift sub;font-size .7em' },

    '<sup>'  : { add: 'baseline-shift super;font-size .7em' },
    '</sup>' : { del: 'baseline-shift super;font-size .7em' },

    '<tt>'   : { add: 'font-family monospace' },
    '</tt>'  : { del: 'font-family monospace' }
};

function dump (s) {
    return Object.keys(s).reduce(function (pre, cur) {
        var keys = Object.keys(s[cur]);
        if (keys.length > 0) {
            pre[cur] = keys.join(' ');
        }
        return pre;
    }, {});
}

function parse (str) {
    var state, res, i, m, a;

    if (str === undefined) {
        return [];
    }

    if (typeof str === 'number') {
        return [str + ''];
    }

    if (typeof str !== 'string') {
        return [str];
    }

    res = [];

    state = {
        'text-decoration': {},
        'font-weight': {},
        'font-style': {},
        'baseline-shift': {},
        'font-size': {},
        'font-family': {}
    };

    while (true) {
        i = str.search(token);

        if (i === -1) {
            res.push(['tspan', dump(state), str]);
            return res;
        }

        if (i > 0) {
            a = str.slice(0, i);
            res.push(['tspan', dump(state), a]);
        }

        m = str.match(token)[0];

        update(state, trans[m]);

        str = str.slice(i + m.length);

        if (str.length === 0) {
            return res;
        }
    }
}

module.exports = parse;
/* eslint no-constant-condition: 0 */

},{}],12:[function(require,module,exports){
'use strict';

var parse = require('./parse');

function deDash (str) {
    var m = str.match(/(\w+)-(\w)(\w+)/);
    if (m === null) {
        return str;
    }
    var newStr = m[1] + m[2].toUpperCase() + m[3];
    return newStr;
}

function reparse (React) {

    var $ = React.createElement;

    function reTspan (e, i) {
        var tag = e[0];
        var attr = e[1];

        var newAttr = Object.keys(attr).reduce(function (res, key) {
            var newKey = deDash(key);
            res[newKey] = attr[key];
            return res;
        }, {});

        var body = e[2];
        newAttr.key = i;
        return $(tag, newAttr, body);
    }

    return function (str) {
        return parse(str).map(reTspan);
    };
}

module.exports = reparse;

},{"./parse":11}],13:[function(require,module,exports){
'use strict';

function appendSaveAsDialog (index, output) {
    var div;
    var menu;

    function closeMenu(e) {
        var left = parseInt(menu.style.left, 10);
        var top = parseInt(menu.style.top, 10);
        if (
            e.x < left ||
            e.x > (left + menu.offsetWidth) ||
            e.y < top ||
            e.y > (top + menu.offsetHeight)
        ) {
            menu.parentNode.removeChild(menu);
            document.body.removeEventListener('mousedown', closeMenu, false);
        }
    }

    div = document.getElementById(output + index);

    div.childNodes[0].addEventListener('contextmenu',
        function (e) {
            var list, savePng, saveSvg;

            menu = document.createElement('div');

            menu.className = 'wavedromMenu';
            menu.style.top = e.y + 'px';
            menu.style.left = e.x + 'px';

            list = document.createElement('ul');
            savePng = document.createElement('li');
            savePng.innerHTML = 'Save as PNG';
            list.appendChild(savePng);

            saveSvg = document.createElement('li');
            saveSvg.innerHTML = 'Save as SVG';
            list.appendChild(saveSvg);

            //var saveJson = document.createElement('li');
            //saveJson.innerHTML = 'Save as JSON';
            //list.appendChild(saveJson);

            menu.appendChild(list);

            document.body.appendChild(menu);

            savePng.addEventListener('click',
                function () {
                    var html, firstDiv, svgdata, img, canvas, context, pngdata, a;

                    html = '';
                    if (index !== 0) {
                        firstDiv = document.getElementById(output + 0);
                        html += firstDiv.innerHTML.substring(166, firstDiv.innerHTML.indexOf('<g id="waves_0">'));
                    }
                    html = [div.innerHTML.slice(0, 166), html, div.innerHTML.slice(166)].join('');
                    svgdata = 'data:image/svg+xml;base64,' + btoa(html);
                    img = new Image();
                    img.src = svgdata;
                    canvas = document.createElement('canvas');
                    canvas.width = img.width;
                    canvas.height = img.height;
                    context = canvas.getContext('2d');
                    context.drawImage(img, 0, 0);

                    pngdata = canvas.toDataURL('image/png');

                    a = document.createElement('a');
                    a.href = pngdata;
                    a.download = 'wavedrom.png';
                    a.click();

                    menu.parentNode.removeChild(menu);
                    document.body.removeEventListener('mousedown', closeMenu, false);
                },
                false
            );

            saveSvg.addEventListener('click',
                function () {
                    var html,
                        firstDiv,
                        svgdata,
                        a;

                    html = '';
                    if (index !== 0) {
                        firstDiv = document.getElementById(output + 0);
                        html += firstDiv.innerHTML.substring(166, firstDiv.innerHTML.indexOf('<g id="waves_0">'));
                    }
                    html = [div.innerHTML.slice(0, 166), html, div.innerHTML.slice(166)].join('');
                    svgdata = 'data:image/svg+xml;base64,' + btoa(html);

                    a = document.createElement('a');
                    a.href = svgdata;
                    a.download = 'wavedrom.svg';
                    a.click();

                    menu.parentNode.removeChild(menu);
                    document.body.removeEventListener('mousedown', closeMenu, false);
                },
                false
            );

            menu.addEventListener('contextmenu',
                function (ee) {
                    ee.preventDefault();
                },
                false
            );

            document.body.addEventListener('mousedown', closeMenu, false);

            e.preventDefault();
        },
        false
    );
}

module.exports = appendSaveAsDialog;

},{}],14:[function(require,module,exports){
'use strict';

var // obj2ml = require('./obj2ml'),
    jsonmlParse = require('./jsonml-parse');

// function createElement (obj) {
//     var el;
//
//     el = document.createElement('g');
//     el.innerHTML = obj2ml(obj);
//     return el.firstChild;
// }

module.exports = jsonmlParse;
// module.exports = createElement;

},{"./jsonml-parse":27}],15:[function(require,module,exports){
'use strict';

var eva = require('./eva'),
    renderWaveForm = require('./render-wave-form');

function editorRefresh () {
    // var svg,
    // ser,
    // ssvg,
    // asvg,
    // sjson,
    // ajson;

    renderWaveForm(0, eva('InputJSON_0'), 'WaveDrom_Display_');

    /*
    svg = document.getElementById('svgcontent_0');
    ser = new XMLSerializer();
    ssvg = '<?xml version='1.0' standalone='no'?>\n' +
    '<!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'>\n' +
    '<!-- Created with WaveDrom -->\n' +
    ser.serializeToString(svg);

    asvg = document.getElementById('download_svg');
    asvg.href = 'data:image/svg+xml;base64,' + window.btoa(ssvg);

    sjson = localStorage.waveform;
    ajson = document.getElementById('download_json');
    ajson.href = 'data:text/json;base64,' + window.btoa(sjson);
    */
}

module.exports = editorRefresh;

},{"./eva":16,"./render-wave-form":42}],16:[function(require,module,exports){
'use strict';

function eva (id) {
    var TheTextBox, source;

    function erra (e) {
        return { signal: [{ name: ['tspan', ['tspan', {class:'error h5'}, 'Error: '], e.message] }]};
    }

    TheTextBox = document.getElementById(id);

    /* eslint-disable no-eval */
    if (TheTextBox.type && TheTextBox.type === 'textarea') {
        try { source = eval('(' + TheTextBox.value + ')'); } catch (e) { return erra(e); }
    } else {
        try { source = eval('(' + TheTextBox.innerHTML + ')'); } catch (e) { return erra(e); }
    }
    /* eslint-enable  no-eval */

    if (Object.prototype.toString.call(source) !== '[object Object]') {
        return erra({ message: '[Semantic]: The root has to be an Object: "{signal:[...]}"'});
    }
    if (source.signal) {
        if (Object.prototype.toString.call(source.signal) !== '[object Array]') {
            return erra({ message: '[Semantic]: "signal" object has to be an Array "signal:[]"'});
        }
    } else if (source.assign) {
        if (Object.prototype.toString.call(source.assign) !== '[object Array]') {
            return erra({ message: '[Semantic]: "assign" object hasto be an Array "assign:[]"'});
        }
    } else if (source.reg) {
        // test register
    } else {
        return erra({ message: '[Semantic]: "signal:[...]" or "assign:[...]" property is missing inside the root Object'});
    }
    return source;
}

module.exports = eva;

},{}],17:[function(require,module,exports){
'use strict';

function findLaneMarkers (lanetext) {
    var gcount = 0,
        lcount = 0,
        ret = [];

    lanetext.forEach(function (e) {
        if (
            (e === 'vvv-2') ||
            (e === 'vvv-3') ||
            (e === 'vvv-4') ||
            (e === 'vvv-5')
        ) {
            lcount += 1;
        } else {
            if (lcount !== 0) {
                ret.push(gcount - ((lcount + 1) / 2));
                lcount = 0;
            }
        }
        gcount += 1;

    });

    if (lcount !== 0) {
        ret.push(gcount - ((lcount + 1) / 2));
    }

    return ret;
}

module.exports = findLaneMarkers;

},{}],18:[function(require,module,exports){
'use strict';

function genBrick (texts, extra, times) {
    var i, j, R = [];

    if (texts.length === 4) {
        for (j = 0; j < times; j += 1) {
            R.push(texts[0]);
            for (i = 0; i < extra; i += 1) {
                R.push(texts[1]);
            }
            R.push(texts[2]);
            for (i = 0; i < extra; i += 1) {
                R.push(texts[3]);
            }
        }
        return R;
    }
    if (texts.length === 1) {
        texts.push(texts[0]);
    }
    R.push(texts[0]);
    for (i = 0; i < (times * (2 * (extra + 1)) - 1); i += 1) {
        R.push(texts[1]);
    }
    return R;
}

module.exports = genBrick;

},{}],19:[function(require,module,exports){
'use strict';

var genBrick = require('./gen-brick');

function genFirstWaveBrick (text, extra, times) {
    var tmp;

    tmp = [];
    switch (text) {
    case 'p': tmp = genBrick(['pclk', '111', 'nclk', '000'], extra, times); break;
    case 'n': tmp = genBrick(['nclk', '000', 'pclk', '111'], extra, times); break;
    case 'P': tmp = genBrick(['Pclk', '111', 'nclk', '000'], extra, times); break;
    case 'N': tmp = genBrick(['Nclk', '000', 'pclk', '111'], extra, times); break;
    case 'l':
    case 'L':
    case '0': tmp = genBrick(['000'], extra, times); break;
    case 'h':
    case 'H':
    case '1': tmp = genBrick(['111'], extra, times); break;
    case '=': tmp = genBrick(['vvv-2'], extra, times); break;
    case '2': tmp = genBrick(['vvv-2'], extra, times); break;
    case '3': tmp = genBrick(['vvv-3'], extra, times); break;
    case '4': tmp = genBrick(['vvv-4'], extra, times); break;
    case '5': tmp = genBrick(['vvv-5'], extra, times); break;
    case 'd': tmp = genBrick(['ddd'], extra, times); break;
    case 'u': tmp = genBrick(['uuu'], extra, times); break;
    case 'z': tmp = genBrick(['zzz'], extra, times); break;
    default:  tmp = genBrick(['xxx'], extra, times); break;
    }
    return tmp;
}

module.exports = genFirstWaveBrick;

},{"./gen-brick":18}],20:[function(require,module,exports){
'use strict';

var genBrick = require('./gen-brick');

function genWaveBrick (text, extra, times) {
    var x1, x2, x3, y1, y2, x4, x5, x6, xclude, atext, tmp0, tmp1, tmp2, tmp3, tmp4;

    x1 = {p:'pclk', n:'nclk', P:'Pclk', N:'Nclk', h:'pclk', l:'nclk', H:'Pclk', L:'Nclk'};

    x2 = {
        '0':'0', '1':'1',
        'x':'x',
        'd':'d',
        'u':'u',
        'z':'z',
        '=':'v',  '2':'v',  '3':'v',  '4':'v', '5':'v'
    };

    x3 = {
        '0': '', '1': '',
        'x': '',
        'd': '',
        'u': '',
        'z': '',
        '=':'-2', '2':'-2', '3':'-3', '4':'-4', '5':'-5'
    };

    y1 = {
        'p':'0', 'n':'1',
        'P':'0', 'N':'1',
        'h':'1', 'l':'0',
        'H':'1', 'L':'0',
        '0':'0', '1':'1',
        'x':'x',
        'd':'d',
        'u':'u',
        'z':'z',
        '=':'v', '2':'v', '3':'v', '4':'v', '5':'v'
    };

    y2 = {
        'p': '', 'n': '',
        'P': '', 'N': '',
        'h': '', 'l': '',
        'H': '', 'L': '',
        '0': '', '1': '',
        'x': '',
        'd': '',
        'u': '',
        'z': '',
        '=':'-2', '2':'-2', '3':'-3', '4':'-4', '5':'-5'
    };

    x4 = {
        'p': '111', 'n': '000',
        'P': '111', 'N': '000',
        'h': '111', 'l': '000',
        'H': '111', 'L': '000',
        '0': '000', '1': '111',
        'x': 'xxx',
        'd': 'ddd',
        'u': 'uuu',
        'z': 'zzz',
        '=': 'vvv-2', '2': 'vvv-2', '3': 'vvv-3', '4': 'vvv-4', '5': 'vvv-5'
    };

    x5 = {
        p:'nclk', n:'pclk', P:'nclk', N:'pclk'
    };

    x6 = {
        p: '000', n: '111', P: '000', N: '111'
    };

    xclude = {
        'hp':'111', 'Hp':'111', 'ln': '000', 'Ln': '000', 'nh':'111', 'Nh':'111', 'pl': '000', 'Pl':'000'
    };

    atext = text.split('');
    //if (atext.length !== 2) { return genBrick(['xxx'], extra, times); }

    tmp0 = x4[atext[1]];
    tmp1 = x1[atext[1]];
    if (tmp1 === undefined) {
        tmp2 = x2[atext[1]];
        if (tmp2 === undefined) {
            // unknown
            return genBrick(['xxx'], extra, times);
        } else {
            tmp3 = y1[atext[0]];
            if (tmp3 === undefined) {
                // unknown
                return genBrick(['xxx'], extra, times);
            }
            // soft curves
            return genBrick([tmp3 + 'm' + tmp2 + y2[atext[0]] + x3[atext[1]], tmp0], extra, times);
        }
    } else {
        tmp4 = xclude[text];
        if (tmp4 !== undefined) {
            tmp1 = tmp4;
        }
        // sharp curves
        tmp2 = x5[atext[1]];
        if (tmp2 === undefined) {
            // hlHL
            return genBrick([tmp1, tmp0], extra, times);
        } else {
            // pnPN
            return genBrick([tmp1, tmp0, tmp2, x6[atext[1]]], extra, times);
        }
    }
}

module.exports = genWaveBrick;

},{"./gen-brick":18}],21:[function(require,module,exports){
'use strict';

var processAll = require('./process-all');
var eva = require('./eva');
var renderWaveForm = require('./render-wave-form');
var renderWaveElement = require('./render-wave-element');
var editorRefresh = require('./editor-refresh');
var def = require('../skins/default.js');

exports.processAll = processAll;
exports.eva = eva;
exports.renderWaveForm = renderWaveForm;
exports.renderWaveElement = renderWaveElement;
exports.editorRefresh = editorRefresh;
exports.waveSkin = {
    default: def
};

},{"../skins/default.js":45,"./editor-refresh":15,"./eva":16,"./process-all":33,"./render-wave-element":41,"./render-wave-form":42}],22:[function(require,module,exports){
'use strict';

var jsonmlParse = require('./create-element'),
    w3 = require('./w3');

function insertSVGTemplateAssign (index, parent) {
    var node, e;
    // cleanup
    while (parent.childNodes.length) {
        parent.removeChild(parent.childNodes[0]);
    }
    e =
    ['svg', {id: 'svgcontent_' + index, xmlns: w3.svg, 'xmlns:xlink': w3.xlink, overflow:'hidden'},
        ['style', '.pinname {font-size:12px; font-style:normal; font-variant:normal; font-weight:500; font-stretch:normal; text-align:center; text-anchor:end; font-family:Helvetica} .wirename {font-size:12px; font-style:normal; font-variant:normal; font-weight:500; font-stretch:normal; text-align:center; text-anchor:start; font-family:Helvetica} .wirename:hover {fill:blue} .gate {color:#000; fill:#ffc; fill-opacity: 1;stroke:#000; stroke-width:1; stroke-opacity:1} .gate:hover {fill:red !important; } .wire {fill:none; stroke:#000; stroke-width:1; stroke-opacity:1} .grid {fill:#fff; fill-opacity:1; stroke:none}']
    ];
    node = jsonmlParse(e);
    parent.insertBefore(node, null);
}

module.exports = insertSVGTemplateAssign;

},{"./create-element":14,"./w3":44}],23:[function(require,module,exports){
'use strict';

var jsonmlParse = require('./create-element');
var w3 = require('./w3');
// var waveSkin = require('./wave-skin');

function insertSVGTemplate (index, parent, source, lane, waveSkin) {
    var node, first, e;

    // cleanup
    while (parent.childNodes.length) {
        parent.removeChild(parent.childNodes[0]);
    }

    for (first in waveSkin) { break; }

    e = waveSkin.default || waveSkin[first];

    if (source && source.config && source.config.skin && waveSkin[source.config.skin]) {
        e = waveSkin[source.config.skin];
    }

    if (index === 0) {
        lane.xs     = Number(e[3][1][2][1].width);
        lane.ys     = Number(e[3][1][2][1].height);
        lane.xlabel = Number(e[3][1][2][1].x);
        lane.ym     = Number(e[3][1][2][1].y);
    } else {
        e = ['svg',
            {
                id: 'svg',
                xmlns: w3.svg,
                'xmlns:xlink': w3.xlink,
                height: '0'
            },
            ['g',
                {
                    id: 'waves'
                },
                ['g', {id: 'lanes'}],
                ['g', {id: 'groups'}]
            ]
        ];
    }

    e[e.length - 1][1].id    = 'waves_'  + index;
    e[e.length - 1][2][1].id = 'lanes_'  + index;
    e[e.length - 1][3][1].id = 'groups_' + index;
    e[1].id = 'svgcontent_' + index;
    e[1].height = 0;

    node = jsonmlParse(e);
    parent.insertBefore(node, null);
}

module.exports = insertSVGTemplate;

},{"./create-element":14,"./w3":44}],24:[function(require,module,exports){
'use strict';

//attribute name mapping
var ATTRMAP = {
        rowspan : 'rowSpan',
        colspan : 'colSpan',
        cellpadding : 'cellPadding',
        cellspacing : 'cellSpacing',
        tabindex : 'tabIndex',
        accesskey : 'accessKey',
        hidefocus : 'hideFocus',
        usemap : 'useMap',
        maxlength : 'maxLength',
        readonly : 'readOnly',
        contenteditable : 'contentEditable'
        // can add more attributes here as needed
    },
    // attribute duplicates
    ATTRDUP = {
        enctype : 'encoding',
        onscroll : 'DOMMouseScroll'
        // can add more attributes here as needed
    },
    // event names
    EVTS = (function (/*string[]*/ names) {
        var evts = {}, evt;
        while (names.length) {
            evt = names.shift();
            evts['on' + evt.toLowerCase()] = evt;
        }
        return evts;
    })('blur,change,click,dblclick,error,focus,keydown,keypress,keyup,load,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,resize,scroll,select,submit,unload'.split(','));

/*void*/ function addHandler(/*DOM*/ elem, /*string*/ name, /*function*/ handler) {
    if (typeof handler === 'string') {
        handler = new Function('event', handler);
    }

    if (typeof handler !== 'function') {
        return;
    }

    elem[name] = handler;
}

/*DOM*/ function addAttributes(/*DOM*/ elem, /*object*/ attr) {
    if (attr.name && document.attachEvent) {
        // IE fix for not being able to programatically change the name attribute
        var alt = document.createElement('<' + elem.tagName + ' name=\'' + attr.name + '\'>');
        // fix for Opera 8.5 and Netscape 7.1 creating malformed elements
        if (elem.tagName === alt.tagName) {
            elem = alt;
        }
    }

    // for each attributeName
    for (var name in attr) {
        if (attr.hasOwnProperty(name)) {
            // attributeValue
            var value = attr[name];
            if (
                name &&
                value !== null &&
                typeof value !== 'undefined'
            ) {
                name = ATTRMAP[name.toLowerCase()] || name;
                if (name === 'style') {
                    if (typeof elem.style.cssText !== 'undefined') {
                        elem.style.cssText = value;
                    } else {
                        elem.style = value;
                    }
                    //                    } else if (name === 'class') {
                    //                        elem.className = value;
                    //                        // !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
                    //                        elem.setAttribute(name, value);
                    //                        // !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
                } else if (EVTS[name]) {
                    addHandler(elem, name, value);

                    // also set duplicated events
                    if (ATTRDUP[name]) {
                        addHandler(elem, ATTRDUP[name], value);
                    }
                } else if (
                    typeof value === 'string' ||
                     typeof value === 'number' ||
                     typeof value === 'boolean'
                ) {
                    elem.setAttribute(name, value);

                    // also set duplicated attributes
                    if (ATTRDUP[name]) {
                        elem.setAttribute(ATTRDUP[name], value);
                    }
                } else {

                    // allow direct setting of complex properties
                    elem[name] = value;

                    // also set duplicated attributes
                    if (ATTRDUP[name]) {
                        elem[ATTRDUP[name]] = value;
                    }
                }
            }
        }
    }
    return elem;
}

module.exports = addAttributes;

/* eslint no-new-func:0 */

},{}],25:[function(require,module,exports){
'use strict';

/*void*/ function appendChild(/*DOM*/ elem, /*DOM*/ child) {
    if (child) {
        // if (
        //     elem.tagName &&
        //     elem.tagName.toLowerCase() === 'table' &&
        //     elem.tBodies
        // ) {
        //     if (!child.tagName) {
        //         // must unwrap documentFragment for tables
        //         if (child.nodeType === 11) {
        //             while (child.firstChild) {
        //                 appendChild(elem, child.removeChild(child.firstChild));
        //             }
        //         }
        //         return;
        //     }
        //     // in IE must explicitly nest TRs in TBODY
        //     var childTag = child.tagName.toLowerCase();// child tagName
        //     if (childTag && childTag !== "tbody" && childTag !== "thead") {
        //         // insert in last tbody
        //         var tBody = elem.tBodies.length > 0 ? elem.tBodies[elem.tBodies.length - 1] : null;
        //         if (!tBody) {
        //             tBody = document.createElement(childTag === "th" ? "thead" : "tbody");
        //             elem.appendChild(tBody);
        //         }
        //         tBody.appendChild(child);
        //     } else if (elem.canHaveChildren !== false) {
        //         elem.appendChild(child);
        //     }
        // } else
        if (
            elem.tagName &&
            elem.tagName.toLowerCase() === 'style' &&
            document.createStyleSheet
        ) {
            // IE requires this interface for styles
            elem.cssText = child;
        } else

        if (elem.canHaveChildren !== false) {
            elem.appendChild(child);
        }
        // else if (
        //     elem.tagName &&
        //     elem.tagName.toLowerCase() === 'object' &&
        //     child.tagName &&
        //     child.tagName.toLowerCase() === 'param'
        // ) {
        //         // IE-only path
        //     try {
        //         elem.appendChild(child);
        //     } catch (ex1) {
        //
        //     }
        //     try {
        //         if (elem.object) {
        //             elem.object[child.name] = child.value;
        //         }
        //     } catch (ex2) {}
        // }
    }
}

module.exports = appendChild;

},{}],26:[function(require,module,exports){
'use strict';

var trimWhitespace = require('./jsonml-trim-whitespace');

/*DOM*/ function hydrate(/*string*/ value) {
    var wrapper = document.createElement('div');
    wrapper.innerHTML = value;

    // trim extraneous whitespace
    trimWhitespace(wrapper);

    // eliminate wrapper for single nodes
    if (wrapper.childNodes.length === 1) {
        return wrapper.firstChild;
    }

    // create a document fragment to hold elements
    var frag = document.createDocumentFragment ?
        document.createDocumentFragment() :
        document.createElement('');

    while (wrapper.firstChild) {
        frag.appendChild(wrapper.firstChild);
    }
    return frag;
}

module.exports = hydrate;

},{"./jsonml-trim-whitespace":28}],27:[function(require,module,exports){
'use strict';

var hydrate = require('./jsonml-hydrate'),
    w3 = require('./w3'),
    appendChild = require('./jsonml-append-child'),
    addAttributes = require('./jsonml-add-attributes'),
    trimWhitespace = require('./jsonml-trim-whitespace');

var patch,
    parse,
    onerror = null;

/*bool*/ function isElement (/*JsonML*/ jml) {
    return (jml instanceof Array) && (typeof jml[0] === 'string');
}

/*DOM*/ function onError (/*Error*/ ex, /*JsonML*/ jml, /*function*/ filter) {
    return document.createTextNode('[' + ex + '-' + filter + ']');
}

patch = /*DOM*/ function (/*DOM*/ elem, /*JsonML*/ jml, /*function*/ filter) {
    for (var i = 1; i < jml.length; i++) {

        if (
            (jml[i] instanceof Array) ||
            (typeof jml[i] === 'string')
        ) {
            // append children
            appendChild(elem, parse(jml[i], filter));
        // } else if (jml[i] instanceof Unparsed) {
        } else if (
            jml[i] &&
            jml[i].value
        ) {
            appendChild(elem, hydrate(jml[i].value));
        } else if (
            (typeof jml[i] === 'object') &&
            (jml[i] !== null) &&
            elem.nodeType === 1
        ) {
            // add attributes
            elem = addAttributes(elem, jml[i]);
        }
    }

    return elem;
};

parse = /*DOM*/ function (/*JsonML*/ jml, /*function*/ filter) {
    var elem;

    try {
        if (!jml) {
            return null;
        }

        if (typeof jml === 'string') {
            return document.createTextNode(jml);
        }

        // if (jml instanceof Unparsed) {
        if (jml && jml.value) {
            return hydrate(jml.value);
        }

        if (!isElement(jml)) {
            throw new SyntaxError('invalid JsonML');
        }

        var tagName = jml[0]; // tagName
        if (!tagName) {
            // correctly handle a list of JsonML trees
            // create a document fragment to hold elements
            var frag = document.createDocumentFragment ?
                document.createDocumentFragment() :
                document.createElement('');
            for (var i = 2; i < jml.length; i++) {
                appendChild(frag, parse(jml[i], filter));
            }

            // trim extraneous whitespace
            trimWhitespace(frag);

            // eliminate wrapper for single nodes
            if (frag.childNodes.length === 1) {
                return frag.firstChild;
            }
            return frag;
        }

        if (
            tagName.toLowerCase() === 'style' &&
            document.createStyleSheet
        ) {
            // IE requires this interface for styles
            patch(document.createStyleSheet(), jml, filter);
            // in IE styles are effective immediately
            return null;
        }

        elem = patch(document.createElementNS(w3.svg, tagName), jml, filter);

        // trim extraneous whitespace
        trimWhitespace(elem);
        // return (elem && (typeof filter === 'function')) ? filter(elem) : elem;
        return elem;
    } catch (ex) {
        try {
            // handle error with complete context
            var err = (typeof onerror === 'function') ? onerror : onError;
            return err(ex, jml, filter);
        } catch (ex2) {
            return document.createTextNode('[' + ex2 + ']');
        }
    }
};

module.exports = parse;

/* eslint yoda:1 */

},{"./jsonml-add-attributes":24,"./jsonml-append-child":25,"./jsonml-hydrate":26,"./jsonml-trim-whitespace":28,"./w3":44}],28:[function(require,module,exports){
'use strict';

/*bool*/ function isWhitespace(/*DOM*/ node) {
    return node &&
        (node.nodeType === 3) &&
        (!node.nodeValue || !/\S/.exec(node.nodeValue));
}

/*void*/ function trimWhitespace(/*DOM*/ elem) {
    if (elem) {
        while (isWhitespace(elem.firstChild)) {
            // trim leading whitespace text nodes
            elem.removeChild(elem.firstChild);
        }
        while (isWhitespace(elem.lastChild)) {
            // trim trailing whitespace text nodes
            elem.removeChild(elem.lastChild);
        }
    }
}

module.exports = trimWhitespace;

},{}],29:[function(require,module,exports){
'use strict';

var lane = {
    xs     : 20,    // tmpgraphlane0.width
    ys     : 20,    // tmpgraphlane0.height
    xg     : 120,   // tmpgraphlane0.x
    // yg     : 0,     // head gap
    yh0    : 0,     // head gap title
    yh1    : 0,     // head gap
    yf0    : 0,     // foot gap
    yf1    : 0,     // foot gap
    y0     : 5,     // tmpgraphlane0.y
    yo     : 30,    // tmpgraphlane1.y - y0;
    tgo    : -10,   // tmptextlane0.x - xg;
    ym     : 15,    // tmptextlane0.y - y0
    xlabel : 6,     // tmptextlabel.x - xg;
    xmax   : 1,
    scale  : 1,
    head   : {},
    foot   : {}
};

module.exports = lane;

},{}],30:[function(require,module,exports){
'use strict';

function parseConfig (source, lane) {
    var hscale;

    function tonumber (x) {
        return x > 0 ? Math.round(x) : 1;
    }

    lane.hscale = 1;

    if (lane.hscale0) {
        lane.hscale = lane.hscale0;
    }
    if (source && source.config && source.config.hscale) {
        hscale = Math.round(tonumber(source.config.hscale));
        if (hscale > 0) {
            if (hscale > 100) {
                hscale = 100;
            }
            lane.hscale = hscale;
        }
    }
    lane.yh0 = 0;
    lane.yh1 = 0;
    lane.head = source.head;

    lane.xmin_cfg = 0;
    lane.xmax_cfg = 1e12; // essentially infinity
    if (source && source.config && source.config.hbounds && source.config.hbounds.length==2) {
        source.config.hbounds[0] = Math.floor(source.config.hbounds[0]);
        source.config.hbounds[1] = Math.ceil(source.config.hbounds[1]);
        if (  source.config.hbounds[0] < source.config.hbounds[1] ) {
            // convert hbounds ticks min, max to bricks min, max
            // TODO: do we want to base this on ticks or tocks in
            //  head or foot?  All 4 can be different... or just 0 reference?
            lane.xmin_cfg = 2 * Math.floor(source.config.hbounds[0]);
            lane.xmax_cfg = 2 * Math.floor(source.config.hbounds[1]);
        }
    }

    if (source && source.head) {
        if (
            source.head.tick || source.head.tick === 0 ||
            source.head.tock || source.head.tock === 0
        ) {
            lane.yh0 = 20;
        }
        // if tick defined, modify start tick by lane.xmin_cfg
        if ( source.head.tick || source.head.tick === 0 ) {
            source.head.tick = source.head.tick + lane.xmin_cfg/2;
        }
        // if tock defined, modify start tick by lane.xmin_cfg
        if ( source.head.tock || source.head.tock === 0 ) {
            source.head.tock = source.head.tock + lane.xmin_cfg/2;
        }

        if (source.head.text) {
            lane.yh1 = 46;
            lane.head.text = source.head.text;
        }
    }

    lane.yf0 = 0;
    lane.yf1 = 0;
    lane.foot = source.foot;
    if (source && source.foot) {
        if (
            source.foot.tick || source.foot.tick === 0 ||
            source.foot.tock || source.foot.tock === 0
        ) {
            lane.yf0 = 20;
        }
        // if tick defined, modify start tick by lane.xmin_cfg
        if ( source.foot.tick || source.foot.tick === 0 ) {
            source.foot.tick = source.foot.tick + lane.xmin_cfg/2;
        }
        // if tock defined, modify start tick by lane.xmin_cfg
        if ( source.foot.tock || source.foot.tock === 0 ) {
            source.foot.tock = source.foot.tock + lane.xmin_cfg/2;
        }

        if (source.foot.text) {
            lane.yf1 = 46;
            lane.foot.text = source.foot.text;
        }
    }
}

module.exports = parseConfig;

},{}],31:[function(require,module,exports){
'use strict';

var genFirstWaveBrick = require('./gen-first-wave-brick'),
    genWaveBrick = require('./gen-wave-brick'),
    findLaneMarkers = require('./find-lane-markers');

// text is the wave member of the signal object
// extra = hscale-1 ( padding )
// lane is an object containing all properties for this waveform
function parseWaveLane (text, extra, lane) {
    var Repeats, Top, Next, Stack = [], R = [], i, subCycle;
    var unseen_bricks = [], num_unseen_markers;

    Stack = text.split('');
    Next  = Stack.shift();
    subCycle = false;

    Repeats = 1;
    while (Stack[0] === '.' || Stack[0] === '|') { // repeaters parser
        Stack.shift();
        Repeats += 1;
    }
    R = R.concat(genFirstWaveBrick(Next, extra, Repeats));

    while (Stack.length) {
        Top = Next;
        Next = Stack.shift();
        if (Next === '<') { // sub-cycles on
            subCycle = true;
            Next = Stack.shift();
        }
        if (Next === '>') { // sub-cycles off
            subCycle = false;
            Next = Stack.shift();
        }
        Repeats = 1;
        while (Stack[0] === '.' || Stack[0] === '|') { // repeaters parser
            Stack.shift();
            Repeats += 1;
        }
        if (subCycle) {
            R = R.concat(genWaveBrick((Top + Next), 0, Repeats - lane.period));
        } else {
            R = R.concat(genWaveBrick((Top + Next), extra, Repeats));
        }
    }
    // shift out unseen bricks due to phase shift, and save them in
    //  unseen_bricks array
    for (i = 0; i < lane.phase; i += 1) {
        unseen_bricks.push(R.shift());
    }
    if (unseen_bricks.length > 0) {
        num_unseen_markers = findLaneMarkers( unseen_bricks ).length;
        // if end of unseen_bricks and start of R both have a marker,
        //  then one less unseen marker
        if ( findLaneMarkers( [unseen_bricks[unseen_bricks.length-1]] ).length == 1 &&
             findLaneMarkers( [R[0]] ).length == 1 ) {
            num_unseen_markers -= 1;
        }
    } else {
        num_unseen_markers = 0;
    }

    // R is array of half brick types, each is item is string
    // num_unseen_markers is how many markers are now unseen due to phase
    return [R, num_unseen_markers];
}

module.exports = parseWaveLane;

},{"./find-lane-markers":17,"./gen-first-wave-brick":19,"./gen-wave-brick":20}],32:[function(require,module,exports){
'use strict';

var parseWaveLane = require('./parse-wave-lane');

function data_extract (e, num_unseen_markers) {
    var ret_data;

    ret_data = e.data;
    if (ret_data === undefined) { return null; }
    if (typeof (ret_data) === 'string') { ret_data= ret_data.split(' '); }
    // slice data array after unseen markers
    ret_data = ret_data.slice( num_unseen_markers );
    return ret_data;
}

function parseWaveLanes (sig, lane) {
    var x,
        sigx,
        content = [],
        content_wave,
        parsed_wave_lane,
        num_unseen_markers,
        tmp0 = [];

    for (x in sig) {
        // sigx is each signal in the array of signals being iterated over
        sigx = sig[x];
        lane.period = sigx.period ? sigx.period    : 1;
        // xmin_cfg is min. brick of hbounds, add to lane.phase of all signals
        lane.phase  = (sigx.phase  ? sigx.phase * 2 : 0) + lane.xmin_cfg;
        content.push([]);
        tmp0[0] = sigx.name  || ' ';
        // xmin_cfg is min. brick of hbounds, add 1/2 to sigx.phase of all sigs
        tmp0[1] = (sigx.phase || 0) + lane.xmin_cfg/2;
        if ( sigx.wave ) {
            parsed_wave_lane = parseWaveLane(sigx.wave, lane.period * lane.hscale - 1, lane);
            content_wave = parsed_wave_lane[0] ;
            num_unseen_markers = parsed_wave_lane[1];
        } else {
            content_wave = null;
        }
        content[content.length - 1][0] = tmp0.slice(0);
        content[content.length - 1][1] = content_wave;
        content[content.length - 1][2] = data_extract(sigx, num_unseen_markers);
    }
    // content is an array of arrays, representing the list of signals using
    //  the same order:
    // content[0] = [ [name,phase], parsedwavelaneobj, dataextracted ]
    return content;
}

module.exports = parseWaveLanes;

},{"./parse-wave-lane":31}],33:[function(require,module,exports){
'use strict';

var eva = require('./eva'),
    appendSaveAsDialog = require('./append-save-as-dialog'),
    renderWaveForm = require('./render-wave-form');

function processAll () {
    var points,
        i,
        index,
        node0;
        // node1;

    // first pass
    index = 0; // actual number of valid anchor
    points = document.querySelectorAll('*');
    for (i = 0; i < points.length; i++) {
        if (points.item(i).type && points.item(i).type === 'WaveDrom') {
            points.item(i).setAttribute('id', 'InputJSON_' + index);

            node0 = document.createElement('div');
            // node0.className += 'WaveDrom_Display_' + index;
            node0.id = 'WaveDrom_Display_' + index;
            points.item(i).parentNode.insertBefore(node0, points.item(i));
            // WaveDrom.InsertSVGTemplate(i, node0);
            index += 1;
        }
    }
    // second pass
    for (i = 0; i < index; i += 1) {
        renderWaveForm(i, eva('InputJSON_' + i), 'WaveDrom_Display_');
        appendSaveAsDialog(i, 'WaveDrom_Display_');
    }
    // add styles
    document.head.innerHTML += '<style type="text/css">div.wavedromMenu{position:fixed;border:solid 1pt#CCCCCC;background-color:white;box-shadow:0px 10px 20px #808080;cursor:default;margin:0px;padding:0px;}div.wavedromMenu>ul{margin:0px;padding:0px;}div.wavedromMenu>ul>li{padding:2px 10px;list-style:none;}div.wavedromMenu>ul>li:hover{background-color:#b5d5ff;}</style>';
}

module.exports = processAll;

},{"./append-save-as-dialog":13,"./eva":16,"./render-wave-form":42}],34:[function(require,module,exports){
'use strict';

function rec (tmp, state) {
    var i, name, old = {}, delta = {'x':10};
    if (typeof tmp[0] === 'string' || typeof tmp[0] === 'number') {
        name = tmp[0];
        delta.x = 25;
    }
    state.x += delta.x;
    for (i = 0; i < tmp.length; i++) {
        if (typeof tmp[i] === 'object') {
            if (Object.prototype.toString.call(tmp[i]) === '[object Array]') {
                old.y = state.y;
                state = rec(tmp[i], state);
                state.groups.push({'x':state.xx, 'y':old.y, 'height':(state.y - old.y), 'name':state.name});
            } else {
                state.lanes.push(tmp[i]);
                state.width.push(state.x);
                state.y += 1;
            }
        }
    }
    state.xx = state.x;
    state.x -= delta.x;
    state.name = name;
    return state;
}

module.exports = rec;

},{}],35:[function(require,module,exports){
'use strict';

var tspan = require('tspan'),
    jsonmlParse = require('./create-element'),
    w3 = require('./w3');

function renderArcs (root, source, index, top, lane) {
    var gg,
        i,
        k,
        text,
        Stack = [],
        Edge = {words: [], from: 0, shape: '', to: 0, label: ''},
        Events = {},
        pos,
        eventname,
        // labeltext,
        label,
        underlabel,
        from,
        to,
        dx,
        dy,
        lx,
        ly,
        gmark,
        lwidth;

    function t1 () {
        if (from && to) {
            gmark = document.createElementNS(w3.svg, 'path');
            gmark.id = ('gmark_' + Edge.from + '_' + Edge.to);
            gmark.setAttribute('d', 'M ' + from.x + ',' + from.y + ' ' + to.x   + ',' + to.y);
            gmark.setAttribute('style', 'fill:none;stroke:#00F;stroke-width:1');
            gg.insertBefore(gmark, null);
        }
    }

    if (source) {
        for (i in source) {
            lane.period = source[i].period ? source[i].period    : 1;
            lane.phase  = (source[i].phase  ? source[i].phase * 2 : 0) + lane.xmin_cfg;
            text = source[i].node;
            if (text) {
                Stack = text.split('');
                pos = 0;
                while (Stack.length) {
                    eventname = Stack.shift();
                    if (eventname !== '.') {
                        Events[eventname] = {
                            'x' : lane.xs * (2 * pos * lane.period * lane.hscale - lane.phase) + lane.xlabel,
                            'y' : i * lane.yo + lane.y0 + lane.ys * 0.5
                        };
                    }
                    pos += 1;
                }
            }
        }
        gg = document.createElementNS(w3.svg, 'g');
        gg.id = 'wavearcs_' + index;
        root.insertBefore(gg, null);
        if (top.edge) {
            for (i in top.edge) {
                Edge.words = top.edge[i].split(' ');
                Edge.label = top.edge[i].substring(Edge.words[0].length);
                Edge.label = Edge.label.substring(1);
                Edge.from  = Edge.words[0].substr(0, 1);
                Edge.to    = Edge.words[0].substr(-1, 1);
                Edge.shape = Edge.words[0].slice(1, -1);
                from  = Events[Edge.from];
                to    = Events[Edge.to];
                t1();
                if (from && to) {
                    if (Edge.label) {
                        label = tspan.parse(Edge.label);
                        label.unshift(
                            'text',
                            {
                                style: 'font-size:10px;',
                                'text-anchor': 'middle',
                                'xml:space': 'preserve'
                            }
                        );
                        label = jsonmlParse(label);
                        underlabel = jsonmlParse(['rect',
                            {
                                height: 9,
                                style: 'fill:#FFF;'
                            }
                        ]);
                        gg.insertBefore(underlabel, null);
                        gg.insertBefore(label, null);

                        lwidth = label.getBBox().width;

                        underlabel.setAttribute('width', lwidth);
                    }
                    dx = to.x - from.x;
                    dy = to.y - from.y;
                    lx = ((from.x + to.x) / 2);
                    ly = ((from.y + to.y) / 2);

                    switch (Edge.shape) {
                    case '-'  : {
                        break;
                    }
                    case '~'  : {
                        gmark.setAttribute('d', 'M ' + from.x + ',' + from.y + ' c ' + (0.7 * dx) + ', 0 ' + (0.3 * dx) + ', ' + dy + ' ' + dx + ', ' + dy);
                        break;
                    }
                    case '-~' : {
                        gmark.setAttribute('d', 'M ' + from.x + ',' + from.y + ' c ' + (0.7 * dx) + ', 0 ' +         dx + ', ' + dy + ' ' + dx + ', ' + dy);
                        if (Edge.label) { lx = (from.x + (to.x - from.x) * 0.75); }
                        break;
                    }
                    case '~-' : {
                        gmark.setAttribute('d', 'M ' + from.x + ',' + from.y + ' c ' + 0          + ', 0 ' + (0.3 * dx) + ', ' + dy + ' ' + dx + ', ' + dy);
                        if (Edge.label) { lx = (from.x + (to.x - from.x) * 0.25); }
                        break;
                    }
                    case '-|' : {
                        gmark.setAttribute('d', 'm ' + from.x + ',' + from.y + ' ' + dx + ',0 0,' + dy);
                        if (Edge.label) { lx = to.x; }
                        break;
                    }
                    case '|-' : {
                        gmark.setAttribute('d', 'm ' + from.x + ',' + from.y + ' 0,' + dy + ' ' + dx + ',0');
                        if (Edge.label) { lx = from.x; }
                        break;
                    }
                    case '-|-': {
                        gmark.setAttribute('d', 'm ' + from.x + ',' + from.y + ' ' + (dx / 2) + ',0 0,' + dy + ' ' + (dx / 2) + ',0');
                        break;
                    }
                    case '->' : {
                        gmark.setAttribute('style', 'marker-end:url(#arrowhead);stroke:#0041c4;stroke-width:1;fill:none');
                        break;
                    }
                    case '~>' : {
                        gmark.setAttribute('style', 'marker-end:url(#arrowhead);stroke:#0041c4;stroke-width:1;fill:none');
                        gmark.setAttribute('d', 'M ' + from.x + ',' + from.y + ' ' + 'c ' + (0.7 * dx) + ', 0 ' + 0.3 * dx + ', ' + dy + ' ' + dx + ', ' + dy);
                        break;
                    }
                    case '-~>': {
                        gmark.setAttribute('style', 'marker-end:url(#arrowhead);stroke:#0041c4;stroke-width:1;fill:none');
                        gmark.setAttribute('d', 'M ' + from.x + ',' + from.y + ' ' + 'c ' + (0.7 * dx) + ', 0 ' +     dx + ', ' + dy + ' ' + dx + ', ' + dy);
                        if (Edge.label) { lx = (from.x + (to.x - from.x) * 0.75); }
                        break;
                    }
                    case '~->': {
                        gmark.setAttribute('style', 'marker-end:url(#arrowhead);stroke:#0041c4;stroke-width:1;fill:none');
                        gmark.setAttribute('d', 'M ' + from.x + ',' + from.y + ' ' + 'c ' + 0      + ', 0 ' + (0.3 * dx) + ', ' + dy + ' ' + dx + ', ' + dy);
                        if (Edge.label) { lx = (from.x + (to.x - from.x) * 0.25); }
                        break;
                    }
                    case '-|>' : {
                        gmark.setAttribute('style', 'marker-end:url(#arrowhead);stroke:#0041c4;stroke-width:1;fill:none');
                        gmark.setAttribute('d', 'm ' + from.x + ',' + from.y + ' ' + dx + ',0 0,' + dy);
                        if (Edge.label) { lx = to.x; }
                        break;
                    }
                    case '|->' : {
                        gmark.setAttribute('style', 'marker-end:url(#arrowhead);stroke:#0041c4;stroke-width:1;fill:none');
                        gmark.setAttribute('d', 'm ' + from.x + ',' + from.y + ' 0,' + dy + ' ' + dx + ',0');
                        if (Edge.label) { lx = from.x; }
                        break;
                    }
                    case '-|->': {
                        gmark.setAttribute('style', 'marker-end:url(#arrowhead);stroke:#0041c4;stroke-width:1;fill:none');
                        gmark.setAttribute('d', 'm ' + from.x + ',' + from.y + ' ' + (dx / 2) + ',0 0,' + dy + ' ' + (dx / 2) + ',0');
                        break;
                    }
                    case '<->' : {
                        gmark.setAttribute('style', 'marker-end:url(#arrowhead);marker-start:url(#arrowtail);stroke:#0041c4;stroke-width:1;fill:none');
                        break;
                    }
                    case '<~>' : {
                        gmark.setAttribute('style', 'marker-end:url(#arrowhead);marker-start:url(#arrowtail);stroke:#0041c4;stroke-width:1;fill:none');
                        gmark.setAttribute('d', 'M ' + from.x + ',' + from.y + ' ' + 'c ' + (0.7 * dx) + ', 0 ' + (0.3 * dx) + ', ' + dy + ' ' + dx + ', ' + dy);
                        break;
                    }
                    case '<-~>': {
                        gmark.setAttribute('style', 'marker-end:url(#arrowhead);marker-start:url(#arrowtail);stroke:#0041c4;stroke-width:1;fill:none');
                        gmark.setAttribute('d', 'M ' + from.x + ',' + from.y + ' ' + 'c ' + (0.7 * dx) + ', 0 ' +     dx + ', ' + dy + ' ' + dx + ', ' + dy);
                        if (Edge.label) { lx = (from.x + (to.x - from.x) * 0.75); }
                        break;
                    }
                    case '<-|>' : {
                        gmark.setAttribute('style', 'marker-end:url(#arrowhead);marker-start:url(#arrowtail);stroke:#0041c4;stroke-width:1;fill:none');
                        gmark.setAttribute('d', 'm ' + from.x + ',' + from.y + ' ' + dx + ',0 0,' + dy);
                        if (Edge.label) { lx = to.x; }
                        break;
                    }
                    case '<-|->': {
                        gmark.setAttribute('style', 'marker-end:url(#arrowhead);marker-start:url(#arrowtail);stroke:#0041c4;stroke-width:1;fill:none');
                        gmark.setAttribute('d', 'm ' + from.x + ',' + from.y + ' ' + (dx / 2) + ',0 0,' + dy + ' ' + (dx / 2) + ',0');
                        break;
                    }
                    default   : { gmark.setAttribute('style', 'fill:none;stroke:#F00;stroke-width:1'); }
                    }
                    if (Edge.label) {
                        label.setAttribute('x', lx);
                        label.setAttribute('y', ly + 3);
                        underlabel.setAttribute('x', lx - lwidth / 2);
                        underlabel.setAttribute('y', ly - 5);
                    }
                }
            }
        }
        for (k in Events) {
            if (k === k.toLowerCase()) {
                if (Events[k].x > 0) {
                    underlabel = jsonmlParse(['rect',
                        {
                            y: Events[k].y - 4,
                            height: 8,
                            style: 'fill:#FFF;'
                        }
                    ]);
                    label = jsonmlParse(['text',
                        {
                            style: 'font-size:8px;',
                            x: Events[k].x,
                            y: Events[k].y + 2,
                            'text-anchor': 'middle'
                        },
                        (k + '')
                    ]);

                    gg.insertBefore(underlabel, null);
                    gg.insertBefore(label, null);

                    lwidth = label.getBBox().width + 2;

                    underlabel.setAttribute('x', Events[k].x - lwidth / 2);
                    underlabel.setAttribute('width', lwidth);
                }
            }
        }
    }
}

module.exports = renderArcs;

},{"./create-element":14,"./w3":44,"tspan":10}],36:[function(require,module,exports){
'use strict';

var jsonmlParse = require('./create-element');

function render (tree, state) {
    var y, i, ilen;

    state.xmax = Math.max(state.xmax, state.x);
    y = state.y;
    ilen = tree.length;
    for (i = 1; i < ilen; i++) {
        if (Object.prototype.toString.call(tree[i]) === '[object Array]') {
            state = render(tree[i], {x: (state.x + 1), y: state.y, xmax: state.xmax});
        } else {
            tree[i] = {name:tree[i], x: (state.x + 1), y: state.y};
            state.y += 2;
        }
    }
    tree[0] = {name: tree[0], x: state.x, y: Math.round((y + (state.y - 2)) / 2)};
    state.x--;
    return state;
}

function draw_body (type, ymin, ymax) {
    var e,
        iecs,
        circle = ' M 4,0 C 4,1.1 3.1,2 2,2 0.9,2 0,1.1 0,0 c 0,-1.1 0.9,-2 2,-2 1.1,0 2,0.9 2,2 z',
        gates = {
            '~':  'M -11,-6 -11,6 0,0 z m -5,6 5,0' + circle,
            '=':  'M -11,-6 -11,6 0,0 z m -5,6 5,0',
            '&':  'm -16,-10 5,0 c 6,0 11,4 11,10 0,6 -5,10 -11,10 l -5,0 z',
            '~&': 'm -16,-10 5,0 c 6,0 11,4 11,10 0,6 -5,10 -11,10 l -5,0 z' + circle,
            '|':  'm -18,-10 4,0 c 6,0 12,5 14,10 -2,5 -8,10 -14,10 l -4,0 c 2.5,-5 2.5,-15 0,-20 z',
            '~|': 'm -18,-10 4,0 c 6,0 12,5 14,10 -2,5 -8,10 -14,10 l -4,0 c 2.5,-5 2.5,-15 0,-20 z' + circle,
            '^':  'm -21,-10 c 1,3 2,6 2,10 m 0,0 c 0,4 -1,7 -2,10 m 3,-20 4,0 c 6,0 12,5 14,10 -2,5 -8,10 -14,10 l -4,0 c 1,-3 2,-6 2,-10 0,-4 -1,-7 -2,-10 z',
            '~^': 'm -21,-10 c 1,3 2,6 2,10 m 0,0 c 0,4 -1,7 -2,10 m 3,-20 4,0 c 6,0 12,5 14,10 -2,5 -8,10 -14,10 l -4,0 c 1,-3 2,-6 2,-10 0,-4 -1,-7 -2,-10 z' + circle,
            '+':  'm -8,5 0,-10 m -5,5 10,0 m 3,0 c 0,4.418278 -3.581722,8 -8,8 -4.418278,0 -8,-3.581722 -8,-8 0,-4.418278 3.581722,-8 8,-8 4.418278,0 8,3.581722 8,8 z',
            '*':  'm -4,4 -8,-8 m 0,8 8,-8 m 4,4 c 0,4.418278 -3.581722,8 -8,8 -4.418278,0 -8,-3.581722 -8,-8 0,-4.418278 3.581722,-8 8,-8 4.418278,0 8,3.581722 8,8 z'
        },
        iec = {
            BUF: 1, INV: 1, AND: '&',  NAND: '&',
            OR: '\u22651', NOR: '\u22651', XOR: '=1', XNOR: '=1', box: ''
        },
        circled = { INV: 1, NAND: 1, NOR: 1, XNOR: 1 };

    if (ymax === ymin) {
        ymax = 4; ymin = -4;
    }
    e = gates[type];
    iecs = iec[type];
    if (e) {
        return ['path', {class:'gate', d: e}];
    } else {
        if (iecs) {
            return [
                'g', [
                    'path', {
                        class:'gate',
                        d: 'm -16,' + (ymin - 3) + ' 16,0 0,' + (ymax - ymin + 6) + ' -16,0 z' + (circled[type] ? circle : '')
                    }], [
                    'text', [
                        'tspan', {x: '-14', y: '4', class: 'wirename'}, iecs + ''
                    ]
                ]
            ];
        } else {
            return ['text', ['tspan', {x: '-14', y: '4', class: 'wirename'}, type + '']];
        }
    }
}

function draw_gate (spec) { // ['type', [x,y], [x,y] ... ]
    var i,
        ret = ['g'],
        ys = [],
        ymin,
        ymax,
        ilen = spec.length;

    for (i = 2; i < ilen; i++) {
        ys.push(spec[i][1]);
    }

    ymin = Math.min.apply(null, ys);
    ymax = Math.max.apply(null, ys);

    ret.push(
        ['g',
            {transform:'translate(16,0)'},
            ['path', {
                d: 'M  ' + spec[2][0] + ',' + ymin + ' ' + spec[2][0] + ',' + ymax,
                class: 'wire'
            }]
        ]
    );

    for (i = 2; i < ilen; i++) {
        ret.push(
            ['g',
                ['path',
                    {
                        d: 'm  ' + spec[i][0] + ',' + spec[i][1] + ' 16,0',
                        class: 'wire'
                    }
                ]
            ]
        );
    }
    ret.push(
        ['g', { transform: 'translate(' + spec[1][0] + ',' + spec[1][1] + ')' },
            ['title', spec[0]],
            draw_body(spec[0], ymin - spec[1][1], ymax - spec[1][1])
        ]
    );
    return ret;
}

function draw_boxes (tree, xmax) {
    var ret = ['g'], i, ilen, fx, fy, fname, spec = [];
    if (Object.prototype.toString.call(tree) === '[object Array]') {
        ilen = tree.length;
        spec.push(tree[0].name);
        spec.push([32 * (xmax - tree[0].x), 8 * tree[0].y]);
        for (i = 1; i < ilen; i++) {
            if (Object.prototype.toString.call(tree[i]) === '[object Array]') {
                spec.push([32 * (xmax - tree[i][0].x), 8 * tree[i][0].y]);
            } else {
                spec.push([32 * (xmax - tree[i].x), 8 * tree[i].y]);
            }
        }
        ret.push(draw_gate(spec));
        for (i = 1; i < ilen; i++) {
            ret.push(draw_boxes(tree[i], xmax));
        }
    } else {
        fname = tree.name;
        fx = 32 * (xmax - tree.x);
        fy = 8 * tree.y;
        ret.push(
            ['g', { transform: 'translate(' + fx + ',' + fy + ')'},
                ['title', fname],
                ['path', {d:'M 2,0 a 2,2 0 1 1 -4,0 2,2 0 1 1 4,0 z'}],
                ['text',
                    ['tspan', {
                        x:'-4', y:'4',
                        class:'pinname'},
                    fname
                    ]
                ]
            ]
        );
    }
    return ret;
}

function renderAssign (index, source) {
    var tree,
        state,
        xmax,
        svg = ['g'],
        grid = ['g'],
        svgcontent,
        width,
        height,
        i,
        ilen,
        j,
        jlen;

    ilen = source.assign.length;
    state = { x: 0, y: 2, xmax: 0 };
    tree = source.assign;
    for (i = 0; i < ilen; i++) {
        state = render(tree[i], state);
        state.x++;
    }
    xmax = state.xmax + 3;

    for (i = 0; i < ilen; i++) {
        svg.push(draw_boxes(tree[i], xmax));
    }
    width  = 32 * (xmax + 1) + 1;
    height = 8 * (state.y + 1) - 7;
    ilen = 4 * (xmax + 1);
    jlen = state.y + 1;
    for (i = 0; i <= ilen; i++) {
        for (j = 0; j <= jlen; j++) {
            grid.push(['rect', {
                height: 1,
                width: 1,
                x: (i * 8 - 0.5),
                y: (j * 8 - 0.5),
                class: 'grid'
            }]);
        }
    }
    svgcontent = document.getElementById('svgcontent_' + index);
    svgcontent.setAttribute('viewBox', '0 0 ' + width + ' ' + height);
    svgcontent.setAttribute('width', width);
    svgcontent.setAttribute('height', height);
    svgcontent.insertBefore(jsonmlParse(['g', {transform:'translate(0.5, 0.5)'}, grid, svg]), null);
}

module.exports = renderAssign;

},{"./create-element":14}],37:[function(require,module,exports){
'use strict';

var w3 = require('./w3');

function renderGaps (root, source, index, lane) {
    var i, gg, g, b, pos, Stack = [], text, subCycle, next;

    if (source) {

        gg = document.createElementNS(w3.svg, 'g');
        gg.id = 'wavegaps_' + index;
        root.insertBefore(gg, null);
        subCycle = false;
        for (i in source) {
            lane.period = source[i].period ? source[i].period    : 1;
            lane.phase  = (source[i].phase  ? source[i].phase * 2 : 0) + lane.xmin_cfg;
            g = document.createElementNS(w3.svg, 'g');
            g.id = 'wavegap_' + i + '_' + index;
            g.setAttribute('transform', 'translate(0,' + (lane.y0 + i * lane.yo) + ')');
            gg.insertBefore(g, null);

            text = source[i].wave;
            if (text) {
                Stack = text.split('');
                pos = 0;
                while (Stack.length) {
                    next = Stack.shift();
                    if (next === '<') { // sub-cycles on
                        subCycle = true;
                        next = Stack.shift();
                    }
                    if (next === '>') { // sub-cycles off
                        subCycle = false;
                        next = Stack.shift();
                    }
                    if (subCycle) {
                        pos += 1;
                    } else {
                        pos += (2 * lane.period);
                    }
                    if (next === '|') {
                        b    = document.createElementNS(w3.svg, 'use');
                        // b.id = 'guse_' + pos + '_' + i + '_' + index;
                        b.setAttributeNS(w3.xlink, 'xlink:href', '#gap');
                        b.setAttribute('transform', 'translate(' + (lane.xs * ((pos - (subCycle ? 0 : lane.period)) * lane.hscale - lane.phase)) + ')');
                        g.insertBefore(b, null);
                    }
                }
            }
        }
    }
}

module.exports = renderGaps;

},{"./w3":44}],38:[function(require,module,exports){
'use strict';

var tspan = require('tspan');

function renderGroups (groups, index, lane) {
    var x, y, res = ['g'], ts;

    groups.forEach(function (e, i) {
        res.push(['path',
            {
                id: 'group_' + i + '_' + index,
                d: ('m ' + (e.x + 0.5) + ',' + (e.y * lane.yo + 3.5 + lane.yh0 + lane.yh1)
                    + ' c -3,0 -5,2 -5,5 l 0,' + (e.height * lane.yo - 16)
                    + ' c 0,3 2,5 5,5'),
                style: 'stroke:#0041c4;stroke-width:1;fill:none'
            }
        ]);

        if (e.name === undefined) { return; }

        x = (e.x - 10);
        y = (lane.yo * (e.y + (e.height / 2)) + lane.yh0 + lane.yh1);
        ts = tspan.parse(e.name);
        ts.unshift(
            'text',
            {
                'text-anchor': 'middle',
                class: 'info',
                'xml:space': 'preserve'
            }
        );
        res.push(['g', {transform: 'translate(' + x + ',' + y + ')'}, ['g', {transform: 'rotate(270)'}, ts]]);
    });
    return res;
}

module.exports = renderGroups;

},{"tspan":10}],39:[function(require,module,exports){
'use strict';

var tspan = require('tspan'),
    jsonmlParse = require('./create-element');
    // w3 = require('./w3');

function renderMarks (root, content, index, lane) {
    var i, g, marks, mstep, mmstep, gy; // svgns

    function captext (cxt, anchor, y) {
        var tmark;

        if (cxt[anchor] && cxt[anchor].text) {
            tmark = tspan.parse(cxt[anchor].text);
            tmark.unshift(
                'text',
                {
                    x: cxt.xmax * cxt.xs / 2,
                    y: y,
                    'text-anchor': 'middle',
                    fill: '#000',
                    'xml:space': 'preserve'
                }
            );
            tmark = jsonmlParse(tmark);
            g.insertBefore(tmark, null);
        }
    }

    function ticktock (cxt, ref1, ref2, x, dx, y, len) {
        var tmark, step = 1, offset, dp = 0, val, L = [], tmp;

        if (cxt[ref1] === undefined || cxt[ref1][ref2] === undefined) { return; }
        val = cxt[ref1][ref2];
        if (typeof val === 'string') {
            val = val.split(' ');
        } else if (typeof val === 'number' || typeof val === 'boolean') {
            offset = Number(val);
            val = [];
            for (i = 0; i < len; i += 1) {
                val.push(i + offset);
            }
        }
        if (Object.prototype.toString.call(val) === '[object Array]') {
            if (val.length === 0) {
                return;
            } else if (val.length === 1) {
                offset = Number(val[0]);
                if (isNaN(offset)) {
                    L = val;
                } else {
                    for (i = 0; i < len; i += 1) {
                        L[i] = i + offset;
                    }
                }
            } else if (val.length === 2) {
                offset = Number(val[0]);
                step   = Number(val[1]);
                tmp = val[1].split('.');
                if ( tmp.length === 2 ) {
                    dp = tmp[1].length;
                }
                if (isNaN(offset) || isNaN(step)) {
                    L = val;
                } else {
                    offset = step * offset;
                    for (i = 0; i < len; i += 1) {
                        L[i] = (step * i + offset).toFixed(dp);
                    }
                }
            } else {
                L = val;
            }
        } else {
            return;
        }
        for (i = 0; i < len; i += 1) {
            tmp = L[i];
            //  if (typeof tmp === 'number') { tmp += ''; }
            tmark = tspan.parse(tmp);
            tmark.unshift(
                'text',
                {
                    x: i * dx + x,
                    y: y,
                    'text-anchor': 'middle',
                    class: 'muted',
                    'xml:space': 'preserve'
                }
            );
            tmark = jsonmlParse(tmark);
            g.insertBefore(tmark, null);
        }
    }

    mstep  = 2 * (lane.hscale);
    mmstep = mstep * lane.xs;
    marks  = lane.xmax / mstep;
    gy     = content.length * lane.yo;

    g = jsonmlParse(['g', {id: ('gmarks_' + index)}]);
    root.insertBefore(g, root.firstChild);

    for (i = 0; i < (marks + 1); i += 1) {
        g.insertBefore(
            jsonmlParse([
                'path',
                {
                    id:    'gmark_' + i + '_' + index,
                    d:     'm ' + (i * mmstep) + ',' + 0 + ' 0,' + gy,
                    style: 'stroke:#888;stroke-width:0.5;stroke-dasharray:1,3'
                }
            ]),
            null
        );
    }

    captext(lane, 'head', (lane.yh0 ? -33 : -13));
    captext(lane, 'foot', gy + (lane.yf0 ? 45 : 25));

    ticktock(lane, 'head', 'tick',          0, mmstep,      -5, marks + 1);
    ticktock(lane, 'head', 'tock', mmstep / 2, mmstep,      -5, marks);
    ticktock(lane, 'foot', 'tick',          0, mmstep, gy + 15, marks + 1);
    ticktock(lane, 'foot', 'tock', mmstep / 2, mmstep, gy + 15, marks);
}

module.exports = renderMarks;

},{"./create-element":14,"tspan":10}],40:[function(require,module,exports){
'use strict';

var jsonmlParse = require('./create-element'),
    render = require('bit-field/lib/render');

function renderReg (index, source, parent) {
    // cleanup
    while (parent.childNodes.length) {
        parent.removeChild(parent.childNodes[0]);
    }
    var e = render(source.reg, source.config);
    var node = jsonmlParse(e);
    parent.insertBefore(node, null);
}

module.exports = renderReg;

},{"./create-element":14,"bit-field/lib/render":1}],41:[function(require,module,exports){
'use strict';

var rec = require('./rec'),
    lane = require('./lane'),
    jsonmlParse = require('./create-element'),
    parseConfig = require('./parse-config'),
    parseWaveLanes = require('./parse-wave-lanes'),
    renderMarks = require('./render-marks'),
    renderGaps = require('./render-gaps'),
    renderGroups = require('./render-groups'),
    renderWaveLane = require('./render-wave-lane'),
    renderAssign = require('./render-assign'),
    renderReg = require('./render-reg'),
    renderArcs = require('./render-arcs'),
    insertSVGTemplate = require('./insert-svg-template'),
    insertSVGTemplateAssign = require('./insert-svg-template-assign');

function findFirstChildByTagName (parent, name) {
    var i;
    var arr = parent.children;
    var ilen = arr.length;
    for (i = 0; i < ilen; i++) {
        if (arr[i].tagName === name) {
            return arr[i];
        }
    }
}

function renderWaveElement (index, source, outputElement, waveSkin) {
    if (source.signal) {

        insertSVGTemplate(index, outputElement, source, lane, waveSkin);
        parseConfig(source, lane);

        var ret = rec(source.signal, {'x':0, 'y':0, 'xmax':0, 'width':[], 'lanes':[], 'groups':[]});

        var svgcontent  = outputElement.children[0];
        var waves = findFirstChildByTagName (svgcontent, 'g');
        var lanes = waves.children[0];
        var groups = waves.children[1];

        var content  = parseWaveLanes(ret.lanes, lane);
        var glengths = renderWaveLane(lanes, content, index, lane);

        var xmax = glengths.reduce(function (res, len, i) {
            return Math.max(res, len + ret.width[i]);
        }, 0);

        renderMarks(lanes, content, index, lane);
        renderArcs(lanes, ret.lanes, index, source, lane);
        renderGaps(lanes, ret.lanes, index, lane);
        groups.insertBefore(jsonmlParse(renderGroups(ret.groups, index, lane)), null);
        lane.xg = Math.ceil((xmax - lane.tgo) / lane.xs) * lane.xs;
        var width = (lane.xg + (lane.xs * (lane.xmax + 1)));
        var height = (content.length * lane.yo + lane.yh0 + lane.yh1 + lane.yf0 + lane.yf1);

        svgcontent.setAttribute('viewBox', '0 0 ' + width + ' ' + height);
        svgcontent.setAttribute('width', width);
        svgcontent.setAttribute('height', height);
        svgcontent.setAttribute('overflow', 'hidden');
        lanes.setAttribute('transform', 'translate(' + (lane.xg + 0.5) + ', ' + ((lane.yh0 + lane.yh1) + 0.5) + ')');
    } else if (source.assign) {
        insertSVGTemplateAssign(index, outputElement, source);
        renderAssign(index, source);
    } else if (source.reg) {
        renderReg(index, source, outputElement);
    }
}

module.exports = renderWaveElement;

},{"./create-element":14,"./insert-svg-template":23,"./insert-svg-template-assign":22,"./lane":29,"./parse-config":30,"./parse-wave-lanes":32,"./rec":34,"./render-arcs":35,"./render-assign":36,"./render-gaps":37,"./render-groups":38,"./render-marks":39,"./render-reg":40,"./render-wave-lane":43}],42:[function(require,module,exports){
'use strict';

var renderWaveElement = require('./render-wave-element');

function renderWaveForm (index, source, output) {
    renderWaveElement(index, source, document.getElementById(output + index), window.WaveSkin);
}

module.exports = renderWaveForm;

},{"./render-wave-element":41}],43:[function(require,module,exports){
'use strict';

var tspan = require('tspan'),
    jsonmlParse = require('./create-element'),
    w3 = require('./w3'),
    findLaneMarkers = require('./find-lane-markers');

function renderWaveLane (root, content, index, lane) {
    var i,
        j,
        k,
        g,
        gg,
        title,
        b,
        labels = [1],
        name,
        xoffset,
        xmax     = 0,
        xgmax    = 0,
        glengths = [];

    for (j = 0; j < content.length; j += 1) {
        name = content[j][0][0];
        if (name) { // check name
            g = jsonmlParse(['g',
                {
                    id: 'wavelane_' + j + '_' + index,
                    transform: 'translate(0,' + ((lane.y0) + j * lane.yo) + ')'
                }
            ]);
            root.insertBefore(g, null);
            title = tspan.parse(name);
            title.unshift(
                'text',
                {
                    x: lane.tgo,
                    y: lane.ym,
                    class: 'info',
                    'text-anchor': 'end',
                    'xml:space': 'preserve'
                }
            );
            title = jsonmlParse(title);
            g.insertBefore(title, null);

            // scale = lane.xs * (lane.hscale) * 2;

            glengths.push(title.getBBox().width);

            xoffset = content[j][0][1];
            xoffset = (xoffset > 0) ? (Math.ceil(2 * xoffset) - 2 * xoffset) :
                (-2 * xoffset);
            gg = jsonmlParse(['g',
                {
                    id: 'wavelane_draw_' + j + '_' + index,
                    transform: 'translate(' + (xoffset * lane.xs) + ', 0)'
                }
            ]);
            g.insertBefore(gg, null);

            if (content[j][1]) {
                for (i = 0; i < content[j][1].length; i += 1) {
                    b = document.createElementNS(w3.svg, 'use');
                    // b.id = 'use_' + i + '_' + j + '_' + index;
                    b.setAttributeNS(w3.xlink, 'xlink:href', '#' + content[j][1][i]);
                    // b.setAttribute('transform', 'translate(' + (i * lane.xs) + ')');
                    b.setAttribute('transform', 'translate(' + (i * lane.xs) + ')');
                    gg.insertBefore(b, null);
                }
                if (content[j][2] && content[j][2].length) {
                    labels = findLaneMarkers(content[j][1]);

                    if (labels.length !== 0) {
                        for (k in labels) {
                            if (content[j][2] && (typeof content[j][2][k] !== 'undefined')) {
                                title = tspan.parse(content[j][2][k]);
                                title.unshift(
                                    'text',
                                    {
                                        x: labels[k] * lane.xs + lane.xlabel,
                                        y: lane.ym,
                                        'text-anchor': 'middle',
                                        'xml:space': 'preserve'
                                    }
                                );
                                title = jsonmlParse(title);
                                gg.insertBefore(title, null);
                            }
                        }
                    }
                }
                if (content[j][1].length > xmax) {
                    xmax = content[j][1].length;
                }
            }
        }
    }
    // xmax if no xmax_cfg,xmin_cfg, else set to config
    lane.xmax = Math.min(xmax, lane.xmax_cfg - lane.xmin_cfg);
    lane.xg = xgmax + 20;
    return glengths;
}

module.exports = renderWaveLane;

},{"./create-element":14,"./find-lane-markers":17,"./w3":44,"tspan":10}],44:[function(require,module,exports){
'use strict';

module.exports = {
    svg: 'http://www.w3.org/2000/svg',
    xlink: 'http://www.w3.org/1999/xlink',
    xmlns: 'http://www.w3.org/XML/1998/namespace'
};

},{}],45:[function(require,module,exports){
var WaveSkin=WaveSkin||{};WaveSkin.default=["svg",{"id":"svg","xmlns":"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","height":"0"},["style",{"type":"text/css"},"text{font-size:11pt;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:center;fill-opacity:1;font-family:Helvetica}.muted{fill:#aaa}.warning{fill:#f6b900}.error{fill:#f60000}.info{fill:#0041c4}.success{fill:#00ab00}.h1{font-size:33pt;font-weight:bold}.h2{font-size:27pt;font-weight:bold}.h3{font-size:20pt;font-weight:bold}.h4{font-size:14pt;font-weight:bold}.h5{font-size:11pt;font-weight:bold}.h6{font-size:8pt;font-weight:bold}.s1{fill:none;stroke:#000;stroke-width:1;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none}.s2{fill:none;stroke:#000;stroke-width:0.5;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none}.s3{color:#000;fill:none;stroke:#000;stroke-width:1;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:1, 3;stroke-dashoffset:0;marker:none;visibility:visible;display:inline;overflow:visible;enable-background:accumulate}.s4{color:#000;fill:none;stroke:#000;stroke-width:1;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0;marker:none;visibility:visible;display:inline;overflow:visible}.s5{fill:#fff;stroke:none}.s6{color:#000;fill:#ffffb4;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:1px;marker:none;visibility:visible;display:inline;overflow:visible;enable-background:accumulate}.s7{color:#000;fill:#ffe0b9;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:1px;marker:none;visibility:visible;display:inline;overflow:visible;enable-background:accumulate}.s8{color:#000;fill:#b9e0ff;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:1px;marker:none;visibility:visible;display:inline;overflow:visible;enable-background:accumulate}.s9{fill:#000;fill-opacity:1;stroke:none}.s10{color:#000;fill:#fff;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:1px;marker:none;visibility:visible;display:inline;overflow:visible;enable-background:accumulate}.s11{fill:#0041c4;fill-opacity:1;stroke:none}.s12{fill:none;stroke:#0041c4;stroke-width:1;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none}"],["defs",["g",{"id":"socket"},["rect",{"y":"15","x":"6","height":"20","width":"20"}]],["g",{"id":"pclk"},["path",{"d":"M0,20 0,0 20,0","class":"s1"}]],["g",{"id":"nclk"},["path",{"d":"m0,0 0,20 20,0","class":"s1"}]],["g",{"id":"000"},["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"0m0"},["path",{"d":"m0,20 3,0 3,-10 3,10 11,0","class":"s1"}]],["g",{"id":"0m1"},["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}]],["g",{"id":"0mx"},["path",{"d":"M3,20 9,0 20,0","class":"s1"}],["path",{"d":"m20,15 -5,5","class":"s2"}],["path",{"d":"M20,10 10,20","class":"s2"}],["path",{"d":"M20,5 5,20","class":"s2"}],["path",{"d":"M20,0 4,16","class":"s2"}],["path",{"d":"M15,0 6,9","class":"s2"}],["path",{"d":"M10,0 9,1","class":"s2"}],["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"0md"},["path",{"d":"m8,20 10,0","class":"s3"}],["path",{"d":"m0,20 5,0","class":"s1"}]],["g",{"id":"0mu"},["path",{"d":"m0,20 3,0 C 7,10 10.107603,0 20,0","class":"s1"}]],["g",{"id":"0mz"},["path",{"d":"m0,20 3,0 C 10,10 15,10 20,10","class":"s1"}]],["g",{"id":"111"},["path",{"d":"M0,0 20,0","class":"s1"}]],["g",{"id":"1m0"},["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}]],["g",{"id":"1m1"},["path",{"d":"M0,0 3,0 6,10 9,0 20,0","class":"s1"}]],["g",{"id":"1mx"},["path",{"d":"m3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}],["path",{"d":"m20,15 -5,5","class":"s2"}],["path",{"d":"M20,10 10,20","class":"s2"}],["path",{"d":"M20,5 8,17","class":"s2"}],["path",{"d":"M20,0 7,13","class":"s2"}],["path",{"d":"M15,0 6,9","class":"s2"}],["path",{"d":"M10,0 5,5","class":"s2"}],["path",{"d":"M3.5,1.5 5,0","class":"s2"}]],["g",{"id":"1md"},["path",{"d":"m0,0 3,0 c 4,10 7,20 17,20","class":"s1"}]],["g",{"id":"1mu"},["path",{"d":"M0,0 5,0","class":"s1"}],["path",{"d":"M8,0 18,0","class":"s3"}]],["g",{"id":"1mz"},["path",{"d":"m0,0 3,0 c 7,10 12,10 17,10","class":"s1"}]],["g",{"id":"xxx"},["path",{"d":"m0,20 20,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}],["path",{"d":"M0,5 5,0","class":"s2"}],["path",{"d":"M0,10 10,0","class":"s2"}],["path",{"d":"M0,15 15,0","class":"s2"}],["path",{"d":"M0,20 20,0","class":"s2"}],["path",{"d":"M5,20 20,5","class":"s2"}],["path",{"d":"M10,20 20,10","class":"s2"}],["path",{"d":"m15,20 5,-5","class":"s2"}]],["g",{"id":"xm0"},["path",{"d":"M0,0 4,0 9,20","class":"s1"}],["path",{"d":"m0,20 20,0","class":"s1"}],["path",{"d":"M0,5 4,1","class":"s2"}],["path",{"d":"M0,10 5,5","class":"s2"}],["path",{"d":"M0,15 6,9","class":"s2"}],["path",{"d":"M0,20 7,13","class":"s2"}],["path",{"d":"M5,20 8,17","class":"s2"}]],["g",{"id":"xm1"},["path",{"d":"M0,0 20,0","class":"s1"}],["path",{"d":"M0,20 4,20 9,0","class":"s1"}],["path",{"d":"M0,5 5,0","class":"s2"}],["path",{"d":"M0,10 9,1","class":"s2"}],["path",{"d":"M0,15 7,8","class":"s2"}],["path",{"d":"M0,20 5,15","class":"s2"}]],["g",{"id":"xmx"},["path",{"d":"m0,20 20,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}],["path",{"d":"M0,5 5,0","class":"s2"}],["path",{"d":"M0,10 10,0","class":"s2"}],["path",{"d":"M0,15 15,0","class":"s2"}],["path",{"d":"M0,20 20,0","class":"s2"}],["path",{"d":"M5,20 20,5","class":"s2"}],["path",{"d":"M10,20 20,10","class":"s2"}],["path",{"d":"m15,20 5,-5","class":"s2"}]],["g",{"id":"xmd"},["path",{"d":"m0,0 4,0 c 3,10 6,20 16,20","class":"s1"}],["path",{"d":"m0,20 20,0","class":"s1"}],["path",{"d":"M0,5 4,1","class":"s2"}],["path",{"d":"M0,10 5.5,4.5","class":"s2"}],["path",{"d":"M0,15 6.5,8.5","class":"s2"}],["path",{"d":"M0,20 8,12","class":"s2"}],["path",{"d":"m5,20 5,-5","class":"s2"}],["path",{"d":"m10,20 2.5,-2.5","class":"s2"}]],["g",{"id":"xmu"},["path",{"d":"M0,0 20,0","class":"s1"}],["path",{"d":"m0,20 4,0 C 7,10 10,0 20,0","class":"s1"}],["path",{"d":"M0,5 5,0","class":"s2"}],["path",{"d":"M0,10 10,0","class":"s2"}],["path",{"d":"M0,15 10,5","class":"s2"}],["path",{"d":"M0,20 6,14","class":"s2"}]],["g",{"id":"xmz"},["path",{"d":"m0,0 4,0 c 6,10 11,10 16,10","class":"s1"}],["path",{"d":"m0,20 4,0 C 10,10 15,10 20,10","class":"s1"}],["path",{"d":"M0,5 4.5,0.5","class":"s2"}],["path",{"d":"M0,10 6.5,3.5","class":"s2"}],["path",{"d":"M0,15 8.5,6.5","class":"s2"}],["path",{"d":"M0,20 11.5,8.5","class":"s2"}]],["g",{"id":"ddd"},["path",{"d":"m0,20 20,0","class":"s3"}]],["g",{"id":"dm0"},["path",{"d":"m0,20 10,0","class":"s3"}],["path",{"d":"m12,20 8,0","class":"s1"}]],["g",{"id":"dm1"},["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}]],["g",{"id":"dmx"},["path",{"d":"M3,20 9,0 20,0","class":"s1"}],["path",{"d":"m20,15 -5,5","class":"s2"}],["path",{"d":"M20,10 10,20","class":"s2"}],["path",{"d":"M20,5 5,20","class":"s2"}],["path",{"d":"M20,0 4,16","class":"s2"}],["path",{"d":"M15,0 6,9","class":"s2"}],["path",{"d":"M10,0 9,1","class":"s2"}],["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"dmd"},["path",{"d":"m0,20 20,0","class":"s3"}]],["g",{"id":"dmu"},["path",{"d":"m0,20 3,0 C 7,10 10.107603,0 20,0","class":"s1"}]],["g",{"id":"dmz"},["path",{"d":"m0,20 3,0 C 10,10 15,10 20,10","class":"s1"}]],["g",{"id":"uuu"},["path",{"d":"M0,0 20,0","class":"s3"}]],["g",{"id":"um0"},["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}]],["g",{"id":"um1"},["path",{"d":"M0,0 10,0","class":"s3"}],["path",{"d":"m12,0 8,0","class":"s1"}]],["g",{"id":"umx"},["path",{"d":"m3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}],["path",{"d":"m20,15 -5,5","class":"s2"}],["path",{"d":"M20,10 10,20","class":"s2"}],["path",{"d":"M20,5 8,17","class":"s2"}],["path",{"d":"M20,0 7,13","class":"s2"}],["path",{"d":"M15,0 6,9","class":"s2"}],["path",{"d":"M10,0 5,5","class":"s2"}],["path",{"d":"M3.5,1.5 5,0","class":"s2"}]],["g",{"id":"umd"},["path",{"d":"m0,0 3,0 c 4,10 7,20 17,20","class":"s1"}]],["g",{"id":"umu"},["path",{"d":"M0,0 20,0","class":"s3"}]],["g",{"id":"umz"},["path",{"d":"m0,0 3,0 c 7,10 12,10 17,10","class":"s4"}]],["g",{"id":"zzz"},["path",{"d":"m0,10 20,0","class":"s1"}]],["g",{"id":"zm0"},["path",{"d":"m0,10 6,0 3,10 11,0","class":"s1"}]],["g",{"id":"zm1"},["path",{"d":"M0,10 6,10 9,0 20,0","class":"s1"}]],["g",{"id":"zmx"},["path",{"d":"m6,10 3,10 11,0","class":"s1"}],["path",{"d":"M0,10 6,10 9,0 20,0","class":"s1"}],["path",{"d":"m20,15 -5,5","class":"s2"}],["path",{"d":"M20,10 10,20","class":"s2"}],["path",{"d":"M20,5 8,17","class":"s2"}],["path",{"d":"M20,0 7,13","class":"s2"}],["path",{"d":"M15,0 6.5,8.5","class":"s2"}],["path",{"d":"M10,0 9,1","class":"s2"}]],["g",{"id":"zmd"},["path",{"d":"m0,10 7,0 c 3,5 8,10 13,10","class":"s1"}]],["g",{"id":"zmu"},["path",{"d":"m0,10 7,0 C 10,5 15,0 20,0","class":"s1"}]],["g",{"id":"zmz"},["path",{"d":"m0,10 20,0","class":"s1"}]],["g",{"id":"gap"},["path",{"d":"m7,-2 -4,0 c -5,0 -5,24 -10,24 l 4,0 C 2,22 2,-2 7,-2 z","class":"s5"}],["path",{"d":"M-7,22 C -2,22 -2,-2 3,-2","class":"s1"}],["path",{"d":"M-3,22 C 2,22 2,-2 7,-2","class":"s1"}]],["g",{"id":"0mv-3"},["path",{"d":"M9,0 20,0 20,20 3,20 z","class":"s6"}],["path",{"d":"M3,20 9,0 20,0","class":"s1"}],["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"1mv-3"},["path",{"d":"M2.875,0 20,0 20,20 9,20 z","class":"s6"}],["path",{"d":"m3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}]],["g",{"id":"xmv-3"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s6"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,5 3.5,1.5","class":"s2"}],["path",{"d":"M0,10 4.5,5.5","class":"s2"}],["path",{"d":"M0,15 6,9","class":"s2"}],["path",{"d":"M0,20 4,16","class":"s2"}]],["g",{"id":"dmv-3"},["path",{"d":"M9,0 20,0 20,20 3,20 z","class":"s6"}],["path",{"d":"M3,20 9,0 20,0","class":"s1"}],["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"umv-3"},["path",{"d":"M3,0 20,0 20,20 9,20 z","class":"s6"}],["path",{"d":"m3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}]],["g",{"id":"zmv-3"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s6"}],["path",{"d":"m6,10 3,10 11,0","class":"s1"}],["path",{"d":"M0,10 6,10 9,0 20,0","class":"s1"}]],["g",{"id":"vvv-3"},["path",{"d":"M20,20 0,20 0,0 20,0","class":"s6"}],["path",{"d":"m0,20 20,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}]],["g",{"id":"vm0-3"},["path",{"d":"M0,20 0,0 3,0 9,20","class":"s6"}],["path",{"d":"M0,0 3,0 9,20","class":"s1"}],["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"vm1-3"},["path",{"d":"M0,0 0,20 3,20 9,0","class":"s6"}],["path",{"d":"M0,0 20,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0","class":"s1"}]],["g",{"id":"vmx-3"},["path",{"d":"M0,0 0,20 3,20 6,10 3,0","class":"s6"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}],["path",{"d":"m20,15 -5,5","class":"s2"}],["path",{"d":"M20,10 10,20","class":"s2"}],["path",{"d":"M20,5 8,17","class":"s2"}],["path",{"d":"M20,0 7,13","class":"s2"}],["path",{"d":"M15,0 7,8","class":"s2"}],["path",{"d":"M10,0 9,1","class":"s2"}]],["g",{"id":"vmd-3"},["path",{"d":"m0,0 0,20 20,0 C 10,20 7,10 3,0","class":"s6"}],["path",{"d":"m0,0 3,0 c 4,10 7,20 17,20","class":"s1"}],["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"vmu-3"},["path",{"d":"m0,0 0,20 3,0 C 7,10 10,0 20,0","class":"s6"}],["path",{"d":"m0,20 3,0 C 7,10 10,0 20,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}]],["g",{"id":"vmz-3"},["path",{"d":"M0,0 3,0 C 10,10 15,10 20,10 15,10 10,10 3,20 L 0,20","class":"s6"}],["path",{"d":"m0,0 3,0 c 7,10 12,10 17,10","class":"s1"}],["path",{"d":"m0,20 3,0 C 10,10 15,10 20,10","class":"s1"}]],["g",{"id":"vmv-3-3"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s6"}],["path",{"d":"M3,0 0,0 0,20 3,20 6,10 z","class":"s6"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}]],["g",{"id":"vmv-3-4"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s7"}],["path",{"d":"M3,0 0,0 0,20 3,20 6,10 z","class":"s6"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}]],["g",{"id":"vmv-3-5"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s8"}],["path",{"d":"M3,0 0,0 0,20 3,20 6,10 z","class":"s6"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}]],["g",{"id":"vmv-4-3"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s6"}],["path",{"d":"M3,0 0,0 0,20 3,20 6,10 z","class":"s7"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}]],["g",{"id":"vmv-4-4"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s7"}],["path",{"d":"M3,0 0,0 0,20 3,20 6,10 z","class":"s7"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}]],["g",{"id":"vmv-4-5"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s8"}],["path",{"d":"M3,0 0,0 0,20 3,20 6,10 z","class":"s7"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}]],["g",{"id":"vmv-5-3"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s6"}],["path",{"d":"M3,0 0,0 0,20 3,20 6,10 z","class":"s8"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}]],["g",{"id":"vmv-5-4"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s7"}],["path",{"d":"M3,0 0,0 0,20 3,20 6,10 z","class":"s8"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}]],["g",{"id":"vmv-5-5"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s8"}],["path",{"d":"M3,0 0,0 0,20 3,20 6,10 z","class":"s8"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}]],["g",{"id":"0mv-4"},["path",{"d":"M9,0 20,0 20,20 3,20 z","class":"s7"}],["path",{"d":"M3,20 9,0 20,0","class":"s1"}],["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"1mv-4"},["path",{"d":"M2.875,0 20,0 20,20 9,20 z","class":"s7"}],["path",{"d":"m3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}]],["g",{"id":"xmv-4"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s7"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,5 3.5,1.5","class":"s2"}],["path",{"d":"M0,10 4.5,5.5","class":"s2"}],["path",{"d":"M0,15 6,9","class":"s2"}],["path",{"d":"M0,20 4,16","class":"s2"}]],["g",{"id":"dmv-4"},["path",{"d":"M9,0 20,0 20,20 3,20 z","class":"s7"}],["path",{"d":"M3,20 9,0 20,0","class":"s1"}],["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"umv-4"},["path",{"d":"M3,0 20,0 20,20 9,20 z","class":"s7"}],["path",{"d":"m3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}]],["g",{"id":"zmv-4"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s7"}],["path",{"d":"m6,10 3,10 11,0","class":"s1"}],["path",{"d":"M0,10 6,10 9,0 20,0","class":"s1"}]],["g",{"id":"0mv-5"},["path",{"d":"M9,0 20,0 20,20 3,20 z","class":"s8"}],["path",{"d":"M3,20 9,0 20,0","class":"s1"}],["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"1mv-5"},["path",{"d":"M2.875,0 20,0 20,20 9,20 z","class":"s8"}],["path",{"d":"m3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}]],["g",{"id":"xmv-5"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s8"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,5 3.5,1.5","class":"s2"}],["path",{"d":"M0,10 4.5,5.5","class":"s2"}],["path",{"d":"M0,15 6,9","class":"s2"}],["path",{"d":"M0,20 4,16","class":"s2"}]],["g",{"id":"dmv-5"},["path",{"d":"M9,0 20,0 20,20 3,20 z","class":"s8"}],["path",{"d":"M3,20 9,0 20,0","class":"s1"}],["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"umv-5"},["path",{"d":"M3,0 20,0 20,20 9,20 z","class":"s8"}],["path",{"d":"m3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}]],["g",{"id":"zmv-5"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s8"}],["path",{"d":"m6,10 3,10 11,0","class":"s1"}],["path",{"d":"M0,10 6,10 9,0 20,0","class":"s1"}]],["g",{"id":"vvv-4"},["path",{"d":"M20,20 0,20 0,0 20,0","class":"s7"}],["path",{"d":"m0,20 20,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}]],["g",{"id":"vm0-4"},["path",{"d":"M0,20 0,0 3,0 9,20","class":"s7"}],["path",{"d":"M0,0 3,0 9,20","class":"s1"}],["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"vm1-4"},["path",{"d":"M0,0 0,20 3,20 9,0","class":"s7"}],["path",{"d":"M0,0 20,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0","class":"s1"}]],["g",{"id":"vmx-4"},["path",{"d":"M0,0 0,20 3,20 6,10 3,0","class":"s7"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}],["path",{"d":"m20,15 -5,5","class":"s2"}],["path",{"d":"M20,10 10,20","class":"s2"}],["path",{"d":"M20,5 8,17","class":"s2"}],["path",{"d":"M20,0 7,13","class":"s2"}],["path",{"d":"M15,0 7,8","class":"s2"}],["path",{"d":"M10,0 9,1","class":"s2"}]],["g",{"id":"vmd-4"},["path",{"d":"m0,0 0,20 20,0 C 10,20 7,10 3,0","class":"s7"}],["path",{"d":"m0,0 3,0 c 4,10 7,20 17,20","class":"s1"}],["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"vmu-4"},["path",{"d":"m0,0 0,20 3,0 C 7,10 10,0 20,0","class":"s7"}],["path",{"d":"m0,20 3,0 C 7,10 10,0 20,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}]],["g",{"id":"vmz-4"},["path",{"d":"M0,0 3,0 C 10,10 15,10 20,10 15,10 10,10 3,20 L 0,20","class":"s7"}],["path",{"d":"m0,0 3,0 c 7,10 12,10 17,10","class":"s1"}],["path",{"d":"m0,20 3,0 C 10,10 15,10 20,10","class":"s1"}]],["g",{"id":"vvv-5"},["path",{"d":"M20,20 0,20 0,0 20,0","class":"s8"}],["path",{"d":"m0,20 20,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}]],["g",{"id":"vm0-5"},["path",{"d":"M0,20 0,0 3,0 9,20","class":"s8"}],["path",{"d":"M0,0 3,0 9,20","class":"s1"}],["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"vm1-5"},["path",{"d":"M0,0 0,20 3,20 9,0","class":"s8"}],["path",{"d":"M0,0 20,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0","class":"s1"}]],["g",{"id":"vmx-5"},["path",{"d":"M0,0 0,20 3,20 6,10 3,0","class":"s8"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}],["path",{"d":"m20,15 -5,5","class":"s2"}],["path",{"d":"M20,10 10,20","class":"s2"}],["path",{"d":"M20,5 8,17","class":"s2"}],["path",{"d":"M20,0 7,13","class":"s2"}],["path",{"d":"M15,0 7,8","class":"s2"}],["path",{"d":"M10,0 9,1","class":"s2"}]],["g",{"id":"vmd-5"},["path",{"d":"m0,0 0,20 20,0 C 10,20 7,10 3,0","class":"s8"}],["path",{"d":"m0,0 3,0 c 4,10 7,20 17,20","class":"s1"}],["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"vmu-5"},["path",{"d":"m0,0 0,20 3,0 C 7,10 10,0 20,0","class":"s8"}],["path",{"d":"m0,20 3,0 C 7,10 10,0 20,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}]],["g",{"id":"vmz-5"},["path",{"d":"M0,0 3,0 C 10,10 15,10 20,10 15,10 10,10 3,20 L 0,20","class":"s8"}],["path",{"d":"m0,0 3,0 c 7,10 12,10 17,10","class":"s1"}],["path",{"d":"m0,20 3,0 C 10,10 15,10 20,10","class":"s1"}]],["g",{"id":"Pclk"},["path",{"d":"M-3,12 0,3 3,12 C 1,11 -1,11 -3,12 z","class":"s9"}],["path",{"d":"M0,20 0,0 20,0","class":"s1"}]],["g",{"id":"Nclk"},["path",{"d":"M-3,8 0,17 3,8 C 1,9 -1,9 -3,8 z","class":"s9"}],["path",{"d":"m0,0 0,20 20,0","class":"s1"}]],["g",{"id":"vvv-2"},["path",{"d":"M20,20 0,20 0,0 20,0","class":"s10"}],["path",{"d":"m0,20 20,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}]],["g",{"id":"vm0-2"},["path",{"d":"M0,20 0,0 3,0 9,20","class":"s10"}],["path",{"d":"M0,0 3,0 9,20","class":"s1"}],["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"vm1-2"},["path",{"d":"M0,0 0,20 3,20 9,0","class":"s10"}],["path",{"d":"M0,0 20,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0","class":"s1"}]],["g",{"id":"vmx-2"},["path",{"d":"M0,0 0,20 3,20 6,10 3,0","class":"s10"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}],["path",{"d":"m20,15 -5,5","class":"s2"}],["path",{"d":"M20,10 10,20","class":"s2"}],["path",{"d":"M20,5 8,17","class":"s2"}],["path",{"d":"M20,0 7,13","class":"s2"}],["path",{"d":"M15,0 7,8","class":"s2"}],["path",{"d":"M10,0 9,1","class":"s2"}]],["g",{"id":"vmd-2"},["path",{"d":"m0,0 0,20 20,0 C 10,20 7,10 3,0","class":"s10"}],["path",{"d":"m0,0 3,0 c 4,10 7,20 17,20","class":"s1"}],["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"vmu-2"},["path",{"d":"m0,0 0,20 3,0 C 7,10 10,0 20,0","class":"s10"}],["path",{"d":"m0,20 3,0 C 7,10 10,0 20,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}]],["g",{"id":"vmz-2"},["path",{"d":"M0,0 3,0 C 10,10 15,10 20,10 15,10 10,10 3,20 L 0,20","class":"s10"}],["path",{"d":"m0,0 3,0 c 7,10 12,10 17,10","class":"s1"}],["path",{"d":"m0,20 3,0 C 10,10 15,10 20,10","class":"s1"}]],["g",{"id":"0mv-2"},["path",{"d":"M9,0 20,0 20,20 3,20 z","class":"s10"}],["path",{"d":"M3,20 9,0 20,0","class":"s1"}],["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"1mv-2"},["path",{"d":"M2.875,0 20,0 20,20 9,20 z","class":"s10"}],["path",{"d":"m3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}]],["g",{"id":"xmv-2"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s10"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,5 3.5,1.5","class":"s2"}],["path",{"d":"M0,10 4.5,5.5","class":"s2"}],["path",{"d":"M0,15 6,9","class":"s2"}],["path",{"d":"M0,20 4,16","class":"s2"}]],["g",{"id":"dmv-2"},["path",{"d":"M9,0 20,0 20,20 3,20 z","class":"s10"}],["path",{"d":"M3,20 9,0 20,0","class":"s1"}],["path",{"d":"m0,20 20,0","class":"s1"}]],["g",{"id":"umv-2"},["path",{"d":"M3,0 20,0 20,20 9,20 z","class":"s10"}],["path",{"d":"m3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,0 20,0","class":"s1"}]],["g",{"id":"zmv-2"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s10"}],["path",{"d":"m6,10 3,10 11,0","class":"s1"}],["path",{"d":"M0,10 6,10 9,0 20,0","class":"s1"}]],["g",{"id":"vmv-3-2"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s10"}],["path",{"d":"M3,0 0,0 0,20 3,20 6,10 z","class":"s6"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}]],["g",{"id":"vmv-4-2"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s10"}],["path",{"d":"M3,0 0,0 0,20 3,20 6,10 z","class":"s7"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}]],["g",{"id":"vmv-5-2"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s10"}],["path",{"d":"M3,0 0,0 0,20 3,20 6,10 z","class":"s8"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}]],["g",{"id":"vmv-2-3"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s6"}],["path",{"d":"M3,0 0,0 0,20 3,20 6,10 z","class":"s10"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}]],["g",{"id":"vmv-2-4"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s7"}],["path",{"d":"M3,0 0,0 0,20 3,20 6,10 z","class":"s10"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}]],["g",{"id":"vmv-2-5"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s8"}],["path",{"d":"M3,0 0,0 0,20 3,20 6,10 z","class":"s10"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}]],["g",{"id":"vmv-2-2"},["path",{"d":"M9,0 20,0 20,20 9,20 6,10 z","class":"s10"}],["path",{"d":"M3,0 0,0 0,20 3,20 6,10 z","class":"s10"}],["path",{"d":"m0,0 3,0 6,20 11,0","class":"s1"}],["path",{"d":"M0,20 3,20 9,0 20,0","class":"s1"}]],["g",{"id":"arrow0"},["path",{"d":"m-12,-3 9,3 -9,3 c 1,-2 1,-4 0,-6 z","class":"s11"}],["path",{"d":"M0,0 -15,0","class":"s12"}]],["marker",{"id":"arrowhead","style":"fill:#0041c4","markerHeight":"7","markerWidth":"10","markerUnits":"strokeWidth","viewBox":"0 -4 11 8","refX":"15","refY":"0","orient":"auto"},["path",{"d":"M0 -4 11 0 0 4z"}]],["marker",{"id":"arrowtail","style":"fill:#0041c4","markerHeight":"7","markerWidth":"10","markerUnits":"strokeWidth","viewBox":"-11 -4 11 8","refX":"-15","refY":"0","orient":"auto"},["path",{"d":"M0 -4 -11 0 0 4z"}]]],["g",{"id":"waves"},["g",{"id":"lanes"}],["g",{"id":"groups"}]]];
try { module.exports = WaveSkin; } catch(err) {}

},{}]},{},[2]);

    </script>
  </body>
</html>
